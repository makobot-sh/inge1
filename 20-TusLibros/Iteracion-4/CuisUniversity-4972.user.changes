

----QUIT----(13 November 2021 20:18:32) CuisUniversity-4972.image priorSource: 14896235!

----STARTUP---- (13 November 2021 20:18:33) as /Users/hernan/Documents/Cuis/5.0-64Bits/Cuis-University-Installer/CuisUniversity-4972.image!


----QUIT----(13 November 2021 20:18:33) CuisUniversity-4972.image priorSource: 18974023!

----STARTUP---- (15 November 2021 19:27:09) as D:\001.Maca\2c2021\inge1\qa3\CuisUniversity-4972.image!


CodePackage subclass: #ColorExtrasPackage
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Color-Extras'!

!classDefinition: #ColorExtrasPackage category: 'Color-Extras' stamp: 'Install-Color-Extras 11/15/2021 19:27:43'!
CodePackage subclass: #ColorExtrasPackage
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Color-Extras'!

ColorExtrasPackage class
	instanceVariableNames: ''!

!classDefinition: 'ColorExtrasPackage class' category: 'Color-Extras' stamp: 'Install-Color-Extras 11/15/2021 19:27:43'!
ColorExtrasPackage class
	instanceVariableNames: ''!

----End fileIn of D:\001.Maca\2c2021\inge1\qa3\Packages\Features\Color-Extras.pck.st----!

CodePackage subclass: #MorphicMisc1Package
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classDefinition: #MorphicMisc1Package category: 'Morphic-Misc1' stamp: 'Install-Morphic-Misc1 11/15/2021 19:27:44'!
CodePackage subclass: #MorphicMisc1Package
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!
!MorphicMisc1Package commentStamp: '<historical>' prior: 0!
My purpose in life is to check that any base image methods overridden have not been updated.
See #MorphMisc1Package class>>prePackageInstall!

MorphicMisc1Package class
	instanceVariableNames: ''!

!classDefinition: 'MorphicMisc1Package class' category: 'Morphic-Misc1' stamp: 'Install-Morphic-Misc1 11/15/2021 19:27:44'!
MorphicMisc1Package class
	instanceVariableNames: ''!

----End fileIn of D:\001.Maca\2c2021\inge1\qa3\Packages\Morphic\Morphic-Misc1\Morphic-Misc1.pck.st----!

----End fileIn of D:\001.Maca\2c2021\inge1\qa3\Packages\Morphic\Morphic-Widgets-Extras.pck.st----!

----End fileIn of D:\001.Maca\2c2021\inge1\qa3\Packages\System\Collections-CompactArrays.pck.st----!

----End fileIn of D:\001.Maca\2c2021\inge1\qa3\Packages\Features\Compression.pck.st----!

----End fileIn of D:\001.Maca\2c2021\inge1\qa3\Packages\Features\Sound.pck.st----!

----End fileIn of D:\001.Maca\2c2021\inge1\qa3\Packages\Features\Cryptography-DigitalSignatures.pck.st----!

----End fileIn of D:\001.Maca\2c2021\inge1\qa3\Packages\Features\Identities-UUID.pck.st----!

----End fileIn of D:\001.Maca\2c2021\inge1\qa3\Packages\System\Network-Kernel.pck.st----!

----End fileIn of D:\001.Maca\2c2021\inge1\qa3\it4\WebClient.pck.st----!

----End fileIn of D:\001.Maca\2c2021\inge1\qa3\it4\WordsClientDemo.st----!

----End fileIn of D:\001.Maca\2c2021\inge1\qa3\it4\StringsServicesServer.st----!

----SNAPSHOT----(15 November 2021 19:46:20) CuisUniversity-4972.image priorSource: 18974255!

----STARTUP---- (15 November 2021 19:46:36) as D:\001.Maca\2c2021\inge1\qa3\CuisUniversity-4972.image!


StringsServicesRestInterface listeningOn: 8080.!

|server|!

server := StringsServicesRestInterface listeningOn: 8080.!

server startListening.!

server startListening.!

server stopListening.!

server stopListening. !

server destroy.!

server destroy. !

server destroy. !

----SNAPSHOT----(15 November 2021 19:57:03) CuisUniversity-4972.image priorSource: 20470678!

server destroy. !

----SNAPSHOT----(15 November 2021 19:57:14) CuisUniversity-4972.image priorSource: 20471153!

----STARTUP---- (15 November 2021 19:57:37) as D:\001.Maca\2c2021\inge1\qa3\CuisUniversity-4972.image!


|server|!

server := StringsServicesRestInterface listeningOn: 8080.!

server startListening.!

server startListening.!

server stopListening.!

server stopListening.!

server destroy.!

----End fileIn of D:\001.Maca\2c2021\inge1\qa3\it4\TusLibros-80.st----!

----SNAPSHOT----(15 November 2021 20:17:18) CuisUniversity-4972.image priorSource: 20471266!

server := WordsClientWindow open.!

server := WordsClientWindow allInstances .!

server := WordsClientWindow allInstances .!

|server window|!

server := StringsServicesRestInterface listeningOn: 8080.!

server startListening.!

window := WordsClientWindow open.!

window destroy!

server destroy !

Object subclass: #TusLibrosServer
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!

!classDefinition: #TusLibrosServer category: 'TusLibros-Model' stamp: 'MP 11/15/2021 20:39:44'!
Object subclass: #TusLibrosServer
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!

TestCase subclass: #TusLibrosServerTest
	instanceVariableNames: 'testObjectsFactory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!

!classDefinition: #TusLibrosServerTest category: 'TusLibros-Tests' stamp: 'MP 11/15/2021 20:40:30'!
TestCase subclass: #TusLibrosServerTest
	instanceVariableNames: 'testObjectsFactory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!
!TusLibrosServerTest methodsFor: 'no messages' stamp: 'MP 11/15/2021 20:48:07'!
test01

	|server|
	
	server _ TusLibrosServer listeningOn: 8080.
	server startListening.
	
	WebRequest new initializeFromUrl: 'http://localhost:8080/'! !

----SNAPSHOT----(15 November 2021 20:50:55) CuisUniversity-4972.image priorSource: 20524931!
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/15/2021 20:50:57' prior: 50973092!
test01

	|server req|
	
	server _ TusLibrosServer listeningOn: 8080.
	server startListening.
	
	req _ WebRequest new initializeFromUrl: 'http://localhost:8080/'.
	req ! !
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/15/2021 21:00:13' prior: 50973103!
test01

	|server req|
	
	server _ TusLibrosServer listeningOn: 8080.
	server startListening.
	
	req _ WebRequest new initializeFromUrl: 'http://localhost:8080/ping'.
	req ! !
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/15/2021 21:02:24' prior: 50973112!
test01

	|server req|
	
	server _ TusLibrosServer listeningOn: 8080.
	server startListening.
	
	req _ WebClient httpGet: 'http://localhost:8080/ping'.
	req send! !
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/15/2021 21:02:55' prior: 50973121!
test01

	|server req|
	
	server _ TusLibrosServer listeningOn: 8080.
	server startListening.
	
	req _ WebClient httpGet: 'http://localhost:8080/ping'.
	! !
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/15/2021 21:03:49' prior: 50973130!
test01

	|server req client|
	
	server _ TusLibrosServer listeningOn: 8080.
	server startListening.
	
	client _ WebClient new.
	req _ client httpGet: 'http://localhost:8080/ping'.
	
	client close.! !
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/15/2021 21:10:31' prior: 50973139!
test01

	|server req client|
	
	server _ TusLibrosServer listeningOn: 8080.
	server startListening.
	
	client _ WebClient new.
	req _ client httpGet: 'http://localhost:8080/createCart?clientId=cliente&password=psw'.
	
	client close.
	self assert: req = 0.! !
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/15/2021 21:10:43' prior: 50973149!
test01

	|server resp client|
	
	server _ TusLibrosServer listeningOn: 8080.
	server startListening.
	
	client _ WebClient new.
	resp _ client httpGet: 'http://localhost:8080/createCart?clientId=cliente&password=psw'.
	
	client close.
	self assert: resp = 0.! !
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/15/2021 21:11:09' prior: 50973161!
test01

	|server resp client|
	
	server _ TusLibrosServer listeningOn: 8080.
	server startListening.
	
	client _ WebClient new.
	resp _ client httpGet: 'http://localhost:8080/createCart?clientId=cliente&password=psw'.
	
	client close.
	self assert: resp = '0|000'.! !
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/15/2021 21:11:14' prior: 50973173!
test01

	|server resp client|
	
	server _ TusLibrosServer listeningOn: 8080.
	server startListening.
	
	client _ WebClient new.
	resp _ client httpGet: 'http://localhost:8080/createCart?clientId=cliente&password=psw'.
	
	client close.
	self assert: resp = '0|0000'.! !

!testRun: #TusLibrosServerTest #test01 stamp: 'MP 11/15/2021 21:11:16'!
ERROR!
!TusLibrosServer class methodsFor: 'as yet unclassified' stamp: 'MP 11/15/2021 21:11:58'!
listeningOn: aSmallInteger 
	self shouldBeImplemented.! !

!testRun: #TusLibrosServerTest #test01 stamp: 'MP 11/15/2021 21:12:12'!
ERROR!
!TusLibrosServer class methodsFor: 'error handling' stamp: 'MP 11/15/2021 21:12:19' overrides: 16881409!
error: aString 
	self shouldBeImplemented.! !

!methodRemoval: TusLibrosServer class #error: stamp: 'MP 11/15/2021 21:12:40'!
error: aString 
	self shouldBeImplemented.!
!TusLibrosServer class methodsFor: 'as yet unclassified' stamp: 'MP 11/15/2021 21:12:47' prior: 50973199!
listeningOn: aPort
	! !
!TusLibrosServer class methodsFor: 'as yet unclassified' stamp: 'MP 11/15/2021 21:13:08' prior: 50973216!
listeningOn: aPortNumber

	^self new initializeWith: aPortNumber.! !

!testRun: #TusLibrosServerTest #test01 stamp: 'MP 11/15/2021 21:17:53'!
ERROR!

!testRun: #TusLibrosServerTest #test01 stamp: 'MP 11/15/2021 21:17:53'!
ERROR!

!classDefinition: #TusLibrosServer category: 'TusLibros-Model' stamp: 'MP 11/15/2021 21:18:04'!
Object subclass: #TusLibrosServer
	instanceVariableNames: 'portNumber'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/15/2021 21:18:04'!
initializeWith: aPortNumber 
	self shouldBeImplemented.
	portNumber := aPortNumber.! !

!classDefinition: #TusLibrosServer category: 'TusLibros-Model' stamp: 'MP 11/15/2021 21:22:46'!
Object subclass: #TusLibrosServer
	instanceVariableNames: 'portNumber port'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!

!classDefinition: #TusLibrosServer category: 'TusLibros-Model' stamp: 'MP 11/15/2021 21:22:49'!
Object subclass: #TusLibrosServer
	instanceVariableNames: 'portNumber port webServer'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/15/2021 21:22:41' prior: 50973239!
initializeWith: aPortNumber 
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/createCart' action:[:request | 
		
		[.
		request send200Response: ('0000')
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	! !

!testRun: #TusLibrosServerTest #test01 stamp: 'MP 11/15/2021 21:22:58'!
ERROR!

!testRun: #TusLibrosServerTest #test01 stamp: 'MP 11/15/2021 21:22:59'!
ERROR!

Object subclass: #TusLibrosServer
	instanceVariableNames: 'port webServer'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!

!classDefinition: #TusLibrosServer category: 'TusLibros-Model' stamp: 'MP 11/15/2021 21:23:43'!
Object subclass: #TusLibrosServer
	instanceVariableNames: 'port webServer'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!

!testRun: #TusLibrosServerTest #test01 stamp: 'MP 11/15/2021 21:23:48'!
ERROR!

!testRun: #TusLibrosServerTest #test01 stamp: 'MP 11/15/2021 21:23:48'!
ERROR!
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/15/2021 21:24:03' prior: 50973261!
initializeWith: aPortNumber 
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		
		[.
		request send200Response: ('0000')
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	! !

!testRun: #TusLibrosServerTest #test01 stamp: 'MP 11/15/2021 21:24:04'!
ERROR!

!testRun: #TusLibrosServerTest #test01 stamp: 'MP 11/15/2021 21:24:04'!
ERROR!
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/15/2021 21:24:40'!
startListening
	
	webServer startListener.

	^'Listening on port: ', port asString.
	! !
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/15/2021 21:24:59'!
stopListening
	
	webServer stopListener.
	
	^'Stopped listening from port: ', port asString! !

!methodRemoval: TusLibrosServer #startListening stamp: 'MP 11/15/2021 21:25:07'!
startListening
	
	webServer startListener.

	^'Listening on port: ', port asString.
	!

!methodRemoval: TusLibrosServer #stopListening stamp: 'MP 11/15/2021 21:25:09'!
stopListening
	
	webServer stopListener.
	
	^'Stopped listening from port: ', port asString!
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/15/2021 21:25:18' prior: 50973296!
initializeWith: aPortNumber 
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		
		[.
		request send200Response: ('0000')
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer startListener.
! !
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/15/2021 21:25:34'!
destroy
	
	webServer ifNotNil:[webServer destroy].! !
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/15/2021 21:26:28' prior: 50973185!
test01

	|server resp client|
	
	server _ TusLibrosServer listeningOn: 8080.
	server startListening.
	
	client _ WebClient new.
	resp _ client httpGet: 'http://localhost:8080/createCart?clientId=cliente&password=psw'.
	
	client close.
	server destroy.
	self assert: resp = '0|0000'.
	! !

!testRun: #TusLibrosServerTest #test01 stamp: 'MP 11/15/2021 21:26:30'!
ERROR!
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/15/2021 21:26:38' prior: 50973354!
test01

	|server resp client|
	
	server _ TusLibrosServer listeningOn: 8080.
	
	client _ WebClient new.
	resp _ client httpGet: 'http://localhost:8080/createCart?clientId=cliente&password=psw'.
	
	client close.
	server destroy.
	self assert: resp = '0|0000'.
	! !

!testRun: #TusLibrosServerTest #test01 stamp: 'MP 11/15/2021 21:26:39'!
FAILURE!
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/15/2021 21:27:11' prior: 50973369!
test01

	|server resp client|
	
	server _ TusLibrosServer listeningOn: 8080.
	
	client _ WebClient new.
	resp _ client httpGet: 'http://localhost:8080/createCart?clientId=cliente&password=psw'.
	
	client close.
	server destroy.
	self assert: '0|0000' equals: resp.
	! !
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/15/2021 21:27:21' prior: 50973336!
initializeWith: aPortNumber 
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		
		[.
		request send200Response: ('o|0000')
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer startListener.
! !
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/15/2021 21:27:23' prior: 50973396!
initializeWith: aPortNumber 
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		
		[.
		request send200Response: ('0|0000')
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer startListener.
! !

!testRun: #TusLibrosServerTest #test01 stamp: 'MP 11/15/2021 21:27:24'!
FAILURE!

!testRun: #TusLibrosServerTest #test01 stamp: 'MP 11/15/2021 21:27:24'!
FAILURE!
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/15/2021 21:27:43' prior: 50973384!
test01

	|server resp client|
	
	server _ TusLibrosServer listeningOn: 8080.
	
	client _ WebClient new.
	resp _ client httpGet: 'http://localhost:8080/createCart?clientId=cliente&password=psw'.
	
	client close.
	server destroy.
	self assert: '0|0000' equals: resp content.
	! !

----STARTUP---- (15 November 2021 21:30:08) as D:\001.Maca\2c2021\inge1\qa3\CuisUniversity-4972.image!

!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/15/2021 20:50:57' prior: 50973092!
test01

	|server req|
	
	server _ TusLibrosServer listeningOn: 8080.
	server startListening.
	
	req _ WebRequest new initializeFromUrl: 'http://localhost:8080/'.
	req ! !
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/15/2021 21:00:13' prior: 50973445!
test01

	|server req|
	
	server _ TusLibrosServer listeningOn: 8080.
	server startListening.
	
	req _ WebRequest new initializeFromUrl: 'http://localhost:8080/ping'.
	req ! !
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/15/2021 21:02:24' prior: 50973454!
test01

	|server req|
	
	server _ TusLibrosServer listeningOn: 8080.
	server startListening.
	
	req _ WebClient httpGet: 'http://localhost:8080/ping'.
	req send! !
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/15/2021 21:02:55' prior: 50973463!
test01

	|server req|
	
	server _ TusLibrosServer listeningOn: 8080.
	server startListening.
	
	req _ WebClient httpGet: 'http://localhost:8080/ping'.
	! !
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/15/2021 21:03:49' prior: 50973472!
test01

	|server req client|
	
	server _ TusLibrosServer listeningOn: 8080.
	server startListening.
	
	client _ WebClient new.
	req _ client httpGet: 'http://localhost:8080/ping'.
	
	client close.! !
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/15/2021 21:10:31' prior: 50973481!
test01

	|server req client|
	
	server _ TusLibrosServer listeningOn: 8080.
	server startListening.
	
	client _ WebClient new.
	req _ client httpGet: 'http://localhost:8080/createCart?clientId=cliente&password=psw'.
	
	client close.
	self assert: req = 0.! !
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/15/2021 21:10:43' prior: 50973491!
test01

	|server resp client|
	
	server _ TusLibrosServer listeningOn: 8080.
	server startListening.
	
	client _ WebClient new.
	resp _ client httpGet: 'http://localhost:8080/createCart?clientId=cliente&password=psw'.
	
	client close.
	self assert: resp = 0.! !
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/15/2021 21:11:09' prior: 50973503!
test01

	|server resp client|
	
	server _ TusLibrosServer listeningOn: 8080.
	server startListening.
	
	client _ WebClient new.
	resp _ client httpGet: 'http://localhost:8080/createCart?clientId=cliente&password=psw'.
	
	client close.
	self assert: resp = '0|000'.! !
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/15/2021 21:11:14' prior: 50973515!
test01

	|server resp client|
	
	server _ TusLibrosServer listeningOn: 8080.
	server startListening.
	
	client _ WebClient new.
	resp _ client httpGet: 'http://localhost:8080/createCart?clientId=cliente&password=psw'.
	
	client close.
	self assert: resp = '0|0000'.! !
!TusLibrosServer class methodsFor: 'as yet unclassified' stamp: 'MP 11/15/2021 21:11:58'!
listeningOn: aSmallInteger 
	self shouldBeImplemented.! !
!TusLibrosServer class methodsFor: 'error handling' stamp: 'MP 11/15/2021 21:12:19' overrides: 16881409!
error: aString 
	self shouldBeImplemented.! !

!methodRemoval: TusLibrosServer class #error: stamp: 'MP 11/15/2021 21:30:19'!
error: aString 
	self shouldBeImplemented.!
!TusLibrosServer class methodsFor: 'as yet unclassified' stamp: 'MP 11/15/2021 21:12:47' prior: 50973539!
listeningOn: aPort
	! !
!TusLibrosServer class methodsFor: 'as yet unclassified' stamp: 'MP 11/15/2021 21:13:08' prior: 50973554!
listeningOn: aPortNumber

	^self new initializeWith: aPortNumber.! !

!classDefinition: #TusLibrosServer category: 'TusLibros-Model' stamp: 'MP 11/15/2021 21:30:19'!
Object subclass: #TusLibrosServer
	instanceVariableNames: 'portNumber'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/15/2021 21:18:04'!
initializeWith: aPortNumber 
	self shouldBeImplemented.
	portNumber := aPortNumber.! !

!classDefinition: #TusLibrosServer category: 'TusLibros-Model' stamp: 'MP 11/15/2021 21:30:19'!
Object subclass: #TusLibrosServer
	instanceVariableNames: 'portNumber port'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!

!classDefinition: #TusLibrosServer category: 'TusLibros-Model' stamp: 'MP 11/15/2021 21:30:19'!
Object subclass: #TusLibrosServer
	instanceVariableNames: 'portNumber port webServer'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/15/2021 21:22:41' prior: 50973572!
initializeWith: aPortNumber 
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/createCart' action:[:request | 
		
		[.
		request send200Response: ('0000')
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	! !

!classDefinition: #TusLibrosServer category: 'TusLibros-Model' stamp: 'MP 11/15/2021 21:30:20'!
Object subclass: #TusLibrosServer
	instanceVariableNames: 'port webServer'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!

!classDefinition: #TusLibrosServer category: 'TusLibros-Model' stamp: 'MP 11/15/2021 21:30:20'!
Object subclass: #TusLibrosServer
	instanceVariableNames: 'port webServer'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/15/2021 21:24:03' prior: 50973594!
initializeWith: aPortNumber 
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		
		[.
		request send200Response: ('0000')
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	! !
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/15/2021 21:24:40'!
startListening
	
	webServer startListener.

	^'Listening on port: ', port asString.
	! !
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/15/2021 21:24:59'!
stopListening
	
	webServer stopListener.
	
	^'Stopped listening from port: ', port asString! !

!methodRemoval: TusLibrosServer #startListening stamp: 'MP 11/15/2021 21:30:20'!
startListening
	
	webServer startListener.

	^'Listening on port: ', port asString.
	!

!methodRemoval: TusLibrosServer #stopListening stamp: 'MP 11/15/2021 21:30:20'!
stopListening
	
	webServer stopListener.
	
	^'Stopped listening from port: ', port asString!
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/15/2021 21:25:18' prior: 50973622!
initializeWith: aPortNumber 
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		
		[.
		request send200Response: ('0000')
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer startListener.
! !
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/15/2021 21:25:34'!
destroy
	
	webServer ifNotNil:[webServer destroy].! !
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/15/2021 21:26:28' prior: 50973527!
test01

	|server resp client|
	
	server _ TusLibrosServer listeningOn: 8080.
	server startListening.
	
	client _ WebClient new.
	resp _ client httpGet: 'http://localhost:8080/createCart?clientId=cliente&password=psw'.
	
	client close.
	server destroy.
	self assert: resp = '0|0000'.
	! !
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/15/2021 21:26:38' prior: 50973675!
test01

	|server resp client|
	
	server _ TusLibrosServer listeningOn: 8080.
	
	client _ WebClient new.
	resp _ client httpGet: 'http://localhost:8080/createCart?clientId=cliente&password=psw'.
	
	client close.
	server destroy.
	self assert: resp = '0|0000'.
	! !
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/15/2021 21:27:11' prior: 50973688!
test01

	|server resp client|
	
	server _ TusLibrosServer listeningOn: 8080.
	
	client _ WebClient new.
	resp _ client httpGet: 'http://localhost:8080/createCart?clientId=cliente&password=psw'.
	
	client close.
	server destroy.
	self assert: '0|0000' equals: resp.
	! !
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/15/2021 21:27:21' prior: 50973657!
initializeWith: aPortNumber 
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		
		[.
		request send200Response: ('o|0000')
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer startListener.
! !
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/15/2021 21:27:23' prior: 50973712!
initializeWith: aPortNumber 
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		
		[.
		request send200Response: ('0|0000')
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer startListener.
! !
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/15/2021 21:27:43' prior: 50973700!
test01

	|server resp client|
	
	server _ TusLibrosServer listeningOn: 8080.
	
	client _ WebClient new.
	resp _ client httpGet: 'http://localhost:8080/createCart?clientId=cliente&password=psw'.
	
	client close.
	server destroy.
	self assert: '0|0000' equals: resp content.
	! !

----SNAPSHOT----(15 November 2021 21:30:47) CuisUniversity-4972.image priorSource: 20526361!

----STARTUP---- (15 November 2021 21:31:44) as D:\001.Maca\2c2021\inge1\qa3\CuisUniversity-4972.image!


|server client resp|!

server _ StringsServicesRestInterface listeningOn: 8080.!

server startListening.!

client _ WebClient new.!

resp _ client httpGet: 'http://localhost:8080/quote'.!

client close.!

server destroy.!

resp.!

resp.!

resp content.!
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/15/2021 21:36:13' prior: 50973726!
initializeWith: aPortNumber 
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		
		[
		request send200Response: ('0|0000').
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer startListener.
! !
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/15/2021 21:37:34' prior: 50973766!
initializeWith: aPortNumber 
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		
		[
		request send200Response: '0|0000'.
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer startListener.
! !
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/15/2021 21:37:50' prior: 50973780!
initializeWith: aPortNumber 
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		
		[
		request send200Response: '0|0000'.
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: anError messageText ]].
	
	webServer startListener.
! !
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/15/2021 21:38:22' prior: 50973794!
initializeWith: aPortNumber 
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
		request send200Response: '0|0000'.
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: anError messageText ]].
	
	webServer startListener.
! !

!testRun: #TusLibrosServerTest #test01 stamp: 'MP 11/15/2021 21:38:24'!
PASSED!

----SNAPSHOT----(15 November 2021 21:38:31) CuisUniversity-4972.image priorSource: 20547221!

----STARTUP---- (15 November 2021 21:39:06) as D:\001.Maca\2c2021\inge1\qa3\CuisUniversity-4972.image!

!TusLibrosServer class methodsFor: 'as yet unclassified' stamp: 'MP 11/15/2021 21:39:28' prior: 50973559!
listeningOn: aPortNumber

	^self basic new initializeWith: aPortNumber.! !
!TusLibrosServer class methodsFor: 'as yet unclassified' stamp: 'MP 11/15/2021 21:39:35' prior: 50973831!
listeningOn: aPortNumber

	^self basicNew initializeWith: aPortNumber.! !

----SNAPSHOT----(15 November 2021 21:39:37) CuisUniversity-4972.image priorSource: 20549521!

!testRun: #TusLibrosServerTest #test01 stamp: 'MP 11/15/2021 21:39:40'!
PASSED!
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/15/2021 21:40:12' prior: 50973740!
test01

	|server resp client|
	
	server _ TusLibrosServer listeningOn: 8080.
	
	client _ WebClient new.
	resp _ client httpGet: 'http://localhost:8080/createCart?clientId=cliente&password=psw'.
	
	client close.
	server destroy.
	self assert: '0|0001' equals: resp content.
	! !

----SNAPSHOT----(15 November 2021 21:40:36) CuisUniversity-4972.image priorSource: 20550121!

!testRun: #TusLibrosServerTest #test01 stamp: 'MP 11/15/2021 21:40:38'!
FAILURE!

!testRun: #TusLibrosServerTest #test01 stamp: 'MP 11/15/2021 21:40:39'!
FAILURE!
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/15/2021 21:40:46' prior: 50973849!
test01

	|server resp client|
	
	server _ TusLibrosServer listeningOn: 8080.
	
	client _ WebClient new.
	resp _ client httpGet: 'http://localhost:8080/createCart?clientId=cliente&password=psw'.
	
	client close.
	server destroy.
	self assert: '0|0000' equals: resp content.
	! !

----SNAPSHOT----(15 November 2021 21:40:49) CuisUniversity-4972.image priorSource: 20550709!

----STARTUP---- (15 November 2021 21:41:24) as D:\001.Maca\2c2021\inge1\qa3\CuisUniversity-4972.image!

!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/15/2021 21:43:17' prior: 50973808!
initializeWith: aPortNumber 
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
		request send200Response: '0|0000'.
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: '1|',anError messageText ]].
	
	webServer startListener.
! !
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/15/2021 21:43:23' prior: 50973887!
initializeWith: aPortNumber 
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
		request send200Response: '0|0000'.
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: '1|',(anError messageText) ]].
	
	webServer startListener.
! !

----SNAPSHOT----(15 November 2021 21:48:59) CuisUniversity-4972.image priorSource: 20551349!

----STARTUP---- (17 November 2021 15:28:31) as D:\001.Maca\2c2021\inge1\qa3\CuisUniversity-4972.image!

!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 15:29:20' prior: 50973869!
test01

	|server resp client|
	
	server _ TusLibrosServer listeningOn: 8080.
	
	client _ WebClient new.
	resp _ client httpGet: 'http://localhost:8080/createCart?clientId=cliente&password=psw'.
	self halt.
	
	client close.
	server destroy.
	self assert: '0|0000' equals: resp content.
	! !

----STARTUP---- (17 November 2021 15:30:08) as D:\001.Maca\2c2021\inge1\qa3\CuisUniversity-4972.image!

!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 15:30:24' prior: 50973869!
test01

	|server resp client|
	
	server _ TusLibrosServer listeningOn: 8080.
	
	client _ WebClient new.
	resp _ client httpGet: 'http://localhost:8080/createCart?clientId=cliente&password=psw'.
	
	client close.
	server destroy.
	self halt.
	self assert: '0|0000' equals: resp content.
	! !

self content!

----STARTUP---- (17 November 2021 15:31:07) as D:\001.Maca\2c2021\inge1\qa3\CuisUniversity-4972.image!


	self halt.!

	self halt.!
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 15:31:21' prior: 50973869!
test01

	|server resp client|
	
	server _ TusLibrosServer listeningOn: 8080.
	
	client _ WebClient new.
	resp _ client httpGet: 'http://localhost:8080/createCart?clientId=cliente&password=psw'.
	self halt.
	
	client close.
	server destroy.
	self assert: '0|0000' equals: resp content.
	! !

self content.!

self content.!

self content.!
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 15:32:22' prior: 50973954!
test01

	|server resp client|
	
	server _ TusLibrosServer listeningOn: 8080.
	
	client _ WebClient new.
	resp _ client httpGet: 'http://localhost:8080/createCart?clientId=cliente&password=psw'.
	
	client close.
	server destroy.
	self assert: '0|0000' equals: resp content.
	! !
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 15:33:24' prior: 50973968!
test01

	|server resp client|
	
	server _ TusLibrosServer listeningOn: 8080.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=cliente&password=psw') content.
	
	client close.
	server destroy.
	self assert: '0|0000' equals: resp.
	! !

!testRun: #TusLibrosServerTest #test01 stamp: 'MP 11/17/2021 15:33:38'!
PASSED!

!testRun: #TusLibrosServerTest #test01 stamp: 'MP 11/17/2021 15:33:38'!
PASSED!

!testRun: #TusLibrosServerTest #test01 stamp: 'MP 11/17/2021 15:33:42'!
PASSED!

!testRun: #TusLibrosServerTest #test01 stamp: 'MP 11/17/2021 15:33:42'!
PASSED!
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 15:35:40'!
test01CreateCartForValidCredentials

	|server resp client|
	
	server _ TusLibrosServer listeningOn: 8080.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=cliente&password=psw') content.
	
	client close.
	server destroy.
	self assert: '0|0000' equals: resp.
	! !

!methodRemoval: TusLibrosServerTest #test01 stamp: 'MP 11/17/2021 15:35:40'!
test01

	|server resp client|
	
	server _ TusLibrosServer listeningOn: 8080.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=cliente&password=psw') content.
	
	client close.
	server destroy.
	self assert: '0|0000' equals: resp.
	!
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 15:40:22'!
test02CreateCartForInvalidCredentials

	|server resp client|
	
	server _ TusLibrosServer listeningOn: 8080.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=client&password=invalidPassword') content.
	
	client close.
	server destroy.
	self assert: '0|0000' equals: resp.
	! !
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 15:40:46' prior: 50974002!
test01CreateCartForValidCredentials

	|server resp client|
	
	server _ TusLibrosServer listeningOn: 8080.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=client&password=password') content.
	
	client close.
	server destroy.
	self assert: '0|0000' equals: resp.
	! !
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 15:44:14' prior: 50974026!
test02CreateCartForInvalidCredentials

	|server resp client|
	
	
	
	server _ TusLibrosServer listeningOn: 8080 toInterface: self mockInterface.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=client&password=invalidPassword') content.
	
	client close.
	server destroy.
	self assert: '0|0000' equals: resp.
	! !
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 15:44:21' prior: 50974054!
test02CreateCartForInvalidCredentials

	|server resp client|
	
	self setup.
	
	server _ TusLibrosServer listeningOn: 8080 toInterface: self mockInterface.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=client&password=invalidPassword') content.
	
	client close.
	server destroy.
	self assert: '0|0000' equals: resp.
	! !
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 15:46:09' prior: 50974069!
test02CreateCartForInvalidCredentials

	|server resp client interface|
	
	server _ TusLibrosServer listeningOn: 8080 toInterface: self mockInterface.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=client&password=invalidPassword') content.
	
	client close.
	server destroy.
	self assert: '0|0000' equals: resp.
	! !
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 15:46:16' prior: 50974084!
test02CreateCartForInvalidCredentials

	|server resp client|
	
	server _ TusLibrosServer listeningOn: 8080 toInterface: self mockInterface.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=client&password=invalidPassword') content.
	
	client close.
	server destroy.
	self assert: '0|0000' equals: resp.
	! !

!classDefinition: #TusLibrosServerTest category: 'TusLibros-Tests' stamp: 'MP 11/17/2021 15:46:53'!
TestCase subclass: #TusLibrosServerTest
	instanceVariableNames: 'testObjectsFactory clock'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!

!classDefinition: #TusLibrosServerTest category: 'TusLibros-Tests' stamp: 'MP 11/17/2021 15:46:55'!
TestCase subclass: #TusLibrosServerTest
	instanceVariableNames: 'testObjectsFactory clock systemFacade'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 15:46:51' overrides: 16927572!
setUp
	
	testObjectsFactory := StoreTestObjectsFactory new.
	clock := ManualClock now: testObjectsFactory today.
	systemFacade := TusLibrosSystemFacade
		authenticatingWith: self validUsersAndPasswords
		acceptingItemsOf: testObjectsFactory defaultCatalog
		registeringOn: self createSalesBook
		debitingThrought: self merchantProcessor
		measuringTimeWith: clock
! !
!TusLibrosServerTest methodsFor: 'test objects' stamp: 'MP 11/17/2021 15:47:47'!
validUser

	^'validUser'! !
!TusLibrosServerTest methodsFor: 'test objects' stamp: 'MP 11/17/2021 15:47:55'!
avalidUserPassword

	^'validUserPassword'! !
!TusLibrosServerTest methodsFor: 'test objects' stamp: 'MP 11/17/2021 15:48:07'!
avalidUsersAndPasswords

	^Dictionary new
		at: self validUser put: self validUserPassword;
		yourself! !
!TusLibrosServerTest methodsFor: 'test objects' stamp: 'MP 11/17/2021 15:48:17'!
validUsersAndPasswords

	^Dictionary new
		at: self validUser put: self validUserPassword;
		yourself! !

!methodRemoval: TusLibrosServerTest #avalidUsersAndPasswords stamp: 'MP 11/17/2021 15:48:17'!
avalidUsersAndPasswords

	^Dictionary new
		at: self validUser put: self validUserPassword;
		yourself!
!TusLibrosServerTest methodsFor: 'test objects' stamp: 'MP 11/17/2021 15:48:21'!
validUserPassword

	^'validUserPassword'! !

!methodRemoval: TusLibrosServerTest #avalidUserPassword stamp: 'MP 11/17/2021 15:48:21'!
avalidUserPassword

	^'validUserPassword'!
!TusLibrosServerTest methodsFor: 'setup' stamp: 'MP 11/17/2021 15:48:58'!
createSalesBook

	^OrderedCollection new! !
!TusLibrosServerTest methodsFor: 'setup' stamp: 'MP 11/17/2021 15:49:07'!
merchantProcessor

	^self! !
!TusLibrosServerTest methodsFor: 'tests' stamp: 'MP 11/17/2021 15:49:51' prior: 50974099!
test02CreateCartForInvalidCredentials

	|server resp client|
	
	server _ TusLibrosServer listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=client&password=invalidPassword') content.
	
	client close.
	server destroy.
	self assert: '0|0000' equals: resp.
	! !
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/17/2021 15:50:48'!
initializeWith: aPortNumber communicateWith: aSystemFacade  
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
		request send200Response: '0|0000'.
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: '1|',(anError messageText) ]].
	
	webServer startListener.
! !
!TusLibrosServer class methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 15:50:48' prior: 50973837!
listeningOn: aPortNumber

	^self basicNew initializeWith: aPortNumber communicateWith: systemFacade.! !

!methodRemoval: TusLibrosServer #initializeWith: stamp: 'MP 11/17/2021 15:50:48'!
initializeWith: aPortNumber 
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
		request send200Response: '0|0000'.
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: '1|',(anError messageText) ]].
	
	webServer startListener.
!
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/17/2021 15:51:34'!
initializeWith: aPortNumber   
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
		request send200Response: '0|0000'.
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: '1|',(anError messageText) ]].
	
	webServer startListener.
! !
!TusLibrosServer class methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 15:51:34' prior: 50974218!
listeningOn: aPortNumber

	^self basicNew initializeWith: aPortNumber .! !

!methodRemoval: TusLibrosServer #initializeWith:communicateWith: stamp: 'MP 11/17/2021 15:51:34'!
initializeWith: aPortNumber communicateWith: aSystemFacade  
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
		request send200Response: '0|0000'.
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: '1|',(anError messageText) ]].
	
	webServer startListener.
!
!TusLibrosServer class methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 15:52:04'!
listeningOn: aPortNumber communicateWith: aSystemFacade 

	^self basicNew initializeWith: aPortNumber .! !

!methodRemoval: TusLibrosServer class #listeningOn: stamp: 'MP 11/17/2021 15:52:04'!
listeningOn: aPortNumber

	^self basicNew initializeWith: aPortNumber .!
!TusLibrosServerTest methodsFor: 'tests' stamp: 'MP 11/17/2021 15:52:33' prior: 50974040!
test01CreateCartForValidCredentials

	|server resp client|
	
	server _ TusLibrosServer listeningOn: 8080 communicateWith: systemFacade .
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=client&password=password') content.
	
	client close.
	server destroy.
	self assert: '0|0000' equals: resp.
	! !
!TusLibrosServerTest methodsFor: 'tests' stamp: 'MP 11/17/2021 15:52:34' prior: 50974283!
test01CreateCartForValidCredentials

	|server resp client|
	
	server _ TusLibrosServer listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=client&password=password') content.
	
	client close.
	server destroy.
	self assert: '0|0000' equals: resp.
	! !
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/17/2021 15:53:32'!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
		request send200Response: '0|0000'.
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: '1|',(anError messageText) ]].
	
	webServer startListener.
! !
!TusLibrosServer class methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 15:53:33' prior: 50974271!
listeningOn: aPortNumber communicateWith: aSystemFacade 

	^self basicNew initializeWith: aPortNumber and: systemFacade .! !

!methodRemoval: TusLibrosServer #initializeWith: stamp: 'MP 11/17/2021 15:53:33'!
initializeWith: aPortNumber   
	
	port := aPortNumber.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
		request send200Response: '0|0000'.
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: '1|',(anError messageText) ]].
	
	webServer startListener.
!
!TusLibrosServer class methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 15:53:46' prior: 50974326!
listeningOn: aPortNumber communicateWith: aSystemFacade 

	^self basicNew initializeWith: aPortNumber and: aSystemFacade .! !

!classDefinition: #TusLibrosServer category: 'TusLibros-Model' stamp: 'MP 11/17/2021 15:54:07'!
Object subclass: #TusLibrosServer
	instanceVariableNames: 'port webServer systemFacade'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/17/2021 15:54:06' prior: 50974311!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
		request send200Response: '0|0000'.
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: '1|',(anError messageText) ]].
	
	webServer startListener.
! !
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/17/2021 15:56:53' prior: 50974363!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user password |
			user := (request fields at:'clientId').
			password := (request fields at:'password').
			systemFacade does: user authenticatesWith: password.
			request send200Response: '0|0000'.
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: '1|',(anError messageText) ]].
	
	webServer startListener.
! !
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/17/2021 15:56:59' prior: 50974378!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
			systemFacade does: user authenticatesWith: psw.
			request send200Response: '0|0000'.
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: '1|',(anError messageText) ]].
	
	webServer startListener.
! !

!testRun: #TusLibrosServerTest #test02CreateCartForInvalidCredentials stamp: 'MP 11/17/2021 15:57:06'!
PASSED!

!testRun: #TusLibrosServerTest #test01CreateCartForValidCredentials stamp: 'MP 11/17/2021 15:57:07'!
PASSED!

!testRun: #TusLibrosServerTest #test02CreateCartForInvalidCredentials stamp: 'MP 11/17/2021 15:57:07'!
PASSED!
!TusLibrosServerTest methodsFor: 'tests' stamp: 'MP 11/17/2021 15:57:16' prior: 50974189!
test02CreateCartForInvalidCredentials

	|server resp client|
	
	server _ TusLibrosServer listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=client&password=invalidPassword') content.
	
	client close.
	server destroy.
	self assert: '1|INVALID_PASSWORD' equals: resp.
	! !

!testRun: #TusLibrosServerTest #test02CreateCartForInvalidCredentials stamp: 'MP 11/17/2021 15:57:17'!
FAILURE!
!TusLibrosServer class methodsFor: 'error handling' stamp: 'MP 11/17/2021 15:58:49'!
invalidUserOrPasswordErrorDescription
	^ 'INVALID_USERNAME_OR_PASSWORD'! !
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/17/2021 15:59:36' prior: 50974399!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
			systemFacade does: user authenticatesWith: psw.
			request send200Response: '0|0000'.
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: '1|',(anError messageText) ]].
	
	webServer startListener.
! !
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/17/2021 16:03:05' prior: 50974453!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw. 
			request send200Response: '0|',cartId.
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: '1|',(anError messageText) ]].
	
	webServer startListener.
! !

!testRun: #TusLibrosServerTest #test01CreateCartForValidCredentials stamp: 'MP 11/17/2021 16:03:07'!
FAILURE!

!testRun: #TusLibrosServerTest #test02CreateCartForInvalidCredentials stamp: 'MP 11/17/2021 16:03:07'!
FAILURE!

!testRun: #TusLibrosServerTest #test01CreateCartForValidCredentials stamp: 'MP 11/17/2021 16:03:16'!
FAILURE!
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/17/2021 16:03:55' prior: 50974473!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw. 
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: '1|',(anError messageText) ]].
	
	webServer startListener.
! !

!testRun: #TusLibrosServerTest #test01CreateCartForValidCredentials stamp: 'MP 11/17/2021 16:03:56'!
FAILURE!

!testRun: #TusLibrosServerTest #test02CreateCartForInvalidCredentials stamp: 'MP 11/17/2021 16:03:56'!
FAILURE!

!testRun: #TusLibrosServerTest #test01CreateCartForValidCredentials stamp: 'MP 11/17/2021 16:04:02'!
FAILURE!
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/17/2021 16:11:48' prior: 50974505!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			self halt. 
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: '1|',(anError messageText) ]].
	
	webServer startListener.
! !

			self halt. !

!testRun: #TusLibrosServerTest #test01CreateCartForValidCredentials stamp: 'MP 11/17/2021 16:12:14'!
FAILURE!
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/17/2021 16:12:22' prior: 50974537!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: '1|',(anError messageText) ]].
	
	webServer startListener.
! !

!testRun: #TusLibrosServerTest #test01CreateCartForValidCredentials stamp: 'MP 11/17/2021 16:12:24'!
FAILURE!
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/17/2021 16:14:09' prior: 50974563!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			self halt.
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: '1|',(anError messageText) ]].
	
	webServer startListener.
! !

!testRun: #TusLibrosServerTest #test01CreateCartForValidCredentials stamp: 'MP 11/17/2021 16:14:14'!
FAILURE!

!testRun: #TusLibrosServerTest #test01CreateCartForValidCredentials stamp: 'MP 11/17/2021 16:14:23'!
FAILURE!
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/17/2021 16:17:01' prior: 50974588!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			self halt.
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			anError messageText = TusLibrosSystemFacade invalidUserOrPasswordErrorDescription ifTrue: [request send400Response: '1|',(TusLibrosServer invalidUserOrPasswordErrorDescription )].
			request send400Response: '1|',(anError messageText) ]].
	
	webServer startListener.
! !

!testRun: #TusLibrosServerTest #test01CreateCartForValidCredentials stamp: 'MP 11/17/2021 16:17:05'!
FAILURE!

!testRun: #TusLibrosServerTest #test02CreateCartForInvalidCredentials stamp: 'MP 11/17/2021 16:17:05'!
FAILURE!

!testRun: #TusLibrosServerTest #test01CreateCartForValidCredentials stamp: 'MP 11/17/2021 16:17:08'!
FAILURE!
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/17/2021 16:17:34' prior: 50974617!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			anError messageText = TusLibrosSystemFacade invalidUserOrPasswordErrorDescription ifTrue: [request send400Response: '1|',(TusLibrosServer invalidUserOrPasswordErrorDescription )].
			request send400Response: '1|',(anError messageText) ]].
	
	webServer startListener.
! !
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/17/2021 16:19:28' prior: 50974655!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			(anError messageText = TusLibrosSystemFacade invalidUserOrPasswordErrorDescription) ifTrue: [request send400Response: '1|',(TusLibrosServer invalidUserOrPasswordErrorDescription )].
			request send400Response: '1|',(anError messageText) ]].
	
	webServer startListener.
! !
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/17/2021 16:21:09' prior: 50974682!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			(anError messageText = TusLibrosSystemFacade invalidUserOrPasswordErrorDescription ) 
				ifTrue: [request send400Response: '1|',(TusLibrosServer invalidUserOrPasswordErrorDescription )].
			request send400Response: '1|',(anError messageText) ]].
	
	webServer startListener.
! !
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/17/2021 16:22:06' prior: 50974709!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			(anError messageText = TusLibrosSystemFacade invalidUserOrPasswordErrorDescription ) 
				ifTrue: [request send400Response: '1|',(TusLibrosServer invalidUserOrPasswordErrorDescription )] ifFalse: [
			request send400Response: '1|',(anError messageText) ]
		]
	].
	
	webServer startListener.
! !

!testRun: #TusLibrosServerTest #test01CreateCartForValidCredentials stamp: 'MP 11/17/2021 16:22:08'!
FAILURE!

!testRun: #TusLibrosServerTest #test02CreateCartForInvalidCredentials stamp: 'MP 11/17/2021 16:22:08'!
FAILURE!

!testRun: #TusLibrosServerTest #test01CreateCartForValidCredentials stamp: 'MP 11/17/2021 16:22:10'!
FAILURE!
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/17/2021 16:22:29' prior: 50974737!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			(anError messageText = TusLibrosSystemFacade invalidUserOrPasswordErrorDescription ) 
				ifTrue: [request send400Response: '1|',(TusLibrosServer invalidUserOrPasswordErrorDescription )].
		]
	].
	
	webServer startListener.
! !

!testRun: #TusLibrosServerTest #test01CreateCartForValidCredentials stamp: 'MP 11/17/2021 16:22:31'!
FAILURE!

!testRun: #TusLibrosServerTest #test02CreateCartForInvalidCredentials stamp: 'MP 11/17/2021 16:22:31'!
FAILURE!

!testRun: #TusLibrosServerTest #test01CreateCartForValidCredentials stamp: 'MP 11/17/2021 16:22:33'!
FAILURE!

TusLibrosServer allInstances.!

TusLibrosServer allInstances do: [:i | i destroy].!

TusLibrosServer allInstances .!

TusLibrosServer allInstances .!

TusLibrosServer allInstances do: [:instance | instance destroy].!

TusLibrosServer allInstances do: [:instance | instance destroy].!

TusLibrosServer allInstances do: [:instance | instance destroy].!

TusLibrosServer allInstances do: [:instance | instance destroy].!

TusLibrosServer allInstances do: [:instance | instance destroy].!

TusLibrosServer allInstances.!

TusLibrosServer allInstances do: [:i | i delete ].!

TusLibrosServer allInstances.!

!testRun: #TusLibrosServerTest #test01CreateCartForValidCredentials stamp: 'MP 11/17/2021 16:26:40'!
FAILURE!

TusLibrosServer allInstances.!
!TusLibrosServerTest methodsFor: 'tests' stamp: 'MP 11/17/2021 16:27:14' prior: 50974297!
test01CreateCartForValidCredentials

	|server resp client|
	
	server _ TusLibrosServer listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=client&password=password') content.
	
	client close.
	server destroy.
	server delete.
	self assert: '0|0000' equals: resp.
	! !

TusLibrosServer allInstances do: [:i | i delete ].!

TusLibrosServer allInstances do: [:i | i delete ].!

TusLibrosServer allInstances.!

TusLibrosServer allInstances do: [:i | i delete ].!

TusLibrosServer allInstances do: [:instance | instance destroy].!

TusLibrosServer allInstances.!

TusLibrosServer allInstances.!

TusLibrosServer allInstances do: [:instance | instance destroy].!

TusLibrosServer allInstances do: [:i | i delete].!

TusLibrosServer allInstances.!

TusLibrosServer allInstances do: [:instance | instance destroy].!

TusLibrosServer allInstances do: [:instance | instance destroy].!

TusLibrosServer allInstances do: [:instance | instance destroy].!

TusLibrosServer allInstances.!

TusLibrosServer allInstances.!
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/17/2021 16:30:34' prior: 50974776!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			(anError messageText = systemFacade signalInvalidUserAndOrPassword) 
				ifTrue: [request send400Response: '1|',(TusLibrosServer invalidUserOrPasswordErrorDescription )].
		]
	].
	
	webServer startListener.
! !
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/17/2021 16:31:09' prior: 50974874!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			(anError messageText = systemFacade signalInvalidUserAndOrPassword) 
				ifTrue: [request send400Response: '1|',(TusLibrosServer invalidUserOrPasswordErrorDescription )] 
				ifFalse: [request send400Response: '1|',anError].
		]
	].
	
	webServer startListener.
! !

!testRun: #TusLibrosServerTest #test01CreateCartForValidCredentials stamp: 'MP 11/17/2021 16:31:10'!
ERROR!

!testRun: #TusLibrosServerTest #test02CreateCartForInvalidCredentials stamp: 'MP 11/17/2021 16:31:11'!
FAILURE!

!testRun: #TusLibrosServerTest #test01CreateCartForValidCredentials stamp: 'MP 11/17/2021 16:31:13'!
ERROR!
!TusLibrosServerTest methodsFor: 'tests' stamp: 'MP 11/17/2021 16:31:21' prior: 50974836!
test01CreateCartForValidCredentials

	|server resp client|
	
	server _ TusLibrosServer listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=client&password=password') content.
	
	client close.
	server destroy.
	self assert: '0|0000' equals: resp.
	! !

TusLibrosServer allInstances.!

TusLibrosServer allInstances do: [:instance | instance destroy].!

TusLibrosServer allInstances.!

TusLibrosServer allInstances do: [:i | i delete].!

TusLibrosServer allInstances.!

WebServer allInstances.!

WebServer allInstances do: [:i | i destroy].!

WebServer allInstances.!

WebServer allInstances do: [:i | i delete].!

!testRun: #TusLibrosServerTest #test01CreateCartForValidCredentials stamp: 'MP 11/17/2021 16:33:08'!
FAILURE!
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/17/2021 16:34:04' prior: 50974899!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			(anError messageText = systemFacade signalInvalidUserAndOrPassword) 
				ifTrue: [request send400Response: '1|',(TusLibrosServer invalidUserOrPasswordErrorDescription )] .
		]
	].
	
	webServer startListener.
! !

!testRun: #TusLibrosServerTest #test01CreateCartForValidCredentials stamp: 'MP 11/17/2021 16:34:08'!
FAILURE!

----SNAPSHOT----(17 November 2021 16:34:12) CuisUniversity-4972.image priorSource: 20552423!

TusLibrosServer allInstances do: [:i | i delete].!

WebServer allInstances.!

!testRun: #TusLibrosServerTest #test01CreateCartForValidCredentials stamp: 'MP 11/17/2021 16:34:28'!
FAILURE!
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/17/2021 16:35:23' prior: 50974965!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			(anError messageText = systemFacade signalInvalidUserAndOrPassword) 
				ifTrue: [request send400Response: '1|',(TusLibrosServer invalidUserOrPasswordErrorDescription)] .
		]
	].
	
	webServer startListener.
! !

WebServer allInstances.!

WebServer allInstances do: [:i | i destroy].!

WebServer allInstances.!

WebServer allInstances.!

WebServer allInstances.!
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/17/2021 16:36:52' prior: 50975003!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			(anError messageText = systemFacade signalInvalidUserAndOrPassword) 
				ifFalse: [request send400Response: '1|',(TusLibrosServer invalidUserOrPasswordErrorDescription)] .
		]
	].
	
	webServer startListener.
! !
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/17/2021 16:37:13' prior: 50975033!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			(anError messageText = systemFacade signalInvalidUserAndOrPassword) 
				ifFalse: [request send400Response: '1|',(TusLibrosServer invalidUserOrPasswordErrorDescription)] .
			request send200Response: '0|0000' asString .
		]
	].
	
	webServer startListener.
! !

!testRun: #TusLibrosServerTest #test01CreateCartForValidCredentials stamp: 'MP 11/17/2021 16:37:15'!
FAILURE!

----SNAPSHOT----(17 November 2021 16:37:42) CuisUniversity-4972.image priorSource: 20586959!

----STARTUP---- (17 November 2021 16:37:56) as D:\001.Maca\2c2021\inge1\qa3\CuisUniversity-4972.image!


!testRun: #TusLibrosServerTest #test01CreateCartForValidCredentials stamp: 'MP 11/17/2021 16:38:18'!
FAILURE!

WebServer allInstances.!

WebServer allInstances.!

TusLibrosServer allInstances.!

WebServer allInstances do: [:i | i stopListening ].!

----SNAPSHOT----(17 November 2021 16:45:13) CuisUniversity-4972.image priorSource: 20589983!

----STARTUP---- (18 November 2021 17:40:49) as D:\001.Maca\2c2021\inge1\qa3\CuisUniversity-4972.image!


TusLibrosServer allInstances.!

WebServer allInstances. !
!TusLibrosServerTest methodsFor: 'tests' stamp: 'MP 11/18/2021 17:43:52' prior: 50974936!
test01CreateCartForValidCredentials

	|server resp client|
	
	server _ TusLibrosServer listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ) content.
	
	client close.
	server destroy.
	self assert: '0|0000' equals: resp.
	! !
!TusLibrosServerTest methodsFor: 'tests' stamp: 'MP 11/18/2021 17:44:39' prior: 50974429!
test02CreateCartForInvalidCredentials

	|server resp client|
	
	server _ TusLibrosServer listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword,'BAD') content.
	
	client close.
	server destroy.
	self assert: '1|INVALID_PASSWORD' equals: resp.
	! !

!testRun: #TusLibrosServerTest #test01CreateCartForValidCredentials stamp: 'MP 11/18/2021 17:46:34'!
FAILURE!

!testRun: #TusLibrosServerTest #test01CreateCartForValidCredentials stamp: 'MP 11/18/2021 17:47:27'!
FAILURE!
!TusLibrosServerTest methodsFor: 'tests' stamp: 'MP 11/18/2021 17:47:35' prior: 50975110!
test01CreateCartForValidCredentials

	|server resp client|
	
	server _ TusLibrosServer listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ) content.
	
	client close.
	server destroy.
	self assert: '0|1' equals: resp.
	! !

!testRun: #TusLibrosServerTest #test01CreateCartForValidCredentials stamp: 'MP 11/18/2021 17:47:36'!
PASSED!

!testRun: #TusLibrosServerTest #test01CreateCartForValidCredentials stamp: 'MP 11/18/2021 17:47:36'!
PASSED!

!testRun: #TusLibrosServerTest #test02CreateCartForInvalidCredentials stamp: 'MP 11/18/2021 17:47:36'!
FAILURE!

!testRun: #TusLibrosServerTest #test02CreateCartForInvalidCredentials stamp: 'MP 11/18/2021 17:47:36'!
FAILURE!

self content!
!TusLibrosServerTest methodsFor: 'tests' stamp: 'MP 11/18/2021 17:49:47' prior: 50975147!
test01CreateCartForValidCredentials

	|server resp client respText |
	
	server _ TusLibrosServer listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	respText _ resp content.
	
	client close.
	server destroy.
	self assert: '0|1' equals: respText.
	! !

!testRun: #TusLibrosServerTest #test01CreateCartForValidCredentials stamp: 'MP 11/18/2021 17:49:53'!
PASSED!

!testRun: #TusLibrosServerTest #test01CreateCartForValidCredentials stamp: 'MP 11/18/2021 17:49:53'!
PASSED!

!testRun: #TusLibrosServerTest #test02CreateCartForInvalidCredentials stamp: 'MP 11/18/2021 17:49:53'!
FAILURE!

!testRun: #TusLibrosServerTest #test02CreateCartForInvalidCredentials stamp: 'MP 11/18/2021 17:49:53'!
FAILURE!
!TusLibrosServerTest methodsFor: 'tests' stamp: 'MP 11/18/2021 17:50:45' prior: 50975125!
test02CreateCartForInvalidCredentials

	|server resp client respText |
	
	server _ TusLibrosServer listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword,'BAD').
	respText _ resp content.
	
	client close.
	server destroy.
	self assert: '1|INVALID_PASSWORD' equals: respText.
	! !

!testRun: #TusLibrosServerTest #test02CreateCartForInvalidCredentials stamp: 'MP 11/18/2021 17:50:48'!
FAILURE!
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/18/2021 17:53:14' prior: 50975058!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			(anError messageText = systemFacade signalInvalidUserAndOrPassword) 
				ifFalse: [request send400Response: '1|',(TusLibrosServer invalidUserOrPasswordErrorDescription)] .
			request send400Response: 'Error' asString .
		]
	].
	
	webServer startListener.
! !
!TusLibrosServerTest methodsFor: 'test objects' stamp: 'MP 11/18/2021 17:53:50'!
invalidPassword

	^'invalidPassword'! !
!TusLibrosServerTest methodsFor: 'tests' stamp: 'MP 11/18/2021 17:54:04' prior: 50975206!
test02CreateCartForInvalidCredentials

	|server resp client respText |
	
	server _ TusLibrosServer listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self invalidPassword ).
	respText _ resp content.
	
	client close.
	server destroy.
	self assert: '1|INVALID_PASSWORD' equals: respText.
	! !

!testRun: #TusLibrosServerTest #test02CreateCartForInvalidCredentials stamp: 'MP 11/18/2021 17:54:05'!
FAILURE!

TusLibrosServer allInstances.!

TusLibrosServer allInstances.!

TusLibrosServer allInstances.!

TusLibrosServer allInstances.!

----SNAPSHOT----(18 November 2021 17:56:11) CuisUniversity-4972.image priorSource: 20590431!
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/18/2021 17:59:39' prior: 50975226!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			(anError messageText = systemFacade signalInvalidUserAndOrPassword) 
				ifFalse: [request send400Response: '1|',(TusLibrosServer invalidUserOrPasswordErrorDescription)] .
			request send400Response: 'Error'.
		]
	].
	
	webServer startListener.
! !
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/18/2021 18:01:44' prior: 50975285!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			(anError messageText = systemFacade signalInvalidUserAndOrPassword) 
				ifTrue: [request send400Response: '1|',(TusLibrosServer invalidUserOrPasswordErrorDescription)] 
				ifFalse: [request send400Response: 'Unknown error: ', anError messageText	].
		]
	].
	
	webServer startListener.
! !

!testRun: #TusLibrosServerTest #test01CreateCartForValidCredentials stamp: 'MP 11/18/2021 18:01:56'!
PASSED!

!testRun: #TusLibrosServerTest #test02CreateCartForInvalidCredentials stamp: 'MP 11/18/2021 18:01:57'!
FAILURE!

!testRun: #TusLibrosServerTest #test02CreateCartForInvalidCredentials stamp: 'MP 11/18/2021 18:01:57'!
FAILURE!

----SNAPSHOT----(18 November 2021 18:02:17) CuisUniversity-4972.image priorSource: 20596175!
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/18/2021 18:02:24' prior: 50975312!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
			self halt.
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			(anError messageText = systemFacade signalInvalidUserAndOrPassword) 
				ifTrue: [request send400Response: '1|',(TusLibrosServer invalidUserOrPasswordErrorDescription)] 
				ifFalse: [request send400Response: 'Unknown error: ', anError messageText	].
		]
	].
	
	webServer startListener.
! !

!testRun: #TusLibrosServerTest #test01CreateCartForValidCredentials stamp: 'MP 11/18/2021 18:03:11'!
ERROR!

!testRun: #TusLibrosServerTest #test02CreateCartForInvalidCredentials stamp: 'MP 11/18/2021 18:03:56'!
FAILURE!

!testRun: #TusLibrosServerTest #test01CreateCartForValidCredentials stamp: 'MP 11/18/2021 18:04:37'!
FAILURE!

!testRun: #TusLibrosServerTest #test02CreateCartForInvalidCredentials stamp: 'MP 11/18/2021 18:05:22'!
FAILURE!

!testRun: #TusLibrosServerTest #test02CreateCartForInvalidCredentials stamp: 'MP 11/18/2021 18:06:42'!
FAILURE!

!testRun: #TusLibrosServerTest #test02CreateCartForInvalidCredentials stamp: 'MP 11/18/2021 18:07:25'!
FAILURE!
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/18/2021 18:07:44' prior: 50975353!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
			self halt.
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			self halt.
			(anError messageText = systemFacade signalInvalidUserAndOrPassword) 
				ifTrue: [request send400Response: '1|',(TusLibrosServer invalidUserOrPasswordErrorDescription)] 
				ifFalse: [request send400Response: 'Unknown error: ', anError messageText	].
		]
	].
	
	webServer startListener.
! !

----SNAPSHOT----(18 November 2021 18:08:14) CuisUniversity-4972.image priorSource: 20598367!

----STARTUP---- (18 November 2021 18:09:37) as D:\001.Maca\2c2021\inge1\qa3\CuisUniversity-4972.image!


!testRun: #TusLibrosServerTest #test01CreateCartForValidCredentials stamp: 'MP 11/18/2021 18:10:17'!
FAILURE!

!testRun: #TusLibrosServerTest #test02CreateCartForInvalidCredentials stamp: 'MP 11/18/2021 18:10:41'!
FAILURE!

TusLibrosServer allInstances.!

----STARTUP---- (18 November 2021 18:11:27) as D:\001.Maca\2c2021\inge1\qa3\CuisUniversity-4972.image!


!testRun: #TusLibrosServerTest #test01CreateCartForValidCredentials stamp: 'MP 11/18/2021 18:12:15'!
FAILURE!

!testRun: #TusLibrosServerTest #test02CreateCartForInvalidCredentials stamp: 'MP 11/18/2021 18:12:30'!
FAILURE!

TusLibrosServer allInstances do: [:instance | instance destroy].!

TusLibrosServer allInstances.!

!testRun: #TusLibrosServerTest #test01CreateCartForValidCredentials stamp: 'MP 11/18/2021 18:13:03'!
PASSED!

!testRun: #TusLibrosServerTest #test02CreateCartForInvalidCredentials stamp: 'MP 11/18/2021 18:13:48'!
ERROR!

!testRun: #TusLibrosServerTest #test02CreateCartForInvalidCredentials stamp: 'MP 11/18/2021 18:14:16'!
FAILURE!
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/18/2021 18:15:01' prior: 50975402!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
			self halt.
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			self halt.
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send400Response: '1|',(TusLibrosServer invalidUserOrPasswordErrorDescription)] 
				ifFalse: [request send400Response: 'Unknown error: ', anError messageText	].
		]
	].
	
	webServer startListener.
! !

TusLibrosServer allInstances do: [:instance | instance destroy].!

!testRun: #TusLibrosServerTest #test01CreateCartForValidCredentials stamp: 'MP 11/18/2021 18:15:13'!
PASSED!

!testRun: #TusLibrosServerTest #test02CreateCartForInvalidCredentials stamp: 'MP 11/18/2021 18:15:15'!
FAILURE!

!testRun: #TusLibrosServerTest #test02CreateCartForInvalidCredentials stamp: 'MP 11/18/2021 18:15:17'!
FAILURE!

!testRun: #TusLibrosServerTest #test02CreateCartForInvalidCredentials stamp: 'MP 11/18/2021 18:15:17'!
PASSED!
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/18/2021 18:15:27' prior: 50975469!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			self halt.
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send400Response: '1|',(TusLibrosServer invalidUserOrPasswordErrorDescription)] 
				ifFalse: [request send400Response: 'Unknown error: ', anError messageText	].
		]
	].
	
	webServer startListener.
! !

!testRun: #TusLibrosServerTest #test01CreateCartForValidCredentials stamp: 'MP 11/18/2021 18:16:59'!
PASSED!

!testRun: #TusLibrosServerTest #test02CreateCartForInvalidCredentials stamp: 'MP 11/18/2021 18:17:30'!
FAILURE!

!testRun: #TusLibrosServerTest #test02CreateCartForInvalidCredentials stamp: 'MP 11/18/2021 18:17:44'!
FAILURE!

self content!

TusLibrosServer allInstances do: [:instance | instance destroy].!

TusLibrosServer allInstances.!
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/18/2021 18:20:44' prior: 50975514!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			self halt.
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send400Response: '1|',(TusLibrosServer invalidUserOrPasswordErrorDescription)] 
				ifFalse: [request send400Response: anError messageText capitalized 	].
		]
	].
	
	webServer startListener.
! !
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/18/2021 18:28:15' prior: 50975557!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			self halt.
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: '1|',(TusLibrosServer invalidUserOrPasswordErrorDescription)] 
				ifFalse: [request send400Response: anError messageText capitalized 	].
		]
	].
	
	webServer startListener.
! !
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/18/2021 18:28:20' prior: 50975586!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			self halt.
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: '1|',(TusLibrosServer invalidUserOrPasswordErrorDescription)] 
				ifFalse: [request send400Response: anError messageText	].
		]
	].
	
	webServer startListener.
! !
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/18/2021 18:28:27' prior: 50975615!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			self halt.
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: '1|',(TusLibrosServer invalidUserOrPasswordErrorDescription)] 
				ifFalse: [request send500Response: anError messageText	].
		]
	].
	
	webServer startListener.
! !

----STARTUP---- (18 November 2021 18:28:57) as D:\001.Maca\2c2021\inge1\qa3\CuisUniversity-4972.image!

!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/18/2021 18:15:01' prior: 50975402!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
			self halt.
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			self halt.
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send400Response: '1|',(TusLibrosServer invalidUserOrPasswordErrorDescription)] 
				ifFalse: [request send400Response: 'Unknown error: ', anError messageText	].
		]
	].
	
	webServer startListener.
! !
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/18/2021 18:15:27' prior: 50975674!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			self halt.
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send400Response: '1|',(TusLibrosServer invalidUserOrPasswordErrorDescription)] 
				ifFalse: [request send400Response: 'Unknown error: ', anError messageText	].
		]
	].
	
	webServer startListener.
! !
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/18/2021 18:20:44' prior: 50975703!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			self halt.
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send400Response: '1|',(TusLibrosServer invalidUserOrPasswordErrorDescription)] 
				ifFalse: [request send400Response: anError messageText capitalized 	].
		]
	].
	
	webServer startListener.
! !
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/18/2021 18:28:15' prior: 50975732!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			self halt.
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: '1|',(TusLibrosServer invalidUserOrPasswordErrorDescription)] 
				ifFalse: [request send400Response: anError messageText capitalized 	].
		]
	].
	
	webServer startListener.
! !
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/18/2021 18:28:20' prior: 50975761!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			self halt.
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: '1|',(TusLibrosServer invalidUserOrPasswordErrorDescription)] 
				ifFalse: [request send400Response: anError messageText	].
		]
	].
	
	webServer startListener.
! !
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/18/2021 18:28:27' prior: 50975790!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			self halt.
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: '1|',(TusLibrosServer invalidUserOrPasswordErrorDescription)] 
				ifFalse: [request send500Response: anError messageText	].
		]
	].
	
	webServer startListener.
! !
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/18/2021 18:29:30' prior: 50975818!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: '1|',(TusLibrosServer invalidUserOrPasswordErrorDescription)] 
				ifFalse: [request send500Response: anError messageText	].
		]
	].
	
	webServer startListener.
! !

TusLibrosServer allInstances do: [:instance | instance destroy].!

!testRun: #TusLibrosServerTest #test01CreateCartForValidCredentials stamp: 'MP 11/18/2021 18:29:39'!
PASSED!

!testRun: #TusLibrosServerTest #test02CreateCartForInvalidCredentials stamp: 'MP 11/18/2021 18:29:39'!
FAILURE!

!testRun: #TusLibrosServerTest #test02CreateCartForInvalidCredentials stamp: 'MP 11/18/2021 18:29:39'!
FAILURE!
!TusLibrosServerTest methodsFor: 'tests' stamp: 'MP 11/18/2021 18:30:20' prior: 50975258!
test02CreateCartForInvalidCredentials

	|server resp client respText |
	
	server _ TusLibrosServer listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self invalidPassword ).
	respText _ resp content.
	
	client close.
	server destroy.
	self assert: '1|',TusLibrosServer invalidUserOrPasswordErrorDescription = respText.
	! !

TusLibrosServer allInstances do: [:instance | instance destroy].!

!testRun: #TusLibrosServerTest #test01CreateCartForValidCredentials stamp: 'MP 11/18/2021 18:30:35'!
PASSED!

!testRun: #TusLibrosServerTest #test02CreateCartForInvalidCredentials stamp: 'MP 11/18/2021 18:30:35'!
PASSED!

----SNAPSHOT----(18 November 2021 18:30:38) CuisUniversity-4972.image priorSource: 20600939!

----SNAPSHOT----(18 November 2021 18:50:55) CuisUniversity-4972.image priorSource: 20616351!

----SNAPSHOT----(18 November 2021 21:42:02) CuisUniversity-4972.image priorSource: 20616445!

----STARTUP---- (19 November 2021 11:36:09) as C:\Users\ferra\Desktop\windows64\windows64\CuisUniversity-4972.image!


----End fileIn of \Users\ferra\Desktop\TusLibros-Model.st----!

----End fileIn of \Users\ferra\Desktop\TusLibros-Tests.st----!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AF 11/19/2021 11:37:17'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AF 11/19/2021 11:37:17'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AF 11/19/2021 11:37:17'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AF 11/19/2021 11:37:17'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AF 11/19/2021 11:37:17'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AF 11/19/2021 11:37:17'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AF 11/19/2021 11:37:17'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AF 11/19/2021 11:37:17'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AF 11/19/2021 11:37:17'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AF 11/19/2021 11:37:17'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AF 11/19/2021 11:37:17'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AF 11/19/2021 11:37:17'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AF 11/19/2021 11:37:17'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AF 11/19/2021 11:37:17'!
PASSED!

!testRun: #TusLibrosServerTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 11:37:18'!
PASSED!

!testRun: #TusLibrosServerTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 11:37:18'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CanCreateCartWithValidUserAndPassword stamp: 'AF 11/19/2021 11:37:18'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CanNotCreateCartWithInvalidUser stamp: 'AF 11/19/2021 11:37:18'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03CanNotCreateCartWithInvalidPassword stamp: 'AF 11/19/2021 11:37:18'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04CanAddItemsToACreatedCart stamp: 'AF 11/19/2021 11:37:18'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CanNotAddItemToNotCreatedCart stamp: 'AF 11/19/2021 11:37:18'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CanNotAddItemNotSellByTheStore stamp: 'AF 11/19/2021 11:37:18'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07ListCartOfAnEmptyCartReturnsAnEmptyBag stamp: 'AF 11/19/2021 11:37:18'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CanNotListCartOfInvalidCartId stamp: 'AF 11/19/2021 11:37:18'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09ListCartReturnsTheRightNumberOfItems stamp: 'AF 11/19/2021 11:37:18'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CanCheckoutACart stamp: 'AF 11/19/2021 11:37:18'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CanNotCheckoutANotCreatedCart stamp: 'AF 11/19/2021 11:37:18'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12CanNotCheckoutAnEmptyCart stamp: 'AF 11/19/2021 11:37:18'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CanNotCheckoutWithAnExpiredCreditCard stamp: 'AF 11/19/2021 11:37:18'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14ListPurchasesIncludesBoughtItems stamp: 'AF 11/19/2021 11:37:18'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15CanNotListPurchasesOfInvalidCustomer stamp: 'AF 11/19/2021 11:37:18'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16CanNotListPurchasesOfValidCustomerWithInvalidPassword stamp: 'AF 11/19/2021 11:37:18'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test17CanNotAddToCartWhenSessionIsExpired stamp: 'AF 11/19/2021 11:37:18'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test18CanNotListCartWhenSessionIsExpired stamp: 'AF 11/19/2021 11:37:18'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test19CanNotCheckOutCartWhenSessionIsExpired stamp: 'AF 11/19/2021 11:37:18'!
PASSED!

!classRenamed: #TusLibrosServer as: #TusLibrosRestInterface stamp: 'AF 11/19/2021 11:45:30'!
Smalltalk renameClassNamed: #TusLibrosServer as: #TusLibrosRestInterface!
!TusLibrosRestInterface methodsFor: 'as yet unclassified' stamp: 'AF 11/19/2021 11:45:30' prior: 50972561!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: '1|',(TusLibrosRestInterface invalidUserOrPasswordErrorDescription)] 
				ifFalse: [request send500Response: anError messageText	].
		]
	].
	
	webServer startListener.
! !
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'AF 11/19/2021 11:45:30' prior: 50973169!
test01CreateCartForValidCredentials

	|server resp client respText |
	
	server _ TusLibrosRestInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	respText _ resp content.
	
	client close.
	server destroy.
	self assert: '0|1' equals: respText.
	! !
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'AF 11/19/2021 11:45:30' prior: 50973184!
test02CreateCartForInvalidCredentials

	|server resp client respText |
	
	server _ TusLibrosRestInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self invalidPassword ).
	respText _ resp content.
	
	client close.
	server destroy.
	self assert: '1|',TusLibrosRestInterface invalidUserOrPasswordErrorDescription = respText.
	! !

!classRenamed: #TusLibrosServerTest as: #TusLibrosRestInterfaceTest stamp: 'AF 11/19/2021 11:47:43'!
Smalltalk renameClassNamed: #TusLibrosServerTest as: #TusLibrosRestInterfaceTest!

!testRun: #TusLibrosRestInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 11:47:55'!
PASSED!

!testRun: #TusLibrosRestInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 11:47:55'!
PASSED!
!TusLibrosRestInterface class methodsFor: 'as yet unclassified' stamp: 'AF 11/19/2021 11:52:17' prior: 50972597!
listeningOn: aPortNumber communicateWith: aSystemFacade 

	^self basicNew initializeWith: aPortNumber.! !
!TusLibrosRestInterface class methodsFor: 'as yet unclassified' stamp: 'AF 11/19/2021 11:52:26'!
listeningOn: aPortNumber  

	^self basicNew initializeWith: aPortNumber.! !

!methodRemoval: TusLibrosRestInterface class #listeningOn:communicateWith: stamp: 'AF 11/19/2021 11:52:26'!
listeningOn: aPortNumber communicateWith: aSystemFacade 

	^self basicNew initializeWith: aPortNumber.!
!TusLibrosRestInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 11:55:22' prior: 50973921!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := TusLibrosSystemFacade
		authenticatingWith: self validUsersAndPasswords
		acceptingItemsOf: Dictionary new
		registeringOn: self createSalesBook
		debitingThrought: self merchantProcessor
		measuringTimeWith: Clock new.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: '1|',(TusLibrosRestInterface invalidUserOrPasswordErrorDescription)] 
				ifFalse: [request send500Response: anError messageText	].
		]
	].
	
	webServer startListener.
! !
!TusLibrosRestInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 11:55:30'!
initializeWith: aPortNumber     
	
	port := aPortNumber.
	systemFacade := TusLibrosSystemFacade
		authenticatingWith: self validUsersAndPasswords
		acceptingItemsOf: Dictionary new
		registeringOn: self createSalesBook
		debitingThrought: self merchantProcessor
		measuringTimeWith: Clock new.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: '1|',(TusLibrosRestInterface invalidUserOrPasswordErrorDescription)] 
				ifFalse: [request send500Response: anError messageText	].
		]
	].
	
	webServer startListener.
! !

!methodRemoval: TusLibrosRestInterface #initializeWith:and: stamp: 'AF 11/19/2021 11:55:30'!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := TusLibrosSystemFacade
		authenticatingWith: self validUsersAndPasswords
		acceptingItemsOf: Dictionary new
		registeringOn: self createSalesBook
		debitingThrought: self merchantProcessor
		measuringTimeWith: Clock new.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: '1|',(TusLibrosRestInterface invalidUserOrPasswordErrorDescription)] 
				ifFalse: [request send500Response: anError messageText	].
		]
	].
	
	webServer startListener.
!
!TusLibrosRestInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 11:56:41' prior: 50974051!
initializeWith: aPortNumber     
	
	port := aPortNumber.
	systemFacade := TusLibrosSystemFacade
		authenticatingWith: self validUsersAndPasswords
		acceptingItemsOf: Dictionary new
		registeringOn: OrderedCollection  new
		debitingThrought: self merchantProcessor
		measuringTimeWith: Clock new.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: '1|',(TusLibrosRestInterface invalidUserOrPasswordErrorDescription)] 
				ifFalse: [request send500Response: anError messageText	].
		]
	].
	
	webServer startListener.
! !
!TusLibrosRestInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 12:00:34' prior: 50974119!
initializeWith: aPortNumber     
	
	port := aPortNumber.
	"systemFacade := aSystemFacade."
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: '1|',(TusLibrosRestInterface invalidUserOrPasswordErrorDescription)] 
				ifFalse: [request send500Response: anError messageText	].
		]
	].
	
	webServer startListener.
! !
!TusLibrosRestInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 12:01:17'!
initializeWith: aPortNumber and: aSystemFacade      
	
	port := aPortNumber.
	"systemFacade := aSystemFacade."
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: '1|',(TusLibrosRestInterface invalidUserOrPasswordErrorDescription)] 
				ifFalse: [request send500Response: anError messageText	].
		]
	].
	
	webServer startListener.
! !
!TusLibrosRestInterface class methodsFor: 'as yet unclassified' stamp: 'AF 11/19/2021 12:01:17' prior: 50974004!
listeningOn: aPortNumber  

	^self basicNew initializeWith: aPortNumber and: systemFacade.! !

!methodRemoval: TusLibrosRestInterface #initializeWith: stamp: 'AF 11/19/2021 12:01:17'!
initializeWith: aPortNumber     
	
	port := aPortNumber.
	"systemFacade := aSystemFacade."
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: '1|',(TusLibrosRestInterface invalidUserOrPasswordErrorDescription)] 
				ifFalse: [request send500Response: anError messageText	].
		]
	].
	
	webServer startListener.
!
!TusLibrosRestInterface class methodsFor: 'as yet unclassified' stamp: 'AF 11/19/2021 12:02:18'!
listeningOn: aPortNumber with: aSystemFacade   

	^self basicNew initializeWith: aPortNumber and: systemFacade.! !

!methodRemoval: TusLibrosRestInterface class #listeningOn: stamp: 'AF 11/19/2021 12:02:18'!
listeningOn: aPortNumber  

	^self basicNew initializeWith: aPortNumber and: systemFacade.!
!TusLibrosRestInterface class methodsFor: 'as yet unclassified' stamp: 'AF 11/19/2021 12:02:26' prior: 50974242!
listeningOn: aPortNumber with: aSystemFacade   

	^self basicNew initializeWith: aPortNumber and: aSystemFacade.! !
!TusLibrosRestInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 12:02:54' prior: 50974180!
initializeWith: aPortNumber and: aSystemFacade      
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: '1|',(TusLibrosRestInterface invalidUserOrPasswordErrorDescription)] 
				ifFalse: [request send500Response: anError messageText	].
		]
	].
	
	webServer startListener.
! !
!TusLibrosRestInterfaceTest methodsFor: 'setup' stamp: 'AF 11/19/2021 12:11:03' prior: 50973155 overrides: 16927572!
setUp
	
	testObjectsFactory := StoreTestObjectsFactory new.
	clock := Clock now: testObjectsFactory today.
	systemFacade := TusLibrosSystemFacade
		authenticatingWith: self validUsersAndPasswords
		acceptingItemsOf: testObjectsFactory defaultCatalog
		registeringOn: self createSalesBook
		debitingThrought: self merchantProcessor
		measuringTimeWith: clock
! !
!TusLibrosRestInterface class methodsFor: 'as yet unclassified' stamp: 'AF 11/19/2021 12:11:59'!
listeningOn: aPortNumber communicateWith: aSystemFacade   

	^self basicNew initializeWith: aPortNumber and: aSystemFacade.! !

!methodRemoval: TusLibrosRestInterface class #listeningOn:with: stamp: 'AF 11/19/2021 12:11:59'!
listeningOn: aPortNumber with: aSystemFacade   

	^self basicNew initializeWith: aPortNumber and: aSystemFacade.!
!TusLibrosRestInterfaceTest methodsFor: 'setup' stamp: 'AF 11/19/2021 12:12:17' prior: 50974291 overrides: 16927572!
setUp
	
	testObjectsFactory := StoreTestObjectsFactory new.
	clock := ManualClock now: testObjectsFactory today.
	systemFacade := TusLibrosSystemFacade
		authenticatingWith: self validUsersAndPasswords
		acceptingItemsOf: testObjectsFactory defaultCatalog
		registeringOn: self createSalesBook
		debitingThrought: self merchantProcessor
		measuringTimeWith: clock
! !

!testRun: #TusLibrosRestInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 12:12:18'!
PASSED!

!testRun: #TusLibrosRestInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 12:12:18'!
PASSED!
!TusLibrosRestInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 12:14:28'!
test02

	|server resp client respText |
	
	server _ TusLibrosRestInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	respText _ resp content.
	
	client close.
	server destroy.
	self assert: '0|2' equals: respText.
	! !
!TusLibrosRestInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 12:15:47'!
test03

	|server resp client respText |
	
	server _ TusLibrosRestInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	respText _ resp content.
	
	client close.
	server destroy.
	self assert: '0|2' equals: respText.
	! !

!methodRemoval: TusLibrosRestInterfaceTest #test02 stamp: 'AF 11/19/2021 12:15:47'!
test02

	|server resp client respText |
	
	server _ TusLibrosRestInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	respText _ resp content.
	
	client close.
	server destroy.
	self assert: '0|2' equals: respText.
	!

!testRun: #TusLibrosRestInterfaceTest #test03 stamp: 'AF 11/19/2021 12:16:18'!
PASSED!

!testRun: #TusLibrosRestInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 12:16:18'!
PASSED!

!testRun: #TusLibrosRestInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 12:16:18'!
PASSED!

!testRun: #TusLibrosRestInterfaceTest #test03 stamp: 'AF 11/19/2021 12:16:18'!
PASSED!
!TusLibrosRestInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 12:18:52' prior: 50974361!
test03

	|server resp client respText |
	
	server _ TusLibrosRestInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword.
	
	client close.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	respText _ resp content.
	
	
	
	server destroy.
	self assert: '0|2' equals: respText.
	! !

!testRun: #TusLibrosRestInterfaceTest #test03 stamp: 'AF 11/19/2021 12:18:56'!
PASSED!

!testRun: #TusLibrosRestInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 12:18:56'!
PASSED!

!testRun: #TusLibrosRestInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 12:18:56'!
PASSED!

!testRun: #TusLibrosRestInterfaceTest #test03 stamp: 'AF 11/19/2021 12:18:56'!
PASSED!
!TusLibrosRestInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 12:22:25' prior: 50974411!
test03

	|server resp client respText |
	
	server _ TusLibrosRestInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	respText _ resp content.
	
	client close.
	
	server destroy.
	self assert: '0|2' equals: respText.
	! !
!TusLibrosRestInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 12:26:23' prior: 50974444!
test03

	|server resp client respText |
	
	server _ TusLibrosRestInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword.
	
	resp _ client httpGet: 'http://localhost:8080/addToCart?cartId=',1,'&bookIsbn='.
	respText _ resp content.
	
	client close.
	
	server destroy.
	self assert: '0|2' equals: respText.
	! !
!TusLibrosRestInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 12:43:43' prior: 50974459!
test03

	|server resp client respText |
	
	server _ TusLibrosRestInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword.
	
	resp _ client httpGet: 'http://localhost:8080/addToCart?cartId=',1,'&bookIsbn=',testObjectsFactory itemSellByTheStore,'&bookQuantity=1' .
	respText _ resp content.
	
	client close.
	
	server destroy.
	self assert: '0|2' equals: respText.
	! !
!TusLibrosRestInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 12:44:13' prior: 50974477!
test03

	|server resp client respText |
	
	server _ TusLibrosRestInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword.
	
	resp _ client httpGet: 'http://localhost:8080/addToCart?cartId=',1,'&bookIsbn=',testObjectsFactory itemSellByTheStore,'&bookQuantity=1' .
	respText _ resp content.
	
	client close.
	
	server destroy.
	self assert: '0|OK' equals: respText.
	! !

!testRun: #TusLibrosRestInterfaceTest #test03 stamp: 'AF 11/19/2021 12:44:14'!
ERROR!
!TusLibrosRestInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 12:56:39' prior: 50974262!
initializeWith: aPortNumber and: aSystemFacade      
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId response|
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			response := (Dictionary new) add: 'status' -> 0; add: 'cartId' -> cartId; yourself.
			request send200Response: (WebUtils jsonEncode: response).
		 ] 
		on: Error 
		do: [ :anError |
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: '1|',(TusLibrosRestInterface invalidUserOrPasswordErrorDescription)] 
				ifFalse: [request send500Response: anError messageText	].
		]
	].
	
	webServer startListener.
! !
!TusLibrosRestInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 12:59:13' prior: 50974518!
initializeWith: aPortNumber and: aSystemFacade      
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId response|
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			response := (Dictionary new) add: 'status' -> 0; add: 'cartId' -> cartId; yourself.
			request send200Response: (WebUtils jsonEncode: response).
		 ] 
		on: Error 
		do: [ :anError |
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: ((Dictionary new) add: 'status' -> 1; 
														    add: 'errorDescription' -> (TusLibrosRestInterface invalidUserOrPasswordErrorDescription);
														    yourself)] 
				ifFalse: [request send500Response: anError messageText	].
		]
	].
	
	webServer startListener.
! !
!TusLibrosRestInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 13:25:23' prior: 50973949!
test01CreateCartForValidCredentials

	|server resp client respDecoded respExpected |
	
	server _ TusLibrosRestInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	respDecoded _ WebUtils jsonMapFrom: (resp content).
	
	client close.
	server destroy.
	respExpected _ (Dictionary new) add: 'status' -> 0; add: 'cartId' -> 1; yourself.
	self assert: (respExpected at: 'status') equals: (respDecoded at: 'status').
	self assert: (respExpected at: 'cartId') equals: (respDecoded at: 'cartId').! !

!testRun: #TusLibrosRestInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 13:25:37'!
ERROR!

!testRun: #TusLibrosRestInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 13:25:37'!
ERROR!
!TusLibrosRestInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 13:31:36' prior: 50974584!
test01CreateCartForValidCredentials

	|server resp client respDecoded respExpected |
	
	server _ TusLibrosRestInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	respDecoded _ WebUtils jsonMapFrom: (resp contentStream).
	
	client close.
	server destroy.
	respExpected _ (Dictionary new) add: 'status' -> 0; add: 'cartId' -> 1; yourself.
	self assert: (respExpected at: 'status') equals: (respDecoded at: 'status').
	self assert: (respExpected at: 'cartId') equals: (respDecoded at: 'cartId').! !

!testRun: #TusLibrosRestInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 13:31:39'!
ERROR!

!testRun: #TusLibrosRestInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 13:31:39'!
ERROR!
!TusLibrosRestInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 13:47:18' prior: 50974615!
test01CreateCartForValidCredentials

	|server resp client respDecoded respExpected |
	
	server _ TusLibrosRestInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	respDecoded _ WebUtils jsonMapFrom: (resp content) readStream.
	
	client close.
	server destroy.
	respExpected _ (Dictionary new) add: 'status' -> 0; add: 'cartId' -> 1; yourself.
	self assert: (respExpected at: 'status') equals: (respDecoded at: 'status').
	self assert: (respExpected at: 'cartId') equals: (respDecoded at: 'cartId').! !

!testRun: #TusLibrosRestInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 13:48:02'!
ERROR!

!testRun: #TusLibrosRestInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 13:48:02'!
ERROR!

WebServer allInstances !

WebServer allInstancesDo: [:i | i destroy]!


WebServer allInstancesDo: [:i | i connections]!

WebServer allInstancesDo: [:i | i connections] !

WebServer allInstancesDo: [:i | i connections]!

WebServer allInstancesDo: [:i | i connections]!

WebServer allInstancesDo: [:i | i connections]!

----STARTUP---- (19 November 2021 13:52:32) as C:\Users\ferra\Desktop\windows64\windows64\CuisUniversity-4972.image!


!classDefinition: #Cart category: 'TusLibros-Model' stamp: 'AF 11/19/2021 13:52:34'!
Object subclass: #Cart
	instanceVariableNames: 'catalog items'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!

!classDefinition: #Cart category: 'TusLibros-Model' stamp: 'AF 11/19/2021 13:52:34'!
Object subclass: #Cart
	instanceVariableNames: 'catalog items'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!
!Cart methodsFor: 'error messages' stamp: 'HernanWilkinson 6/21/2013 23:59'!
invalidItemErrorMessage

	^self class invalidItemErrorMessage ! !
!Cart methodsFor: 'error messages' stamp: 'HernanWilkinson 6/22/2013 00:00'!
invalidQuantityErrorMessage

	^self class invalidQuantityErrorMessage ! !
!Cart methodsFor: 'assertions' stamp: 'HernanWilkinson 6/22/2013 14:17'!
assertIsValidItem: anItem

	(catalog includesKey: anItem) ifFalse: [ self signalInvalidItem ]! !
!Cart methodsFor: 'assertions' stamp: 'HernanWilkinson 6/22/2013 14:18'!
assertIsValidQuantity: aQuantity

	aQuantity strictlyPositive ifFalse: [self signalInvalidQuantity ]! !
!Cart methodsFor: 'content' stamp: 'HernanWilkinson 6/22/2013 12:17'!
catalog

	^ catalog! !
!Cart methodsFor: 'content' stamp: 'HernanWilkinson 6/22/2013 12:30'!
content

	^items copy! !
!Cart methodsFor: 'content' stamp: 'HernanWilkinson 6/23/2013 12:10'!
itemsAndQuantitiesDo: aBlock

	^ items contents keysAndValuesDo: [ :anItem :aQuantity | aBlock value: anItem value: aQuantity ]! !
!Cart methodsFor: 'content' stamp: 'HernanWilkinson 6/17/2013 17:45'!
occurrencesOf: anItem

	^items occurrencesOf: anItem  ! !
!Cart methodsFor: 'initialization' stamp: 'HernanWilkinson 6/22/2013 12:29'!
initializeAcceptingItemsOf: aCatalog

	catalog := aCatalog.
	items := Bag new.! !
!Cart methodsFor: 'error signal' stamp: 'HernanWilkinson 6/22/2013 14:18'!
signalInvalidItem

	self error: self invalidItemErrorMessage! !
!Cart methodsFor: 'error signal' stamp: 'HernanWilkinson 6/22/2013 14:19'!
signalInvalidQuantity

	self error: self invalidQuantityErrorMessage ! !
!Cart methodsFor: 'testing' stamp: 'HernanWilkinson 6/17/2013 17:44'!
includes: anItem

	^items includes: anItem ! !
!Cart methodsFor: 'testing' stamp: 'HernanWilkinson 6/17/2013 17:44'!
isEmpty

	^items isEmpty ! !
!Cart methodsFor: 'adding' stamp: 'HernanWilkinson 6/17/2013 17:44'!
add: anItem

	^ self add: 1 of: anItem ! !
!Cart methodsFor: 'adding' stamp: 'HernanWilkinson 6/22/2013 12:31'!
add: aQuantity of: anItem

	self assertIsValidQuantity: aQuantity.
	self assertIsValidItem: anItem.

	items add: anItem withOccurrences: aQuantity ! !

!classDefinition: 'Cart class' category: 'TusLibros-Model' stamp: 'AF 11/19/2021 13:52:34'!
Cart class
	instanceVariableNames: ''!

!classDefinition: 'Cart class' category: 'TusLibros-Model' stamp: 'AF 11/19/2021 13:52:34'!
Cart class
	instanceVariableNames: ''!
!Cart class methodsFor: 'error messages' stamp: 'HernanWilkinson 6/21/2013 23:59'!
invalidItemErrorMessage

	^'Item is not in catalog'! !
!Cart class methodsFor: 'error messages' stamp: 'HernanWilkinson 6/22/2013 00:00'!
invalidQuantityErrorMessage

	^'Invalid number of items'! !
!Cart class methodsFor: 'instance creation' stamp: 'HernanWilkinson 6/17/2013 17:48'!
acceptingItemsOf: aCatalog

	^self new initializeAcceptingItemsOf: aCatalog ! !

!classDefinition: #CartSession category: 'TusLibros-Model' stamp: 'AF 11/19/2021 13:52:35'!
Object subclass: #CartSession
	instanceVariableNames: 'owner cart lastUsedTime systemFacade'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!

!classDefinition: #CartSession category: 'TusLibros-Model' stamp: 'AF 11/19/2021 13:52:35'!
Object subclass: #CartSession
	instanceVariableNames: 'owner cart lastUsedTime systemFacade'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!
!CartSession methodsFor: 'time/expiration' stamp: 'HernanWilkinson 6/17/2015 20:34'!
assertIsNotExpirtedAt: aTime

	(self isExpiredAt: aTime) ifTrue: [ self signalCartSessionExpired ]! !
!CartSession methodsFor: 'time/expiration' stamp: 'HernanWilkinson 6/17/2015 20:36'!
isExpiredAt: aTime

	^ (lastUsedTime + systemFacade sessionDuration) < aTime! !
!CartSession methodsFor: 'time/expiration' stamp: 'HernanWilkinson 6/17/2015 20:36'!
now

	^systemFacade now! !
!CartSession methodsFor: 'time/expiration' stamp: 'HernanWilkinson 6/17/2015 20:37'!
today

	^systemFacade today! !
!CartSession methodsFor: 'session management' stamp: 'HernanWilkinson 6/17/2015 20:35'!
do: aBlock

	| now |

	now := self now.
	self assertIsNotExpirtedAt: now.

	^ [ aBlock value: self ] ensure: [ lastUsedTime := now  ]! !
!CartSession methodsFor: 'initialization' stamp: 'HernanWilkinson 6/17/2015 20:36'!
initializeOwnedBy: aCustomer with: aCart on: aSystemFacade

	owner := aCustomer.
	cart := aCart.
	systemFacade := aSystemFacade.
	lastUsedTime := self now.! !
!CartSession methodsFor: 'error signal' stamp: 'HernanWilkinson 6/17/2015 20:37'!
signalCartSessionExpired

	self error: systemFacade sessionHasExpiredErrorDescription ! !
!CartSession methodsFor: 'cart' stamp: 'HernanWilkinson 6/17/2015 20:34'!
addToCart: anAmount of: aBook

	^cart add: anAmount of: aBook! !
!CartSession methodsFor: 'cart' stamp: 'HernanWilkinson 6/17/2015 20:35'!
cartContent

	^cart content! !
!CartSession methodsFor: 'cart' stamp: 'HernanWilkinson 6/17/2015 20:35'!
checkOutCartWithCreditCardNumbered: aCreditCartNumber ownedBy: anOwner expiringOn: anExpirationMonthOfYear

	^(Cashier
		toCheckout: cart
		ownedBy: owner
		charging: (CreditCard expiringOn: anExpirationMonthOfYear)
		throught: systemFacade merchantProcessor
		on: self today
		registeringOn: systemFacade salesBook) checkOut ! !

!classDefinition: 'CartSession class' category: 'TusLibros-Model' stamp: 'AF 11/19/2021 13:52:35'!
CartSession class
	instanceVariableNames: ''!

!classDefinition: 'CartSession class' category: 'TusLibros-Model' stamp: 'AF 11/19/2021 13:52:35'!
CartSession class
	instanceVariableNames: ''!
!CartSession class methodsFor: 'instance creation' stamp: 'HernanWilkinson 6/17/2015 20:37'!
ownedBy: aCustomer with: aCart on: aSystemFacade

	^self new initializeOwnedBy: aCustomer with: aCart on: aSystemFacade! !

!classDefinition: #Cashier category: 'TusLibros-Model' stamp: 'AF 11/19/2021 13:52:35'!
Object subclass: #Cashier
	instanceVariableNames: 'cart salesBook merchantProcessor creditCard owner ticket'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!

!classDefinition: #Cashier category: 'TusLibros-Model' stamp: 'AF 11/19/2021 13:52:35'!
Object subclass: #Cashier
	instanceVariableNames: 'cart salesBook merchantProcessor creditCard owner ticket'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!
!Cashier methodsFor: 'checkout - private' stamp: 'HernanWilkinson 6/22/2013 12:17'!
createLineItemOf: anItem quantity: aQuantity

	^LineItem of: anItem quantity: aQuantity total: (self totalOf: anItem quantity: aQuantity) ! !
!Cashier methodsFor: 'checkout - private' stamp: 'HernanWilkinson 6/22/2013 12:25'!
createSale

	^ Sale doneBy: owner certifiedWith: ticket
! !
!Cashier methodsFor: 'checkout - private' stamp: 'HernanWilkinson 6/22/2013 12:28'!
createTicket

	| lineItems |

	lineItems := OrderedCollection new.
	cart itemsAndQuantitiesDo: [ :anItem :aQuantity |
		lineItems add: (self createLineItemOf: anItem quantity: aQuantity)].

	ticket := Ticket of: lineItems
	! !
!Cashier methodsFor: 'checkout - private' stamp: 'HernanWilkinson 6/22/2013 12:20'!
debitTotal

	merchantProcessor debit: ticket total from: creditCard.
	! !
!Cashier methodsFor: 'checkout - private' stamp: 'HernanWilkinson 6/17/2013 19:06'!
registerSale

	salesBook add: self createSale! !
!Cashier methodsFor: 'checkout - private' stamp: 'HernanWilkinson 6/22/2013 12:17'!
totalOf: anItem quantity: aQuantity

	^(cart catalog at: anItem) * aQuantity  ! !
!Cashier methodsFor: 'checkout' stamp: 'HernanWilkinson 6/22/2013 12:28'!
checkOut

	self createTicket.
	self debitTotal.
	self registerSale.

	^ ticket ! !
!Cashier methodsFor: 'initialization' stamp: 'HernanWilkinson 6/22/2013 12:02'!
initializeToCheckout: aCart ownedBy: anOwner charging: aCreditCard throught: aMerchantProcessor registeringOn: aSalesBook

	cart := aCart.
	owner := anOwner.
	creditCard := aCreditCard.
	merchantProcessor := aMerchantProcessor.
	salesBook := aSalesBook! !

!classDefinition: 'Cashier class' category: 'TusLibros-Model' stamp: 'AF 11/19/2021 13:52:35'!
Cashier class
	instanceVariableNames: ''!

!classDefinition: 'Cashier class' category: 'TusLibros-Model' stamp: 'AF 11/19/2021 13:52:35'!
Cashier class
	instanceVariableNames: ''!
!Cashier class methodsFor: 'assertions' stamp: 'HernanWilkinson 6/22/2013 14:22'!
assertIsNotEmpty: aCart

	aCart isEmpty ifTrue: [self signalCartCanNotBeEmpty ]! !
!Cashier class methodsFor: 'assertions' stamp: 'HernanWilkinson 6/22/2013 14:22'!
assertIsNotExpired: aCreditCard on: aDate

	(aCreditCard isExpiredOn: aDate) ifTrue: [self signalCanNotChargeAnExpiredCreditCard]! !
!Cashier class methodsFor: 'instance creation' stamp: 'HernanWilkinson 6/22/2013 12:00'!
toCheckout: aCart ownedBy: anOwner charging: aCreditCard throught: aMerchantProcessor on: aDate registeringOn: aSalesBook

	self assertIsNotEmpty: aCart.
	self assertIsNotExpired: aCreditCard on: aDate.

	^self new initializeToCheckout: aCart ownedBy: anOwner charging: aCreditCard throught: aMerchantProcessor registeringOn: aSalesBook! !
!Cashier class methodsFor: 'error messages' stamp: 'HernanWilkinson 6/17/2013 18:21'!
canNotChargeAnExpiredCreditCardErrorMessage

	^'Can not charge an expired credit card'! !
!Cashier class methodsFor: 'error messages' stamp: 'HernanWilkinson 6/17/2013 17:56'!
cartCanNotBeEmptyErrorMessage

	^'Can not check out an empty cart'! !
!Cashier class methodsFor: 'error messages' stamp: 'HernanWilkinson 6/17/2013 19:02'!
creditCardHasNoCreditErrorMessage

	^'Credit card has no credit'! !
!Cashier class methodsFor: 'error signal' stamp: 'HernanWilkinson 6/22/2013 14:22'!
signalCanNotChargeAnExpiredCreditCard

	 self error: self canNotChargeAnExpiredCreditCardErrorMessage ! !
!Cashier class methodsFor: 'error signal' stamp: 'HernanWilkinson 6/22/2013 14:22'!
signalCartCanNotBeEmpty

	self error: self cartCanNotBeEmptyErrorMessage! !

!classDefinition: #Clock category: 'TusLibros-Model' stamp: 'AF 11/19/2021 13:52:35'!
Object subclass: #Clock
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!

!classDefinition: #Clock category: 'TusLibros-Model' stamp: 'AF 11/19/2021 13:52:35'!
Object subclass: #Clock
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!
!Clock methodsFor: 'time' stamp: 'HernanWilkinson 6/22/2013 14:23'!
now

	self subclassResponsibility ! !
!Clock methodsFor: 'time' stamp: 'HernanWilkinson 6/22/2013 14:23'!
today

	self subclassResponsibility ! !

!classDefinition: #CreditCard category: 'TusLibros-Model' stamp: 'AF 11/19/2021 13:52:35'!
Object subclass: #CreditCard
	instanceVariableNames: 'expiration'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!

!classDefinition: #CreditCard category: 'TusLibros-Model' stamp: 'AF 11/19/2021 13:52:35'!
Object subclass: #CreditCard
	instanceVariableNames: 'expiration'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!
!CreditCard methodsFor: 'testing' stamp: 'HernanWilkinson 6/17/2013 18:39'!
isExpiredOn: aDate

	^expiration start < (Month month: aDate monthIndex year: aDate yearNumber) start ! !
!CreditCard methodsFor: 'initialization' stamp: 'HernanWilkinson 6/17/2013 18:38'!
initializeExpiringOn: aMonth

	expiration := aMonth ! !

!classDefinition: 'CreditCard class' category: 'TusLibros-Model' stamp: 'AF 11/19/2021 13:52:35'!
CreditCard class
	instanceVariableNames: ''!

!classDefinition: 'CreditCard class' category: 'TusLibros-Model' stamp: 'AF 11/19/2021 13:52:35'!
CreditCard class
	instanceVariableNames: ''!
!CreditCard class methodsFor: 'instance creation' stamp: 'HernanWilkinson 6/17/2013 18:38'!
expiringOn: aMonth

	^self new initializeExpiringOn: aMonth! !

!classDefinition: #LineItem category: 'TusLibros-Model' stamp: 'AF 11/19/2021 13:52:35'!
Object subclass: #LineItem
	instanceVariableNames: 'item quantity total'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!

!classDefinition: #LineItem category: 'TusLibros-Model' stamp: 'AF 11/19/2021 13:52:35'!
Object subclass: #LineItem
	instanceVariableNames: 'item quantity total'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!
!LineItem methodsFor: 'accessing' stamp: 'HernanWilkinson 6/22/2013 12:33'!
item

	^ item! !
!LineItem methodsFor: 'accessing' stamp: 'HernanWilkinson 6/22/2013 12:21'!
total

	^ total! !
!LineItem methodsFor: 'initialization' stamp: 'HernanWilkinson 6/22/2013 12:18'!
initializeOf: anItem quantity: aQuantity total: aTotal

	item := anItem.
	quantity := aQuantity.
	total := aTotal

! !

!classDefinition: 'LineItem class' category: 'TusLibros-Model' stamp: 'AF 11/19/2021 13:52:35'!
LineItem class
	instanceVariableNames: ''!

!classDefinition: 'LineItem class' category: 'TusLibros-Model' stamp: 'AF 11/19/2021 13:52:35'!
LineItem class
	instanceVariableNames: ''!
!LineItem class methodsFor: 'instance creation' stamp: 'HernanWilkinson 6/22/2013 12:18'!
of: anItem quantity: aQuantity total: aTotal

	^self new initializeOf: anItem quantity: aQuantity total: aTotal

! !

!classDefinition: #MerchantProcessor category: 'TusLibros-Model' stamp: 'AF 11/19/2021 13:52:35'!
Object subclass: #MerchantProcessor
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!

!classDefinition: #MerchantProcessor category: 'TusLibros-Model' stamp: 'AF 11/19/2021 13:52:35'!
Object subclass: #MerchantProcessor
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!
!MerchantProcessor methodsFor: 'debit' stamp: 'HernanWilkinson 6/22/2013 14:31'!
README

	"Aunque nadie subclasifica esta clase, esta para definir el protocolo que se espera que todo MerchantProcessor sepa responder - Hernan"! !
!MerchantProcessor methodsFor: 'debit' stamp: 'HernanWilkinson 6/22/2013 14:30'!
debit: anAmount from: aCreditCard

	self subclassResponsibility ! !

!classDefinition: #Sale category: 'TusLibros-Model' stamp: 'AF 11/19/2021 13:52:35'!
Object subclass: #Sale
	instanceVariableNames: 'customer ticket'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!

!classDefinition: #Sale category: 'TusLibros-Model' stamp: 'AF 11/19/2021 13:52:35'!
Object subclass: #Sale
	instanceVariableNames: 'customer ticket'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!
!Sale methodsFor: 'testing' stamp: 'HernanWilkinson 6/22/2013 12:06'!
wasDoneBy: aCustomer

	^customer = aCustomer ! !
!Sale methodsFor: 'initialization' stamp: 'HernanWilkinson 6/22/2013 12:26'!
initializeDoneBy: aCustomer certifiedWith: aTicket

	customer := aCustomer.
	ticket := aTicket ! !
!Sale methodsFor: 'total' stamp: 'HernanWilkinson 6/22/2013 12:26'!
total

	^ ticket total! !
!Sale methodsFor: 'line items' stamp: 'HernanWilkinson 6/22/2013 12:33'!
lineItemsDo: aBlock

	^ticket lineItemsDo: aBlock ! !

!classDefinition: 'Sale class' category: 'TusLibros-Model' stamp: 'AF 11/19/2021 13:52:35'!
Sale class
	instanceVariableNames: ''!

!classDefinition: 'Sale class' category: 'TusLibros-Model' stamp: 'AF 11/19/2021 13:52:35'!
Sale class
	instanceVariableNames: ''!
!Sale class methodsFor: 'instance creation' stamp: 'HernanWilkinson 6/22/2013 12:25'!
doneBy: aCustomer certifiedWith: aTicket

	^self new initializeDoneBy: aCustomer certifiedWith: aTicket ! !

!classDefinition: #Ticket category: 'TusLibros-Model' stamp: 'AF 11/19/2021 13:52:36'!
Object subclass: #Ticket
	instanceVariableNames: 'lineItems'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!

!classDefinition: #Ticket category: 'TusLibros-Model' stamp: 'AF 11/19/2021 13:52:36'!
Object subclass: #Ticket
	instanceVariableNames: 'lineItems'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!
!Ticket methodsFor: 'total' stamp: 'HernanWilkinson 6/17/2015 20:39'!
total

	^lineItems sum: [ :aLineItem | aLineItem total]! !
!Ticket methodsFor: 'initialization' stamp: 'HernanWilkinson 6/22/2013 12:20'!
initializeOf: aCollectionOfLineItems

	lineItems := aCollectionOfLineItems ! !
!Ticket methodsFor: 'line items' stamp: 'HernanWilkinson 6/22/2013 12:33'!
lineItemsDo: aBlock

	^lineItems do: aBlock ! !

!classDefinition: 'Ticket class' category: 'TusLibros-Model' stamp: 'AF 11/19/2021 13:52:36'!
Ticket class
	instanceVariableNames: ''!

!classDefinition: 'Ticket class' category: 'TusLibros-Model' stamp: 'AF 11/19/2021 13:52:36'!
Ticket class
	instanceVariableNames: ''!
!Ticket class methodsFor: 'instance creation' stamp: 'HernanWilkinson 6/22/2013 12:20'!
of: aCollectionOfLineItems

	^self new initializeOf: aCollectionOfLineItems ! !

!classDefinition: #TusLibrosServer category: 'TusLibros-Model' stamp: 'AF 11/19/2021 13:52:36'!
Object subclass: #TusLibrosServer
	instanceVariableNames: 'port webServer systemFacade'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!

!classDefinition: #TusLibrosServer category: 'TusLibros-Model' stamp: 'AF 11/19/2021 13:52:36'!
Object subclass: #TusLibrosServer
	instanceVariableNames: 'port webServer systemFacade'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/15/2021 21:25:34'!
destroy
	
	webServer ifNotNil:[webServer destroy].! !
!TusLibrosServer methodsFor: 'initialization' stamp: 'MP 11/18/2021 18:29:30'!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: '1|',(TusLibrosServer invalidUserOrPasswordErrorDescription)] 
				ifFalse: [request send500Response: anError messageText	].
		]
	].
	
	webServer startListener.
! !

!classDefinition: 'TusLibrosServer class' category: 'TusLibros-Model' stamp: 'AF 11/19/2021 13:52:36'!
TusLibrosServer class
	instanceVariableNames: ''!

!classDefinition: 'TusLibrosServer class' category: 'TusLibros-Model' stamp: 'AF 11/19/2021 13:52:36'!
TusLibrosServer class
	instanceVariableNames: ''!
!TusLibrosServer class methodsFor: 'as yet unclassified' stamp: 'MP 11/17/2021 15:53:46'!
listeningOn: aPortNumber communicateWith: aSystemFacade 

	^self basicNew initializeWith: aPortNumber and: aSystemFacade .! !
!TusLibrosServer class methodsFor: 'error handling' stamp: 'MP 11/17/2021 15:58:49'!
invalidUserOrPasswordErrorDescription
	^ 'INVALID_USERNAME_OR_PASSWORD'! !

!classDefinition: #TusLibrosSystemFacade category: 'TusLibros-Model' stamp: 'AF 11/19/2021 13:52:36'!
Object subclass: #TusLibrosSystemFacade
	instanceVariableNames: 'validUsersAndPasswords catalog lastId merchantProcessor salesBook clock cartSessions'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!

!classDefinition: #TusLibrosSystemFacade category: 'TusLibros-Model' stamp: 'AF 11/19/2021 13:52:36'!
Object subclass: #TusLibrosSystemFacade
	instanceVariableNames: 'validUsersAndPasswords catalog lastId merchantProcessor salesBook clock cartSessions'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!
!TusLibrosSystemFacade methodsFor: 'error messages' stamp: 'HernanWilkinson 6/22/2013 11:24'!
canNotChargeAnExpiredCreditCardErrorMessage

	^Cashier canNotChargeAnExpiredCreditCardErrorMessage ! !
!TusLibrosSystemFacade methodsFor: 'error messages' stamp: 'HernanWilkinson 6/22/2013 11:17'!
cartCanNotBeEmptyErrorMessage

	^Cashier cartCanNotBeEmptyErrorMessage ! !
!TusLibrosSystemFacade methodsFor: 'error messages' stamp: 'HernanWilkinson 6/21/2013 23:27'!
invalidCartIdErrorDescription

	^'Invalid cart id'! !
!TusLibrosSystemFacade methodsFor: 'error messages' stamp: 'HernanWilkinson 6/21/2013 23:59'!
invalidItemErrorMessage

	^Cart invalidItemErrorMessage ! !
!TusLibrosSystemFacade methodsFor: 'error messages' stamp: 'HernanWilkinson 6/21/2013 23:03'!
invalidUserAndOrPasswordErrorDescription

	^'Invalid user and/or password'! !
!TusLibrosSystemFacade methodsFor: 'error messages' stamp: 'HernanWilkinson 6/22/2013 13:07'!
sessionHasExpiredErrorDescription

	^'Can not use the cart after ', self sessionDuration minutes printString , ' minutes of inactivity'! !
!TusLibrosSystemFacade methodsFor: 'time' stamp: 'HernanWilkinson 6/22/2013 13:02'!
now

	^clock now! !
!TusLibrosSystemFacade methodsFor: 'time' stamp: 'HernanWilkinson 6/22/2013 12:49'!
today

	^clock today! !
!TusLibrosSystemFacade methodsFor: 'authentication' stamp: 'HernanWilkinson 6/23/2013 12:18'!
does: aUser authenticatesWith: aPassword

	"Recordar que esto es solo un ejemplo. No se deben guardar passwords en un sistema de verdad sino un
	hash o similar - Hernan"

	| storedPassword |

	storedPassword := validUsersAndPasswords at: aUser ifAbsent: [ ^false ].
	^aPassword = storedPassword ! !
!TusLibrosSystemFacade methodsFor: 'authentication' stamp: 'HernanWilkinson 6/23/2013 12:18'!
if: aUser authenticatesWith: aPassword do: aBlock

	^ (self does: aUser authenticatesWith: aPassword)
		ifTrue: aBlock
		ifFalse: [ self signalInvalidUserAndOrPassword ].
	! !
!TusLibrosSystemFacade methodsFor: 'error signal' stamp: 'HernanWilkinson 6/21/2013 23:27'!
signalInvalidCartId

	self error: self invalidCartIdErrorDescription ! !
!TusLibrosSystemFacade methodsFor: 'error signal' stamp: 'HernanWilkinson 6/21/2013 23:02'!
signalInvalidUserAndOrPassword

	self error: self invalidUserAndOrPasswordErrorDescription! !
!TusLibrosSystemFacade methodsFor: 'cart session management' stamp: 'HernanWilkinson 6/21/2013 23:32'!
generateCartId

	"Recuerden que esto es un ejemplo, por lo que voy a generar ids numericos consecutivos, pero en una
	implementacion real no deberian se numeros consecutivos ni nada que genere problemas de seguridad - Hernan"

	lastId := lastId + 1.
	^lastId! !
!TusLibrosSystemFacade methodsFor: 'cart session management' stamp: 'HernanWilkinson 6/22/2013 13:02'!
sessionDuration

	^30 minutes! !
!TusLibrosSystemFacade methodsFor: 'cart session management' stamp: 'HernanWilkinson 6/17/2015 20:50'!
withCartSessionIdentifiedAs: aCartId do: aBlock

	| cartSession |

	cartSession := cartSessions at: aCartId ifAbsent: [self signalInvalidCartId ].
	^cartSession do: aBlock
! !
!TusLibrosSystemFacade methodsFor: 'facade protocol' stamp: 'HAW 11/26/2018 20:18:41'!
add: anAmount of: aBook toCartIdentifiedAs: aCartId

	self withCartSessionIdentifiedAs: aCartId do: [ :cartSession | cartSession addToCart: anAmount of: aBook ]! !
!TusLibrosSystemFacade methodsFor: 'facade protocol' stamp: 'HernanWilkinson 6/17/2015 20:47'!
checkOutCartIdentifiedAs: aCartId withCreditCardNumbered: aCreditCartNumber ownedBy: anOwner expiringOn: anExpirationMonthOfYear

	self
		withCartSessionIdentifiedAs: aCartId
		do: [ :cartSession | cartSession
			checkOutCartWithCreditCardNumbered: aCreditCartNumber
			ownedBy: anOwner
			expiringOn: anExpirationMonthOfYear ]
! !
!TusLibrosSystemFacade methodsFor: 'facade protocol' stamp: 'HernanWilkinson 6/17/2015 20:52'!
createCartFor: aUser authenticatedWith: aPassword

	^ self if: aUser authenticatesWith: aPassword do: [ | cartId cartSession |

		cartId := self generateCartId.
		cartSession := CartSession ownedBy: aUser with: (Cart acceptingItemsOf: catalog) on: self..
		cartSessions at: cartId put: cartSession.

		cartId  ]! !
!TusLibrosSystemFacade methodsFor: 'facade protocol' stamp: 'HernanWilkinson 6/17/2015 20:48'!
listCartIdentifiedAs: aCartId

	^ self withCartSessionIdentifiedAs: aCartId do: [ :cartSession | cartSession cartContent ]! !
!TusLibrosSystemFacade methodsFor: 'facade protocol' stamp: 'HAW 11/26/2018 20:33:49'!
listPurchasesOf: aUser authenticatingWith: aPassword

	^self if: aUser authenticatesWith: aPassword do: [ | sales |
		sales := self salesDoneBy: aUser.
		sales
			inject: Dictionary new
			into: [ :salesOrderedByBook :aSale |
				self list: aSale on: salesOrderedByBook.
				salesOrderedByBook ] ]! !
!TusLibrosSystemFacade methodsFor: 'checkout support' stamp: 'HernanWilkinson 6/17/2015 20:49'!
merchantProcessor

	^ merchantProcessor! !
!TusLibrosSystemFacade methodsFor: 'checkout support' stamp: 'HernanWilkinson 6/17/2015 20:50'!
salesBook

	^ salesBook! !
!TusLibrosSystemFacade methodsFor: 'private' stamp: 'HernanWilkinson 6/17/2015 20:56'!
list: aSale on: salesOrderedByBook

	"Esto es un indicio de que por ahi conviene empezar a pensar en modelar un SaleBook - Hernan"
	aSale lineItemsDo: [ :aLineItem | | oldTotal newTotal |
		oldTotal := salesOrderedByBook at: aLineItem item ifAbsentPut: [ 0 ].
		newTotal := oldTotal + aLineItem total.
		salesOrderedByBook at: aLineItem item put: newTotal ]! !
!TusLibrosSystemFacade methodsFor: 'private' stamp: 'HernanWilkinson 6/17/2015 20:55'!
salesDoneBy: aUser

	"Esto es un indicio de que por ahi conviene empezar a pensar en modelar un SaleBook - Hernan"
	^ salesBook select: [ :aSale | aSale wasDoneBy: aUser ]! !
!TusLibrosSystemFacade methodsFor: 'initialization' stamp: 'HernanWilkinson 6/22/2013 14:17'!
initializeAuthenticatingWith: aValidUsersAndPasswords
	acceptingItemsOf: aCatalog
	registeringOn: aSalesBook
	debitingThrought: aMerchantProcessor
	measuringTimeWith: aClock

	validUsersAndPasswords := aValidUsersAndPasswords.
	catalog := aCatalog.
	salesBook := aSalesBook.
	merchantProcessor := aMerchantProcessor.
	clock := aClock.

	cartSessions := Dictionary new.
	lastId := 0.! !

!classDefinition: 'TusLibrosSystemFacade class' category: 'TusLibros-Model' stamp: 'AF 11/19/2021 13:52:36'!
TusLibrosSystemFacade class
	instanceVariableNames: ''!

!classDefinition: 'TusLibrosSystemFacade class' category: 'TusLibros-Model' stamp: 'AF 11/19/2021 13:52:36'!
TusLibrosSystemFacade class
	instanceVariableNames: ''!
!TusLibrosSystemFacade class methodsFor: 'instance creation' stamp: 'HernanWilkinson 6/22/2013 14:17'!
authenticatingWith: aValidUsersAndPasswords
	acceptingItemsOf: aCatalog
	registeringOn: aSalesBook
	debitingThrought: aMerchantProcessor
	measuringTimeWith: aClock

	^self new
		initializeAuthenticatingWith: aValidUsersAndPasswords
		acceptingItemsOf: aCatalog
		registeringOn: aSalesBook
		debitingThrought: aMerchantProcessor
		measuringTimeWith: aClock! !

!classDefinition: #CartTest category: 'TusLibros-Tests' stamp: 'AF 11/19/2021 13:52:36'!
TestCase subclass: #CartTest
	instanceVariableNames: 'testObjectsFactory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!

!classDefinition: #CartTest category: 'TusLibros-Tests' stamp: 'AF 11/19/2021 13:52:36'!
TestCase subclass: #CartTest
	instanceVariableNames: 'testObjectsFactory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!
!CartTest methodsFor: 'tests' stamp: 'HernanWilkinson 6/17/2013 18:10'!
test01NewCartsAreCreatedEmpty

	self assert: testObjectsFactory createCart isEmpty! !
!CartTest methodsFor: 'tests' stamp: 'HernanWilkinson 6/17/2013 18:10'!
test02CanNotAddItemsThatDoNotBelongToStore

	| cart |

	cart := testObjectsFactory createCart.

	self
		should: [ cart add: testObjectsFactory itemNotSellByTheStore ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidItemErrorMessage.
			self assert: cart isEmpty ]! !
!CartTest methodsFor: 'tests' stamp: 'HernanWilkinson 6/17/2013 18:10'!
test03AfterAddingAnItemTheCartIsNotEmptyAnymore

	| cart |

	cart := testObjectsFactory createCart.

	cart add: testObjectsFactory itemSellByTheStore.
	self deny: cart isEmpty ! !
!CartTest methodsFor: 'tests' stamp: 'HernanWilkinson 6/17/2013 18:10'!
test04CanNotAddNonPositiveNumberOfItems

	| cart |

	cart := testObjectsFactory createCart.

	self
		should: [cart add: 0 of: testObjectsFactory itemSellByTheStore ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidQuantityErrorMessage.
			self assert: cart isEmpty ]! !
!CartTest methodsFor: 'tests' stamp: 'HernanWilkinson 6/17/2013 18:10'!
test05CanNotAddMoreThanOneItemNotSellByTheStore

	| cart |

	cart := testObjectsFactory createCart.

	self
		should: [cart add: 2 of: testObjectsFactory itemNotSellByTheStore  ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidItemErrorMessage.
			self assert: cart isEmpty ]! !
!CartTest methodsFor: 'tests' stamp: 'HernanWilkinson 6/17/2013 18:11'!
test06CartRemembersAddedItems

	| cart |

	cart := testObjectsFactory createCart.

	cart add: testObjectsFactory itemSellByTheStore.
	self assert: (cart includes: testObjectsFactory itemSellByTheStore)! !
!CartTest methodsFor: 'tests' stamp: 'HernanWilkinson 6/17/2013 18:11'!
test07CartDoesNotHoldNotAddedItems

	| cart |

	cart := testObjectsFactory createCart.

	self deny: (cart includes: testObjectsFactory itemSellByTheStore)! !
!CartTest methodsFor: 'tests' stamp: 'HernanWilkinson 6/17/2013 18:11'!
test08CartRemembersTheNumberOfAddedItems

	| cart |

	cart := testObjectsFactory createCart.

	cart add: 2 of: testObjectsFactory itemSellByTheStore.
	self assert: (cart occurrencesOf: testObjectsFactory itemSellByTheStore) = 2! !
!CartTest methodsFor: 'setup' stamp: 'HernanWilkinson 6/17/2013 18:09' overrides: 16927572!
setUp

	testObjectsFactory := StoreTestObjectsFactory new.! !

!classDefinition: #CashierTest category: 'TusLibros-Tests' stamp: 'AF 11/19/2021 13:52:36'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'testObjectsFactory debitBehavior'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!

!classDefinition: #CashierTest category: 'TusLibros-Tests' stamp: 'AF 11/19/2021 13:52:37'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'testObjectsFactory debitBehavior'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!
!CashierTest methodsFor: 'tests' stamp: 'HernanWilkinson 6/22/2013 12:00'!
test01CanNotCheckoutAnEmptyCart

	| salesBook |

	salesBook := OrderedCollection new.
	self
		should: [ Cashier
			toCheckout: testObjectsFactory createCart
			ownedBy: testObjectsFactory customer
			charging: testObjectsFactory notExpiredCreditCard
			throught: self
			on: testObjectsFactory today
			registeringOn:  salesBook ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier cartCanNotBeEmptyErrorMessage.
			self assert: salesBook isEmpty ]! !
!CashierTest methodsFor: 'tests' stamp: 'HernanWilkinson 6/22/2013 12:22'!
test02CalculatedTotalIsCorrect

	| cart cashier |

	cart := testObjectsFactory createCart.
	cart add: 2 of: testObjectsFactory itemSellByTheStore.

	cashier :=  Cashier
		toCheckout: cart
		ownedBy: testObjectsFactory customer
		charging: testObjectsFactory notExpiredCreditCard
		throught: self
		on: testObjectsFactory today
		registeringOn: OrderedCollection new.

	self assert: cashier checkOut total = (testObjectsFactory itemSellByTheStorePrice * 2)! !
!CashierTest methodsFor: 'tests' stamp: 'HernanWilkinson 6/22/2013 12:01'!
test03CanNotCheckoutWithAnExpiredCreditCart

	| cart salesBook |

	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	salesBook := OrderedCollection new.

	self
		should: [ Cashier
				toCheckout: cart
				ownedBy: testObjectsFactory customer
				charging: testObjectsFactory expiredCreditCard
				throught: self
				on: testObjectsFactory today
				registeringOn: salesBook ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier canNotChargeAnExpiredCreditCardErrorMessage.
			self assert: salesBook isEmpty ]! !
!CashierTest methodsFor: 'tests' stamp: 'HernanWilkinson 6/22/2013 12:23'!
test04CheckoutRegistersASale

	| cart cashier salesBook total |

	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	salesBook := OrderedCollection new.

	cashier:= Cashier
		toCheckout: cart
		ownedBy: testObjectsFactory customer
		charging: testObjectsFactory notExpiredCreditCard
		throught: self
		on: testObjectsFactory today
		registeringOn: salesBook.

	total := cashier checkOut total.

	self assert: salesBook size = 1.
	self assert: salesBook first total = total.! !
!CashierTest methodsFor: 'tests' stamp: 'HernanWilkinson 6/22/2013 12:22'!
test05CashierChargesCreditCardUsingMerchantProcessor

	| cart cashier salesBook total creditCard debitedAmout debitedCreditCard  |

	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	creditCard := testObjectsFactory notExpiredCreditCard.
	salesBook := OrderedCollection new.

	cashier:= Cashier
		toCheckout: cart
		ownedBy: testObjectsFactory customer
		charging: creditCard
		throught: self
		on: testObjectsFactory today
		registeringOn: salesBook.

	debitBehavior := [ :anAmount :aCreditCard |
		debitedAmout := anAmount.
		debitedCreditCard := aCreditCard ].
	total := cashier checkOut total.

	self assert: debitedCreditCard = creditCard.
	self assert: debitedAmout = total.! !
!CashierTest methodsFor: 'tests' stamp: 'HernanWilkinson 6/22/2013 12:02'!
test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit

	| cart cashier salesBook creditCard |

	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	creditCard := testObjectsFactory notExpiredCreditCard.
	salesBook := OrderedCollection new.
 	debitBehavior := [ :anAmount :aCreditCard | self error: Cashier creditCardHasNoCreditErrorMessage].

	cashier:= Cashier
		toCheckout: cart
		ownedBy: testObjectsFactory customer
		charging: creditCard
		throught: self
		on: testObjectsFactory today
		registeringOn: salesBook.

	self
		should: [cashier checkOut ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier creditCardHasNoCreditErrorMessage.
			self assert: salesBook isEmpty ]! !
!CashierTest methodsFor: 'setup' stamp: 'HernanWilkinson 6/17/2013 19:03' overrides: 16927572!
setUp

	testObjectsFactory := StoreTestObjectsFactory new.
	debitBehavior := [ :anAmount :aCreditCard | ]! !
!CashierTest methodsFor: 'merchant processor protocol' stamp: 'HernanWilkinson 6/17/2013 19:02'!
debit: anAmount from: aCreditCard

	^debitBehavior value: anAmount value: aCreditCard ! !

!classDefinition: #TusLibrosServerTest category: 'TusLibros-Tests' stamp: 'AF 11/19/2021 13:52:37'!
TestCase subclass: #TusLibrosServerTest
	instanceVariableNames: 'testObjectsFactory clock systemFacade'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!

!classDefinition: #TusLibrosServerTest category: 'TusLibros-Tests' stamp: 'AF 11/19/2021 13:52:37'!
TestCase subclass: #TusLibrosServerTest
	instanceVariableNames: 'testObjectsFactory clock systemFacade'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!
!TusLibrosServerTest methodsFor: 'test objects' stamp: 'MP 11/18/2021 17:53:50'!
invalidPassword

	^'invalidPassword'! !
!TusLibrosServerTest methodsFor: 'test objects' stamp: 'MP 11/17/2021 15:47:47'!
validUser

	^'validUser'! !
!TusLibrosServerTest methodsFor: 'test objects' stamp: 'MP 11/17/2021 15:48:21'!
validUserPassword

	^'validUserPassword'! !
!TusLibrosServerTest methodsFor: 'test objects' stamp: 'MP 11/17/2021 15:48:17'!
validUsersAndPasswords

	^Dictionary new
		at: self validUser put: self validUserPassword;
		yourself! !
!TusLibrosServerTest methodsFor: 'setup' stamp: 'MP 11/17/2021 15:48:58'!
createSalesBook

	^OrderedCollection new! !
!TusLibrosServerTest methodsFor: 'setup' stamp: 'MP 11/17/2021 15:49:07'!
merchantProcessor

	^self! !
!TusLibrosServerTest methodsFor: 'setup' stamp: 'MP 11/17/2021 15:46:51' overrides: 16927572!
setUp
	
	testObjectsFactory := StoreTestObjectsFactory new.
	clock := ManualClock now: testObjectsFactory today.
	systemFacade := TusLibrosSystemFacade
		authenticatingWith: self validUsersAndPasswords
		acceptingItemsOf: testObjectsFactory defaultCatalog
		registeringOn: self createSalesBook
		debitingThrought: self merchantProcessor
		measuringTimeWith: clock
! !
!TusLibrosServerTest methodsFor: 'tests' stamp: 'MP 11/18/2021 17:49:47'!
test01CreateCartForValidCredentials

	|server resp client respText |
	
	server _ TusLibrosServer listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	respText _ resp content.
	
	client close.
	server destroy.
	self assert: '0|1' equals: respText.
	! !
!TusLibrosServerTest methodsFor: 'tests' stamp: 'MP 11/18/2021 18:30:20'!
test02CreateCartForInvalidCredentials

	|server resp client respText |
	
	server _ TusLibrosServer listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self invalidPassword ).
	respText _ resp content.
	
	client close.
	server destroy.
	self assert: '1|',TusLibrosServer invalidUserOrPasswordErrorDescription = respText.
	! !

!classDefinition: #TusLibrosSystemFacadeTest category: 'TusLibros-Tests' stamp: 'AF 11/19/2021 13:52:37'!
TestCase subclass: #TusLibrosSystemFacadeTest
	instanceVariableNames: 'testObjectsFactory clock systemFacade'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!

!classDefinition: #TusLibrosSystemFacadeTest category: 'TusLibros-Tests' stamp: 'AF 11/19/2021 13:52:37'!
TestCase subclass: #TusLibrosSystemFacadeTest
	instanceVariableNames: 'testObjectsFactory clock systemFacade'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!
!TusLibrosSystemFacadeTest methodsFor: 'tests - add to cart' stamp: 'HAW 6/19/2018 11:41:46'!
test04CanAddItemsToACreatedCart

	| cartId |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.

	systemFacade add: 1 of: self validBook toCartIdentifiedAs: cartId.
	self assert: ((systemFacade listCartIdentifiedAs: cartId) occurrencesOf: self validBook) equals: 1
		! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - add to cart' stamp: 'HAW 11/26/2018 18:03:02'!
test05CanNotAddItemToNotCreatedCart

	self
		should: [systemFacade add: 1 of: self validBook toCartIdentifiedAs: self invalidCartId]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText equals: systemFacade invalidCartIdErrorDescription ]
		! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - add to cart' stamp: 'HAW 11/26/2018 18:03:17'!
test06CanNotAddItemNotSellByTheStore

	| cartId |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	self
		should: [systemFacade add: 1 of: self invalidBook toCartIdentifiedAs: cartId ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText equals: systemFacade invalidItemErrorMessage.
			self assert: (systemFacade listCartIdentifiedAs: cartId) isEmpty ]
		! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - add to cart' stamp: 'HAW 11/26/2018 18:03:58'!
test17CanNotAddToCartWhenSessionIsExpired

	| cartId |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	self advanceTime: (systemFacade sessionDuration + 1 minutes) .
	self
		should: [systemFacade add: 2 of: self validBook toCartIdentifiedAs: cartId]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText equals: systemFacade sessionHasExpiredErrorDescription.
			self revertTime: systemFacade sessionDuration.
			self assert: (systemFacade listCartIdentifiedAs: cartId) isEmpty ]
! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - list purchases' stamp: 'HAW 11/26/2018 18:07:48'!
test14ListPurchasesIncludesBoughtItems

	| cartId purchases |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	systemFacade add: 2 of: self validBook toCartIdentifiedAs: cartId.
	systemFacade add: 1 of: self anotherValidBook toCartIdentifiedAs: cartId.
	systemFacade
		checkOutCartIdentifiedAs: cartId
		withCreditCardNumbered: '1111222233334444'
		ownedBy: 'Juan Perez'
		expiringOn: testObjectsFactory notExpiredMonthOfYear.

	purchases := systemFacade listPurchasesOf: self validUser authenticatingWith: self validUserPassword.

	self assert: (purchases at: self validBook) equals: (testObjectsFactory itemSellByTheStorePrice * 2).
	self assert: (purchases at: self anotherValidBook) equals: testObjectsFactory anotherItemSellByTheStorePrice.! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - list purchases' stamp: 'HAW 11/26/2018 18:10:29'!
test15CanNotListPurchasesOfInvalidCustomer

	self
		should: [systemFacade listPurchasesOf: self invalidUser authenticatingWith: self validUserPassword ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText equals: systemFacade invalidUserAndOrPasswordErrorDescription ]! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - list purchases' stamp: 'HAW 11/26/2018 18:10:45'!
test16CanNotListPurchasesOfValidCustomerWithInvalidPassword

	self
		should: [systemFacade listPurchasesOf: self validUser authenticatingWith: self invalidPassword ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText equals: systemFacade invalidUserAndOrPasswordErrorDescription ]! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - create cart' stamp: 'HAW 6/19/2018 11:40:51'!
test01CanCreateCartWithValidUserAndPassword

	| cartId |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	self assert: (systemFacade listCartIdentifiedAs: cartId) isEmpty
	! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - create cart' stamp: 'HAW 11/26/2018 18:02:23'!
test02CanNotCreateCartWithInvalidUser

	self
		should: [ systemFacade createCartFor: self invalidUser authenticatedWith: self validUserPassword ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText equals: systemFacade invalidUserAndOrPasswordErrorDescription ]! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - create cart' stamp: 'HAW 11/26/2018 18:02:33'!
test03CanNotCreateCartWithInvalidPassword

	self
		should: [ systemFacade createCartFor: self validUser authenticatedWith: self invalidPassword ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText equals: systemFacade invalidUserAndOrPasswordErrorDescription ]! !
!TusLibrosSystemFacadeTest methodsFor: 'merchant processor protocol' stamp: 'HernanWilkinson 6/22/2013 11:48'!
debit: anAmount from: aCreditCard
! !
!TusLibrosSystemFacadeTest methodsFor: 'setup' stamp: 'HernanWilkinson 6/22/2013 11:42'!
createSalesBook

	^OrderedCollection new! !
!TusLibrosSystemFacadeTest methodsFor: 'setup' stamp: 'HernanWilkinson 6/22/2013 11:47'!
merchantProcessor

	^self! !
!TusLibrosSystemFacadeTest methodsFor: 'setup' stamp: 'HernanWilkinson 6/17/2015 20:53' overrides: 16927572!
setUp

	testObjectsFactory := StoreTestObjectsFactory new.
	clock := ManualClock now: testObjectsFactory today.
	systemFacade := TusLibrosSystemFacade
		authenticatingWith: self validUsersAndPasswords
		acceptingItemsOf: testObjectsFactory defaultCatalog
		registeringOn: self createSalesBook
		debitingThrought: self merchantProcessor
		measuringTimeWith: clock
! !
!TusLibrosSystemFacadeTest methodsFor: 'test objects' stamp: 'HernanWilkinson 6/22/2013 00:15'!
anotherValidBook

	^testObjectsFactory anotherItemSellByTheStore ! !
!TusLibrosSystemFacadeTest methodsFor: 'test objects' stamp: 'HernanWilkinson 6/21/2013 23:49'!
invalidBook

	^testObjectsFactory itemNotSellByTheStore ! !
!TusLibrosSystemFacadeTest methodsFor: 'test objects' stamp: 'HernanWilkinson 6/21/2013 23:25'!
invalidCartId

	"Devuelvo nil porque seguro que siempre sera un id invalido, no importa que sea el id - Hernan"
	^nil! !
!TusLibrosSystemFacadeTest methodsFor: 'test objects' stamp: 'HernanWilkinson 6/21/2013 23:06'!
invalidPassword

	^'invalidPassword'! !
!TusLibrosSystemFacadeTest methodsFor: 'test objects' stamp: 'HernanWilkinson 6/21/2013 22:30'!
invalidUser

	^'invalidUser'! !
!TusLibrosSystemFacadeTest methodsFor: 'test objects' stamp: 'HernanWilkinson 6/21/2013 23:50'!
validBook

	^testObjectsFactory itemSellByTheStore ! !
!TusLibrosSystemFacadeTest methodsFor: 'test objects' stamp: 'HernanWilkinson 6/21/2013 22:27'!
validUser

	^'validUser'! !
!TusLibrosSystemFacadeTest methodsFor: 'test objects' stamp: 'HernanWilkinson 6/21/2013 22:28'!
validUserPassword

	^'validUserPassword'! !
!TusLibrosSystemFacadeTest methodsFor: 'test objects' stamp: 'HernanWilkinson 6/21/2013 22:43'!
validUsersAndPasswords

	^Dictionary new
		at: self validUser put: self validUserPassword;
		yourself! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - checkout' stamp: 'HAW 6/19/2018 11:45:13'!
test10CanCheckoutACart

	| cartId purchases |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	systemFacade add: 1 of: self validBook toCartIdentifiedAs: cartId.
	systemFacade
		checkOutCartIdentifiedAs: cartId
		withCreditCardNumbered: testObjectsFactory notExpiredCreditCardNumber
		ownedBy: testObjectsFactory notExpiredCreditCardOwner
		expiringOn: testObjectsFactory notExpiredMonthOfYear.

	purchases := systemFacade listPurchasesOf: self validUser authenticatingWith: self validUserPassword.

	self assert: (purchases at: self validBook) equals: testObjectsFactory itemSellByTheStorePrice.
! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - checkout' stamp: 'HAW 11/26/2018 18:05:20'!
test11CanNotCheckoutANotCreatedCart

	self
		should: [systemFacade
			checkOutCartIdentifiedAs: self invalidCartId
			withCreditCardNumbered: testObjectsFactory notExpiredCreditCardNumber
			ownedBy: testObjectsFactory notExpiredCreditCardOwner
			expiringOn: testObjectsFactory notExpiredMonthOfYear ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText equals: systemFacade invalidCartIdErrorDescription ]

		! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - checkout' stamp: 'HAW 11/26/2018 18:06:07'!
test12CanNotCheckoutAnEmptyCart

	| cartId |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	self
		should: [systemFacade
			checkOutCartIdentifiedAs: cartId
			withCreditCardNumbered: testObjectsFactory notExpiredCreditCardNumber
			ownedBy: testObjectsFactory notExpiredCreditCardOwner
			expiringOn: testObjectsFactory notExpiredMonthOfYear ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText equals: systemFacade cartCanNotBeEmptyErrorMessage.
			self assert: (systemFacade listPurchasesOf: self validUser authenticatingWith: self validUserPassword) isEmpty ]

		! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - checkout' stamp: 'HAW 11/26/2018 18:07:02'!
test13CanNotCheckoutWithAnExpiredCreditCard

	| cartId |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	systemFacade add: 1 of: self validBook toCartIdentifiedAs: cartId.
	self
		should: [systemFacade
			checkOutCartIdentifiedAs: cartId
			withCreditCardNumbered: testObjectsFactory notExpiredCreditCardNumber
			ownedBy: testObjectsFactory notExpiredCreditCardOwner
			expiringOn: testObjectsFactory expiredMonthOfYear ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText equals: systemFacade canNotChargeAnExpiredCreditCardErrorMessage.
			self assert: (systemFacade listPurchasesOf: self validUser authenticatingWith: self validUserPassword) isEmpty ]

		! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - checkout' stamp: 'HAW 11/26/2018 18:07:15'!
test19CanNotCheckOutCartWhenSessionIsExpired

	| cartId |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	systemFacade add: 2 of: self validBook toCartIdentifiedAs: cartId.
	self advanceTime: (systemFacade sessionDuration + 1 minutes) .
	self should: [
		systemFacade
			checkOutCartIdentifiedAs: cartId
			withCreditCardNumbered: testObjectsFactory notExpiredCreditCardNumber
			ownedBy: testObjectsFactory notExpiredCreditCardOwner
			expiringOn: testObjectsFactory notExpiredMonthOfYear ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText equals: systemFacade sessionHasExpiredErrorDescription.
			self assert: (systemFacade listPurchasesOf: self validUser authenticatingWith: self validUserPassword) isEmpty ]


	! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - list cart' stamp: 'HernanWilkinson 6/17/2015 20:53'!
test07ListCartOfAnEmptyCartReturnsAnEmptyBag

	| cartId |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	self assert: (systemFacade listCartIdentifiedAs: cartId) isEmpty
	! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - list cart' stamp: 'HAW 11/26/2018 18:04:15'!
test08CanNotListCartOfInvalidCartId

	self
		should: [systemFacade listCartIdentifiedAs: self invalidCartId]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText equals: systemFacade invalidCartIdErrorDescription ]
	! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - list cart' stamp: 'HAW 11/26/2018 18:04:32'!
test09ListCartReturnsTheRightNumberOfItems

	| cartId cartContent |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	systemFacade add: 1 of: self validBook toCartIdentifiedAs: cartId.
	systemFacade add: 2 of: self anotherValidBook toCartIdentifiedAs: cartId.
	cartContent := systemFacade listCartIdentifiedAs: cartId.

	self assert: (cartContent occurrencesOf: self validBook) equals: 1.
	self assert: (cartContent occurrencesOf: self anotherValidBook) equals: 2
! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - list cart' stamp: 'HAW 11/26/2018 18:04:42'!
test18CanNotListCartWhenSessionIsExpired

	| cartId |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	self advanceTime: (systemFacade sessionDuration + 1 minutes) .
	self
		should: [systemFacade listCartIdentifiedAs: cartId]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText equals: systemFacade sessionHasExpiredErrorDescription ].

! !
!TusLibrosSystemFacadeTest methodsFor: 'time' stamp: 'HernanWilkinson 6/22/2013 12:53'!
advanceTime: aDuration

	clock advanceTime: aDuration ! !
!TusLibrosSystemFacadeTest methodsFor: 'time' stamp: 'HernanWilkinson 6/22/2013 13:07'!
revertTime: aDuration

	clock revertTime: aDuration ! !

!classDefinition: #ManualClock category: 'TusLibros-Tests' stamp: 'AF 11/19/2021 13:52:38'!
Clock subclass: #ManualClock
	instanceVariableNames: 'now'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!

!classDefinition: #ManualClock category: 'TusLibros-Tests' stamp: 'AF 11/19/2021 13:52:38'!
Clock subclass: #ManualClock
	instanceVariableNames: 'now'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!
!ManualClock methodsFor: 'time change' stamp: 'HernanWilkinson 6/22/2013 12:54'!
advanceTime: aDuration

	now := now + aDuration ! !
!ManualClock methodsFor: 'time change' stamp: 'HernanWilkinson 6/22/2013 13:08'!
revertTime: aDuration

	now := now + aDuration negated ! !
!ManualClock methodsFor: 'time' stamp: 'HernanWilkinson 6/22/2013 12:56' overrides: 50975047!
now

	^ now! !
!ManualClock methodsFor: 'time' stamp: 'HernanWilkinson 6/22/2013 12:53' overrides: 50975051!
today

	^now date! !
!ManualClock methodsFor: 'initialization' stamp: 'HernanWilkinson 6/22/2013 12:52'!
initializeNow: aTime

	now := aTime ! !

!classDefinition: 'ManualClock class' category: 'TusLibros-Tests' stamp: 'AF 11/19/2021 13:52:38'!
ManualClock class
	instanceVariableNames: ''!

!classDefinition: 'ManualClock class' category: 'TusLibros-Tests' stamp: 'AF 11/19/2021 13:52:38'!
ManualClock class
	instanceVariableNames: ''!
!ManualClock class methodsFor: 'instance creation' stamp: 'HernanWilkinson 6/22/2013 12:52'!
now: aTime

	^self new initializeNow: aTime ! !

!classDefinition: #StoreTestObjectsFactory category: 'TusLibros-Tests' stamp: 'AF 11/19/2021 13:52:38'!
Object subclass: #StoreTestObjectsFactory
	instanceVariableNames: 'today'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!

!classDefinition: #StoreTestObjectsFactory category: 'TusLibros-Tests' stamp: 'AF 11/19/2021 13:52:38'!
Object subclass: #StoreTestObjectsFactory
	instanceVariableNames: 'today'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!
!StoreTestObjectsFactory methodsFor: 'items' stamp: 'HernanWilkinson 6/22/2013 00:16'!
anotherItemSellByTheStore

	^'anotherValidBook'! !
!StoreTestObjectsFactory methodsFor: 'items' stamp: 'HernanWilkinson 6/22/2013 00:16'!
anotherItemSellByTheStorePrice

	^15! !
!StoreTestObjectsFactory methodsFor: 'items' stamp: 'HernanWilkinson 6/17/2013 18:08'!
itemNotSellByTheStore

	^'invalidBook'! !
!StoreTestObjectsFactory methodsFor: 'items' stamp: 'HernanWilkinson 6/17/2013 18:08'!
itemSellByTheStore

	^ 'validBook'! !
!StoreTestObjectsFactory methodsFor: 'items' stamp: 'HernanWilkinson 6/17/2013 18:08'!
itemSellByTheStorePrice

	^10! !
!StoreTestObjectsFactory methodsFor: 'cart' stamp: 'HernanWilkinson 6/17/2013 18:08'!
createCart

	^Cart acceptingItemsOf: self defaultCatalog! !
!StoreTestObjectsFactory methodsFor: 'cart' stamp: 'HernanWilkinson 6/22/2013 00:16'!
defaultCatalog

	^ Dictionary new
		at: self itemSellByTheStore put: self itemSellByTheStorePrice;
		at: self anotherItemSellByTheStore put: self anotherItemSellByTheStorePrice;
		yourself ! !
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'HernanWilkinson 6/22/2013 11:24'!
expiredCreditCard

	^CreditCard expiringOn: self expiredMonthOfYear ! !
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'HernanWilkinson 6/22/2013 11:24'!
expiredMonthOfYear

	^ Month month: today monthIndex year: today yearNumber - 1! !
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'HernanWilkinson 6/22/2013 11:06'!
notExpiredCreditCard

	^CreditCard expiringOn: self notExpiredMonthOfYear! !
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'HAW 6/19/2018 11:45:30'!
notExpiredCreditCardNumber

	^ '1111222233334444' ! !
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'HAW 6/19/2018 11:45:48'!
notExpiredCreditCardOwner

	^'Juan Perez'! !
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'HernanWilkinson 6/22/2013 11:06'!
notExpiredMonthOfYear

	^ Month month: today monthIndex year: today yearNumber + 1! !
!StoreTestObjectsFactory methodsFor: 'initialization' stamp: 'HernanWilkinson 6/17/2013 18:37' overrides: 16896425!
initialize

	today := DateAndTime now! !
!StoreTestObjectsFactory methodsFor: 'date' stamp: 'HernanWilkinson 6/17/2013 18:37'!
today

	^ today! !
!StoreTestObjectsFactory methodsFor: 'customer' stamp: 'HernanWilkinson 6/22/2013 12:02'!
customer

	^'aCustomer'! !
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'AF 11/19/2021 11:45:30' prior: 50975899!
test01CreateCartForValidCredentials

	|server resp client respText |
	
	server _ TusLibrosRestInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	respText _ resp content.
	
	client close.
	server destroy.
	self assert: '0|1' equals: respText.
	! !
!TusLibrosServerTest methodsFor: 'as yet unclassified' stamp: 'AF 11/19/2021 11:45:30' prior: 50975914!
test02CreateCartForInvalidCredentials

	|server resp client respText |
	
	server _ TusLibrosRestInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self invalidPassword ).
	respText _ resp content.
	
	client close.
	server destroy.
	self assert: '1|',TusLibrosRestInterface invalidUserOrPasswordErrorDescription = respText.
	! !

!testRun: #TusLibrosSystemFacadeTest #test01CanCreateCartWithValidUserAndPassword stamp: 'AF 11/19/2021 13:53:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CanNotCreateCartWithInvalidUser stamp: 'AF 11/19/2021 13:53:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03CanNotCreateCartWithInvalidPassword stamp: 'AF 11/19/2021 13:53:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04CanAddItemsToACreatedCart stamp: 'AF 11/19/2021 13:53:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CanNotAddItemToNotCreatedCart stamp: 'AF 11/19/2021 13:53:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CanNotAddItemNotSellByTheStore stamp: 'AF 11/19/2021 13:53:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07ListCartOfAnEmptyCartReturnsAnEmptyBag stamp: 'AF 11/19/2021 13:53:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CanNotListCartOfInvalidCartId stamp: 'AF 11/19/2021 13:53:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09ListCartReturnsTheRightNumberOfItems stamp: 'AF 11/19/2021 13:53:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CanCheckoutACart stamp: 'AF 11/19/2021 13:53:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CanNotCheckoutANotCreatedCart stamp: 'AF 11/19/2021 13:53:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12CanNotCheckoutAnEmptyCart stamp: 'AF 11/19/2021 13:53:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CanNotCheckoutWithAnExpiredCreditCard stamp: 'AF 11/19/2021 13:53:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14ListPurchasesIncludesBoughtItems stamp: 'AF 11/19/2021 13:53:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15CanNotListPurchasesOfInvalidCustomer stamp: 'AF 11/19/2021 13:53:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16CanNotListPurchasesOfValidCustomerWithInvalidPassword stamp: 'AF 11/19/2021 13:53:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test17CanNotAddToCartWhenSessionIsExpired stamp: 'AF 11/19/2021 13:53:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test18CanNotListCartWhenSessionIsExpired stamp: 'AF 11/19/2021 13:53:19'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test19CanNotCheckOutCartWhenSessionIsExpired stamp: 'AF 11/19/2021 13:53:19'!
PASSED!

!classRenamed: #TusLibrosServer as: #TusLibrosRestAPIInterface stamp: 'AF 11/19/2021 13:54:53'!
Smalltalk renameClassNamed: #TusLibrosServer as: #TusLibrosRestAPIInterface!
!TusLibrosRestAPIInterface methodsFor: 'as yet unclassified' stamp: 'AF 11/19/2021 13:54:53' prior: 50975279!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			request send200Response: '0|',cartId asString .
		 ] 
		on: Error 
		do: [ :anError |
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: '1|',(TusLibrosRestAPIInterface invalidUserOrPasswordErrorDescription)] 
				ifFalse: [request send500Response: anError messageText	].
		]
	].
	
	webServer startListener.
! !

!classRenamed: #TusLibrosServerTest as: #TusLibrosRestAPIInterfaceTest stamp: 'AF 11/19/2021 13:55:14'!
Smalltalk renameClassNamed: #TusLibrosServerTest as: #TusLibrosRestAPIInterfaceTest!
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 13:55:22' prior: 50976532!
test01CreateCartForValidCredentials

	|server resp client respText |
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	respText _ resp content.
	
	client close.
	server destroy.
	self assert: '0|1' equals: respText.
	! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 13:56:15' prior: 50976548!
test02CreateCartForInvalidCredentials

	|server resp client respText |
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self invalidPassword ).
	respText _ resp content.
	
	client close.
	server destroy.
	self assert: '1|',TusLibrosRestAPIInterface invalidUserOrPasswordErrorDescription = respText.
	! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AF 11/19/2021 13:56:38'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AF 11/19/2021 13:56:38'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AF 11/19/2021 13:56:38'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AF 11/19/2021 13:56:38'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AF 11/19/2021 13:56:38'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AF 11/19/2021 13:56:38'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AF 11/19/2021 13:56:38'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AF 11/19/2021 13:56:38'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AF 11/19/2021 13:56:38'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AF 11/19/2021 13:56:38'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AF 11/19/2021 13:56:38'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AF 11/19/2021 13:56:39'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AF 11/19/2021 13:56:39'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AF 11/19/2021 13:56:39'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 13:56:39'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 13:56:39'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CanCreateCartWithValidUserAndPassword stamp: 'AF 11/19/2021 13:56:39'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CanNotCreateCartWithInvalidUser stamp: 'AF 11/19/2021 13:56:39'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03CanNotCreateCartWithInvalidPassword stamp: 'AF 11/19/2021 13:56:39'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04CanAddItemsToACreatedCart stamp: 'AF 11/19/2021 13:56:39'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CanNotAddItemToNotCreatedCart stamp: 'AF 11/19/2021 13:56:39'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CanNotAddItemNotSellByTheStore stamp: 'AF 11/19/2021 13:56:39'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07ListCartOfAnEmptyCartReturnsAnEmptyBag stamp: 'AF 11/19/2021 13:56:39'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CanNotListCartOfInvalidCartId stamp: 'AF 11/19/2021 13:56:39'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09ListCartReturnsTheRightNumberOfItems stamp: 'AF 11/19/2021 13:56:39'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CanCheckoutACart stamp: 'AF 11/19/2021 13:56:39'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CanNotCheckoutANotCreatedCart stamp: 'AF 11/19/2021 13:56:39'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12CanNotCheckoutAnEmptyCart stamp: 'AF 11/19/2021 13:56:39'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CanNotCheckoutWithAnExpiredCreditCard stamp: 'AF 11/19/2021 13:56:39'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14ListPurchasesIncludesBoughtItems stamp: 'AF 11/19/2021 13:56:39'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15CanNotListPurchasesOfInvalidCustomer stamp: 'AF 11/19/2021 13:56:39'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16CanNotListPurchasesOfValidCustomerWithInvalidPassword stamp: 'AF 11/19/2021 13:56:39'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test17CanNotAddToCartWhenSessionIsExpired stamp: 'AF 11/19/2021 13:56:39'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test18CanNotListCartWhenSessionIsExpired stamp: 'AF 11/19/2021 13:56:39'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test19CanNotCheckOutCartWhenSessionIsExpired stamp: 'AF 11/19/2021 13:56:39'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 13:56:44'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 13:56:44'!
PASSED!
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 14:02:45' prior: 50976643!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId response |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartId' -> cartId; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: '1|',(TusLibrosRestAPIInterface invalidUserOrPasswordErrorDescription)] 
				ifFalse: [request send500Response: anError messageText	].
		]
	].
	
	webServer startListener.
! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 14:03:11' prior: 50976677!
test01CreateCartForValidCredentials

	|server resp client respDecoded |
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	respDecoded _ resp content.
	
	client close.
	server destroy.
	self assert: '0|1' equals: respDecoded.
	! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 14:03:47' prior: 50976875!
test01CreateCartForValidCredentials

	|server resp client respDecoded |
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	respDecoded _ WebUtils jsonDecode: (resp content) readStream.
	
	client close.
	server destroy.
	
	
	self assert: '0|1' equals: respDecoded.
	! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 14:04:19' prior: 50976892!
test01CreateCartForValidCredentials

	|server resp client respDecoded respExpected|
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	respDecoded _ WebUtils jsonDecode: (resp content) readStream.
	
	client close.
	server destroy.
	
	respExpected := (Dictionary new) add: 'status' -> 0; add: 'cartId' -> 1; yourself.
	self assert: '0|1' equals: respDecoded.
	! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 14:05:08' prior: 50976910!
test01CreateCartForValidCredentials

	|server resp client respDecoded respExpected|
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	respDecoded _ WebUtils jsonDecode: (resp content) readStream.
	
	client close.
	server destroy.
	
	respExpected := (Dictionary new) add: 'status' -> 0; add: 'cartId' -> 1; yourself.
	
	self assert: (respExpected at: 'status') equals: (respDecoded at: 'status') .
	self assert: (respExpected at: 'cartId') equals: (respDecoded at: 'cartId') .! !

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 14:05:13'!
PASSED!

----SNAPSHOT----(19 November 2021 14:24:21) CuisUniversity-4972.image priorSource: 20491248!
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 14:32:09' prior: 50976693!
test02CreateCartForInvalidCredentials

	|server resp client respDecoded respExpected|
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self invalidPassword ).
	respDecoded _ WebUtils jsonDecode: (resp content) readStream.
	
	client close.
	server destroy.
	
	respExpected := Dictionary new add: 'status' -> 1; add: 'errorDescription' -> (TusLibrosSystemFacade invalidUserOrPasswordErrorDescription); yourself.
	
	self assert: (respExpected at: 'status') equals: (respDecoded at: 'status').
	! !

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 14:32:43'!
ERROR!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 14:32:43'!
ERROR!
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 14:33:52' prior: 50976962!
test02CreateCartForInvalidCredentials

	|server resp client respDecoded respExpected|
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self invalidPassword ).
	respDecoded _ WebUtils jsonDecode: (resp content) readStream.
	
	client close.
	server destroy.
	
	respExpected := Dictionary new add: 'status' -> 1; add: 'errorDescription' -> (systemFacade invalidUserOrPasswordErrorDescription); yourself.
	
	self assert: (respExpected at: 'status') equals: (respDecoded at: 'status').
	! !

!methodRemoval: TusLibrosRestAPIInterface class #invalidUserOrPasswordErrorDescription stamp: 'AF 11/19/2021 14:36:12'!
invalidUserOrPasswordErrorDescription
	^ 'INVALID_USERNAME_OR_PASSWORD'!
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 14:39:13' prior: 50976843!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId response |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartId' -> cartId; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: '1|',(systemFacade invalidUserOrPasswordErrorDescription)] 
				ifFalse: [request send500Response: anError messageText	].
		]
	].
	
	webServer startListener.
! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 14:40:33' prior: 50976994!
test02CreateCartForInvalidCredentials

	|server resp client respDecoded respExpected|
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self invalidPassword ).
	respDecoded _ WebUtils jsonDecode: (resp content) readStream.
	
	client close.
	server destroy.
	
	respExpected := Dictionary new add: 'status' -> 1; add: 'errorDescription' -> (systemFacade invalidUserAndOrPasswordErrorDescription); yourself.
	
	self assert: (respExpected at: 'status') equals: (respDecoded at: 'status').
	! !
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 14:41:34' prior: 50977024!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId response |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartId' -> cartId; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: '1|',(systemFacade invalidUserAndOrPasswordErrorDescription)] 
				ifFalse: [request send500Response: anError messageText	].
		]
	].
	
	webServer startListener.
! !

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 14:41:41'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 14:41:41'!
ERROR!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 14:41:41'!
ERROR!
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 14:42:29' prior: 50977055!
test02CreateCartForInvalidCredentials

	|server resp client respDecoded respExpected|
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self invalidPassword ).
	respDecoded _ WebUtils jsonMapFrom: (resp content) readStream.
	
	client close.
	server destroy.
	
	respExpected := Dictionary new add: 'status' -> 1; add: 'errorDescription' -> (systemFacade invalidUserAndOrPasswordErrorDescription); yourself.
	
	self assert: (respExpected at: 'status') equals: (respDecoded at: 'status').
	! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 14:42:53' prior: 50976931!
test01CreateCartForValidCredentials

	|server resp client respDecoded respExpected|
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	respDecoded _ WebUtils jsonMapFrom: (resp content) readStream.
	
	client close.
	server destroy.
	
	respExpected := (Dictionary new) add: 'status' -> 0; add: 'cartId' -> 1; yourself.
	
	self assert: (respExpected at: 'status') equals: (respDecoded at: 'status') .
	self assert: (respExpected at: 'cartId') equals: (respDecoded at: 'cartId') .! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 14:43:37' prior: 50977122!
test02CreateCartForInvalidCredentials

	|server resp client respDecoded respExpected|
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self invalidPassword ).
	respDecoded _ WebUtils jsonMapFrom: (resp content) readStream.
	
	client close.
	server destroy.
	
	respExpected := Dictionary new add: 'status' -> 1; add: 'errorDescription' -> (systemFacade invalidUserAndOrPasswordErrorDescription); yourself.
	
	self assert: (respExpected at: 'status') equals: (respDecoded at: 'status').
	self assert: (respExpected at: 'errorDescription') equals: (respDecoded at: 'errorDescription').
	! !

----SNAPSHOT----(19 November 2021 14:43:44) CuisUniversity-4972.image priorSource: 20649843!

TusLibrosRestAPIInterface allInstances!

WebServer allInstances!

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 14:45:56'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 14:45:56'!
ERROR!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 14:45:56'!
ERROR!
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 14:49:53' prior: 50977079!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId response |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartId' -> cartId; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: (WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
																			 add: 'errorDescription' -> systemFacade invalidUserAndOrPasswordErrorDescription;
																			 yourself))] 
				ifFalse: [request send500Response: anError messageText	].
		]
	].
	
	webServer startListener.
! !
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 14:51:04' prior: 50977215!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId response |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartId' -> cartId; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: (WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
																			 add: 'errorDescription' -> systemFacade invalidUserAndOrPasswordErrorDescription;
																			 yourself))] 
				ifFalse: [request send500Response: (WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
																			 add: 'errorDescription' -> anError messageText;
																			 yourself))	].
		]
	].
	
	webServer startListener.
! !
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 14:51:48' prior: 50977251!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId response |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartId' -> cartId; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: (WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
																			 add: 'errorDescription' -> anError messageText;
																			 yourself))] 
				ifFalse: [request send500Response: (WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
																			 add: 'errorDescription' -> anError messageText;
																			 yourself))	].
		]
	].
	
	webServer startListener.
! !
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 14:53:15' prior: 50977291!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId response |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartId' -> cartId; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			|response|
			response _ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
													     add: 'errorDescription' -> anError messageText;
													     yourself).
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: response] 
				ifFalse: [request send500Response: response	].
		]
	].
	
	webServer startListener.
! !

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 14:53:20'!
ERROR!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 14:53:20'!
ERROR!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 14:54:40'!
ERROR!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 14:54:46'!
FAILURE!

WebServer allInstances!

TusLibrosRestAPIInterface allInstances!

TusLibrosRestAPIInterface allInstancesDo: [:anInstance | anInstance destroy].!

TusLibrosRestAPIInterface allInstancesDo: [:anInstance | anInstance connections ].!

WebServer allInstancesDo: [:anInstance | anInstance connections].!

TusLibrosRestAPIInterface allInstances.!

TusLibrosRestAPIInterface allInstances.!

WebServer allInstances!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 15:01:55'!
PASSED!
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 15:05:26'!
decodeJsonMapFrom: resp

	^ WebUtils jsonMapFrom: (resp content) readStream! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 15:05:26' prior: 50977146!
test01CreateCartForValidCredentials

	|server resp client respDecoded respExpected|
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	respDecoded _ self decodeJsonMapFrom: resp.
	
	client close.
	server destroy.
	
	respExpected := (Dictionary new) add: 'status' -> 0; add: 'cartId' -> 1; yourself.
	
	self assert: (respExpected at: 'status') equals: (respDecoded at: 'status') .
	self assert: (respExpected at: 'cartId') equals: (respDecoded at: 'cartId') .! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 15:05:26' prior: 50977171!
test02CreateCartForInvalidCredentials

	|server resp client respDecoded respExpected|
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	resp _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self invalidPassword ).
	respDecoded _ self decodeJsonMapFrom: resp.
	
	client close.
	server destroy.
	
	respExpected := Dictionary new add: 'status' -> 1; add: 'errorDescription' -> (systemFacade invalidUserAndOrPasswordErrorDescription); yourself.
	
	self assert: (respExpected at: 'status') equals: (respDecoded at: 'status').
	self assert: (respExpected at: 'errorDescription') equals: (respDecoded at: 'errorDescription').
	! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 15:06:01' prior: 50977402!
test01CreateCartForValidCredentials

	|server response client respDecoded respExpected|
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	respDecoded _ self decodeJsonMapFrom: response.
	
	client close.
	server destroy.
	
	respExpected := (Dictionary new) add: 'status' -> 0; add: 'cartId' -> 1; yourself.
	
	self assert: (respExpected at: 'status') equals: (respDecoded at: 'status') .
	self assert: (respExpected at: 'cartId') equals: (respDecoded at: 'cartId') .! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 15:06:12' prior: 50977452!
test01CreateCartForValidCredentials

	|server response client responseDecoded respExpected|
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	client close.
	server destroy.
	
	respExpected := (Dictionary new) add: 'status' -> 0; add: 'cartId' -> 1; yourself.
	
	self assert: (respExpected at: 'status') equals: (responseDecoded at: 'status') .
	self assert: (respExpected at: 'cartId') equals: (responseDecoded at: 'cartId') .! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 15:06:18' prior: 50977476!
test01CreateCartForValidCredentials

	|server response client responseDecoded responseExpected|
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	client close.
	server destroy.
	
	responseExpected := (Dictionary new) add: 'status' -> 0; add: 'cartId' -> 1; yourself.
	
	self assert: (responseExpected at: 'status') equals: (responseDecoded at: 'status') .
	self assert: (responseExpected at: 'cartId') equals: (responseDecoded at: 'cartId') .! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 15:06:26' prior: 50977426!
test02CreateCartForInvalidCredentials

	|server response client respDecoded respExpected|
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self invalidPassword ).
	respDecoded _ self decodeJsonMapFrom: response.
	
	client close.
	server destroy.
	
	respExpected := Dictionary new add: 'status' -> 1; add: 'errorDescription' -> (systemFacade invalidUserAndOrPasswordErrorDescription); yourself.
	
	self assert: (respExpected at: 'status') equals: (respDecoded at: 'status').
	self assert: (respExpected at: 'errorDescription') equals: (respDecoded at: 'errorDescription').
	! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 15:06:32' prior: 50977526!
test02CreateCartForInvalidCredentials

	|server response client responseDecoded respExpected|
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self invalidPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	client close.
	server destroy.
	
	respExpected := Dictionary new add: 'status' -> 1; add: 'errorDescription' -> (systemFacade invalidUserAndOrPasswordErrorDescription); yourself.
	
	self assert: (respExpected at: 'status') equals: (responseDecoded at: 'status').
	self assert: (respExpected at: 'errorDescription') equals: (responseDecoded at: 'errorDescription').
	! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 15:06:38' prior: 50977553!
test02CreateCartForInvalidCredentials

	|server response client responseDecoded responseExpected|
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self invalidPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	client close.
	server destroy.
	
	responseExpected := Dictionary new add: 'status' -> 1; add: 'errorDescription' -> (systemFacade invalidUserAndOrPasswordErrorDescription); yourself.
	
	self assert: (responseExpected at: 'status') equals: (responseDecoded at: 'status').
	self assert: (responseExpected at: 'errorDescription') equals: (responseDecoded at: 'errorDescription').
	! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 15:09:17' prior: 50977580!
test02CreateCartForInvalidCredentials

	|server response client responseDecoded responseExpected|
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self invalidPassword).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	client close.
	server destroy.
	
	responseExpected := Dictionary new add: 'status' -> 1; add: 'errorDescription' -> (systemFacade invalidUserAndOrPasswordErrorDescription); yourself.
	
	self assert: (responseExpected at: 'status') equals: (responseDecoded at: 'status').
	self assert: (responseExpected at: 'errorDescription') equals: (responseDecoded at: 'errorDescription').
	! !

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 15:09:19'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 15:09:19'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 15:09:19'!
PASSED!

TusLibrosRestAPIInterface allInstances.!

TusLibrosRestAPIInterface allInstancesDo: [:anInstance | anInstance destroy].!

WebServer allInstancesDo: [:anInstance | anInstance connections].!

----SNAPSHOT----(19 November 2021 15:10:18) CuisUniversity-4972.image priorSource: 20657486!

WebServer allInstancesDo: [:anInstance | anInstance connections].!
!WebServer methodsFor: 'accessing' stamp: 'AF 11/19/2021 15:11:13' prior: 50958083!
connections
	"The active connection processes. Can only be examined after aquiring
	the WebServer's mutex."

	^connections! !
!WebServer methodsFor: 'accessing' stamp: 'AF 11/19/2021 15:11:22' prior: 50958103!
errorHandler: aBlock
	"The user-supplied error handler. If present the handler takes two arguments:
		* The error being caught by WebServer
		* The request the error occurred in.
	The user-supplied error handler can do whatever it wants, including calling
	WebServer's #handleError:request: method which is the default."

	errorHandler := aBlock.! !
!WebServer methodsFor: 'accessing' stamp: 'AF 11/19/2021 15:11:26' prior: 50958117!
listenerInterface
	"Returns the listener interface for the server"

	^interface! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 15:17:23'!
test03

	|server client cartId response responseDecoded responseExpected|
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	cartId _ responseDecoded at: 'cartId'.
	
	response _ (client httpGet: 'http://localhost:8080/addToCart?cartId=',cartId,'&bookIsbn=', testObjectsFactory itemSellByTheStore, '&bookQuantity=1').
	responseDecoded _ self decodeJsonMapFrom: response.
	
	client close.
	server destroy.
	
	responseExpected _ (Dictionary new) add: 'status' -> 0; yourself.
	
	self assert: (responseExpected at: 'status') equals: (responseDecoded at: 'status') .! !

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 15:17:28'!
ERROR!
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 15:18:05' prior: 50977685!
test03

	|server client cartId response responseDecoded responseExpected|
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	cartId _ responseDecoded at: 'cartId'.
	
	response _ (client httpGet: 'http://localhost:8080/addToCart?cartId=',cartId asString,'&bookIsbn=', testObjectsFactory itemSellByTheStore, '&bookQuantity=1').
	responseDecoded _ self decodeJsonMapFrom: response.
	
	client close.
	server destroy.
	
	responseExpected _ (Dictionary new) add: 'status' -> 0; yourself.
	
	self assert: (responseExpected at: 'status') equals: (responseDecoded at: 'status') .! !

WebServer allInstancesDo: [:anInstance | anInstance connections].
!

TusLibrosRestAPIInterface allInstancesDo: [:anInstance | anInstance destroy].!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 15:18:25'!
ERROR!

TusLibrosRestAPIInterface allInstancesDo: [:anInstance | anInstance destroy].!
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 15:21:50' prior: 50977330!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId response |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartId' -> cartId; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			|response|
			response _ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
													     add: 'errorDescription' -> anError messageText;
													     yourself).
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: response] 
				ifFalse: [request send500Response: response	].
		]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId response |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			
			response := (Dictionary new) add: 'status' -> 0; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			|response|
			response _ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
													     add: 'errorDescription' -> anError messageText;
													     yourself).
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: response] 
				ifFalse: [request send500Response: response	].
		]
	].
	webServer startListener.
! !
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 15:23:16' prior: 50977756!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId response |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartId' -> cartId; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			|response|
			response _ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
													     add: 'errorDescription' -> anError messageText;
													     yourself).
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: response] 
				ifFalse: [request send500Response: response	].
		]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId response |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount of: book toCartIdentifiedAs: cartId.
			
			response := (Dictionary new) add: 'status' -> 0; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			|response|
			response _ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
													     add: 'errorDescription' -> anError messageText;
													     yourself).
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: response] 
				ifFalse: [request send500Response: response	].
		]
	].
	webServer startListener.
! !

----SNAPSHOT----(19 November 2021 15:24:01) CuisUniversity-4972.image priorSource: 20672048!
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 15:27:09' prior: 50977816!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId response |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartId' -> cartId; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			|response|
			response _ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
													     add: 'errorDescription' -> anError messageText;
													     yourself).
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: response] 
				ifFalse: [request send500Response: response	].
		]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId response |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount of: book toCartIdentifiedAs: cartId.
			
			response := (Dictionary new) add: 'status' -> 0; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			|response|
			response _ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
													     add: 'errorDescription' -> anError messageText;
													     yourself).
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: response] 
				ifFalse: [request send500Response: response	].
		]
	].
	webServer startListener.
! !

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 15:27:13'!
ERROR!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 15:27:13'!
ERROR!
!WebServer methodsFor: 'initialize' stamp: 'AF 11/19/2021 15:29:39' prior: 50958029!
destroy
	"Destroys the receiver"

	self stopListener.
	self destroyConnections.
	listenerSocket ifNotNil:[listenerSocket destroy].

	"De-register the WebServer"
	(self class forUrl: self siteUrl ifAbsent:[self]) == self 
		ifTrue:[self class removeUrl: siteUrl]

! !

TusLibrosRestAPIInterface allInstancesDo: [:anInstance | anInstance destroy].!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 15:30:05'!
ERROR!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 15:30:05'!
ERROR!
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 15:32:21' prior: 50975274!
destroy
	
	webServer ifNotNil:[webServer destroy].
	webServer _ nil.! !
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 15:35:06' prior: 50977968!
destroy
	
	webServer ifNotNil:[webServer destroy].! !

TusLibrosRestAPIInterface allInstances.!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 15:35:46'!
ERROR!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 15:37:25'!
ERROR!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 15:37:48'!
ERROR!

TusLibrosRestAPIInterface allInstances.!

TusLibrosRestAPIInterface allInstancesDo: [:anInstance | anInstance destroy].!
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 15:39:35' prior: 50977881!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId response |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartId' -> cartId; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			|response|
			response _ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
													     add: 'errorDescription' -> anError messageText;
													     yourself).
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: response] 
				ifFalse: [request send500Response: response	].
		]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId response |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount of: book toCartIdentifiedAs: cartId.
			self halt.
			
			response := (Dictionary new) add: 'status' -> 0; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			|response|
			response _ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
													     add: 'errorDescription' -> anError messageText;
													     yourself).
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: response] 
				ifFalse: [request send500Response: response	].
		]
	].
	webServer startListener.
! !

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 15:39:40'!
ERROR!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 15:39:40'!
ERROR!

TusLibrosRestAPIInterface allInstancesDo: [:anInstance | anInstance destroy].!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 15:39:57'!
ERROR!
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 15:40:49' prior: 50977993!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId response |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartId' -> cartId; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			|response|
			response _ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
													     add: 'errorDescription' -> anError messageText;
													     yourself).
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: response] 
				ifFalse: [request send500Response: response	].
		]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId response |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			self halt.
			systemFacade add: bookAmount of: book toCartIdentifiedAs: cartId.
			
			
			response := (Dictionary new) add: 'status' -> 0; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			|response|
			response _ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
													     add: 'errorDescription' -> anError messageText;
													     yourself).
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: response] 
				ifFalse: [request send500Response: response	].
		]
	].
	webServer startListener.
! !

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 15:40:54'!
ERROR!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 15:40:54'!
ERROR!

TusLibrosRestAPIInterface allInstancesDo: [:anInstance | anInstance destroy].!

TusLibrosRestAPIInterface allInstancesDo: [:anInstance | anInstance destroy].!

----STARTUP---- (19 November 2021 15:41:33) as C:\Users\ferra\Desktop\windows64\windows64\CuisUniversity-4972.image!

!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 15:42:01' prior: 50977816!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId response |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
						
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartId' -> cartId; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			|response|
			response _ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
													     add: 'errorDescription' -> anError messageText;
													     yourself).
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: response] 
				ifFalse: [request send500Response: response	].
		]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId response |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			self halt.
			systemFacade add: bookAmount of: book toCartIdentifiedAs: cartId.
			
			response := (Dictionary new) add: 'status' -> 0; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			|response|
			response _ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
													     add: 'errorDescription' -> anError messageText;
													     yourself).
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: response] 
				ifFalse: [request send500Response: response	].
		]
	].
	webServer startListener.
! !

TusLibrosRestAPIInterface allInstances.!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 15:43:23'!
ERROR!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 15:43:32'!
ERROR!

TusLibrosRestAPIInterface allInstances.!

TusLibrosRestAPIInterface allInstancesDo: [:anInstance | anInstance destroy].!

TusLibrosRestAPIInterface allInstancesDo: [:anInstance | anInstance destroy].!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 15:46:14'!
ERROR!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 15:46:27'!
ERROR!

----STARTUP---- (19 November 2021 15:50:49) as C:\Users\ferra\Desktop\windows64\windows64\CuisUniversity-4972.image!


TusLibrosRestAPIInterface allInstances.!
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 15:51:28' prior: 50975274!
destroy
	
	webServer ifNotNil:[webServer destroy].
	systemFacade _ nil.! !

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 15:51:32'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 15:51:33'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 15:51:34'!
ERROR!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 15:51:34'!
ERROR!

TusLibrosRestAPIInterface allInstancesDo: [:anInstance | anInstance destroy].!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 15:52:28'!
ERROR!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 15:52:28'!
ERROR!

TusLibrosRestAPIInterface allInstancesDo: [:anInstance | anInstance destroy].!
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 15:52:46' prior: 50978229!
destroy
	
	webServer ifNotNil:[webServer destroy].
! !

TusLibrosRestAPIInterface allInstancesDo: [:anInstance | anInstance destroy].!
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 15:54:49' prior: 50977816!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId response |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
			self Halt.			
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartId' -> cartId; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			|response|
			response _ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
													     add: 'errorDescription' -> anError messageText;
													     yourself).
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: response] 
				ifFalse: [request send500Response: response	].
		]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId response |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount of: book toCartIdentifiedAs: cartId.
			
			response := (Dictionary new) add: 'status' -> 0; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			|response|
			response _ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
													     add: 'errorDescription' -> anError messageText;
													     yourself).
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: response] 
				ifFalse: [request send500Response: response	].
		]
	].
	webServer startListener.
! !

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 15:54:54'!
ERROR!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 15:54:54'!
ERROR!
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 15:58:26' prior: 50977501!
test01CreateCartForValidCredentials

	|server response client responseDecoded responseExpected|
	
	self setUp.
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	client close.
	server destroy.
	
	responseExpected := (Dictionary new) add: 'status' -> 0; add: 'cartId' -> 1; yourself.
	
	self assert: (responseExpected at: 'status') equals: (responseDecoded at: 'status') .
	self assert: (responseExpected at: 'cartId') equals: (responseDecoded at: 'cartId') .! !

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 16:00:17'!
ERROR!

TusLibrosRestAPIInterface allInstancesDo: [:anInstance | anInstance destroy].!

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 16:00:31'!
ERROR!

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 16:00:31'!
ERROR!
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 16:00:42' prior: 50978335!
test01CreateCartForValidCredentials

	|server response client responseDecoded responseExpected|
	

	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	client close.
	server destroy.
	
	responseExpected := (Dictionary new) add: 'status' -> 0; add: 'cartId' -> 1; yourself.
	
	self assert: (responseExpected at: 'status') equals: (responseDecoded at: 'status') .
	self assert: (responseExpected at: 'cartId') equals: (responseDecoded at: 'cartId') .! !

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 16:00:44'!
ERROR!

TusLibrosRestAPIInterface allInstancesDo: [:anInstance | anInstance destroy].!

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 16:01:01'!
ERROR!

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 16:01:01'!
ERROR!

TusLibrosRestAPIInterface allInstancesDo: [:anInstance | anInstance destroy].!

TusLibrosRestAPIInterface allInstances.!

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 16:01:31'!
ERROR!

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 16:01:31'!
ERROR!
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 16:02:17' prior: 50978267!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId response |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartId' -> cartId; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			|response|
			response _ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
													     add: 'errorDescription' -> anError messageText;
													     yourself).
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: response] 
				ifFalse: [request send500Response: response	].
		]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId response |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount of: book toCartIdentifiedAs: cartId.
			
			response := (Dictionary new) add: 'status' -> 0; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			|response|
			response _ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
													     add: 'errorDescription' -> anError messageText;
													     yourself).
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: response] 
				ifFalse: [request send500Response: response	].
		]
	].
	webServer startListener.
! !

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 16:02:48'!
ERROR!

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 16:02:48'!
ERROR!

TusLibrosRestAPIInterface allInstancesDo: [:anInstance | anInstance destroy].!

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 16:03:13'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 16:03:15'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 16:03:17'!
ERROR!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 16:03:17'!
ERROR!
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 16:03:44' prior: 50977717!
test03

	|server client cartId response responseDecoded responseExpected|
	self setUp.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	cartId _ responseDecoded at: 'cartId'.
	
	response _ (client httpGet: 'http://localhost:8080/addToCart?cartId=',cartId asString,'&bookIsbn=', testObjectsFactory itemSellByTheStore, '&bookQuantity=1').
	responseDecoded _ self decodeJsonMapFrom: response.
	
	client close.
	server destroy.
	
	responseExpected _ (Dictionary new) add: 'status' -> 0; yourself.
	
	self assert: (responseExpected at: 'status') equals: (responseDecoded at: 'status') .! !

TusLibrosRestAPIInterface allInstancesDo: [:anInstance | anInstance destroy].!
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 16:04:04' prior: 50978374!
test01CreateCartForValidCredentials

	|server response client responseDecoded responseExpected|
	
	self setUp.
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	client close.
	server destroy.
	
	responseExpected := (Dictionary new) add: 'status' -> 0; add: 'cartId' -> 1; yourself.
	
	self assert: (responseExpected at: 'status') equals: (responseDecoded at: 'status') .
	self assert: (responseExpected at: 'cartId') equals: (responseDecoded at: 'cartId') .! !

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 16:04:06'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 16:04:06'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 16:04:06'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 16:04:06'!
ERROR!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 16:04:06'!
ERROR!

TusLibrosRestAPIInterface allInstancesDo: [:anInstance | anInstance destroy].!

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 16:04:17'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 16:04:28'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 16:04:31'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 16:04:36'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 16:04:38'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 16:04:40'!
PASSED!
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 16:04:50' prior: 50977608!
test02CreateCartForInvalidCredentials

	|server response client responseDecoded responseExpected|
	
	self setUp.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self invalidPassword).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	client close.
	server destroy.
	
	responseExpected := Dictionary new add: 'status' -> 1; add: 'errorDescription' -> (systemFacade invalidUserAndOrPasswordErrorDescription); yourself.
	
	self assert: (responseExpected at: 'status') equals: (responseDecoded at: 'status').
	self assert: (responseExpected at: 'errorDescription') equals: (responseDecoded at: 'errorDescription').
	! !

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 16:04:52'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 16:04:52'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 16:04:52'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 16:04:52'!
ERROR!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 16:04:52'!
ERROR!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 16:04:55'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 16:04:57'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 16:05:00'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 16:05:00'!
FAILURE!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 16:05:00'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 16:05:00'!
ERROR!

TusLibrosRestAPIInterface allInstancesDo: [:anInstance | anInstance destroy].!

TusLibrosRestAPIInterface allInstances. !

TusLibrosRestAPIInterface allInstances. !

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 16:06:20'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 16:06:21'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 16:06:24'!
ERROR!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 16:06:24'!
ERROR!

TusLibrosRestAPIInterface allInstancesDo: [:anInstance | anInstance destroy].!
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 16:07:35' prior: 50978424!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId response |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartId' -> cartId; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			|response|
			response _ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
													     add: 'errorDescription' -> anError messageText;
													     yourself).
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: response] 
				ifFalse: [request send500Response: response	].
		]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId response |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount of: book toCartIdentifiedAs: cartId asNumber.
			
			response := (Dictionary new) add: 'status' -> 0; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			|response|
			response _ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
													     add: 'errorDescription' -> anError messageText;
													     yourself).
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: response] 
				ifFalse: [request send500Response: response	].
		]
	].
	webServer startListener.
! !
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 16:07:48' prior: 50978697!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId response |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartId' -> cartId; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			|response|
			response _ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
													     add: 'errorDescription' -> anError messageText;
													     yourself).
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: response] 
				ifFalse: [request send500Response: response	].
		]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId response |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount asNumber of: book toCartIdentifiedAs: cartId asNumber.
			
			response := (Dictionary new) add: 'status' -> 0; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			|response|
			response _ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
													     add: 'errorDescription' -> anError messageText;
													     yourself).
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: response] 
				ifFalse: [request send500Response: response	].
		]
	].
	webServer startListener.
! !

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 16:07:58'!
PASSED!

----SNAPSHOT----(19 November 2021 16:08:06) CuisUniversity-4972.image priorSource: 20679235!

TusLibrosRestAPIInterface allInstances. !

TusLibrosRestAPIInterface allInstances. !

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 16:08:45'!
PASSED!

TusLibrosRestAPIInterface allInstances. !

----SNAPSHOT----(19 November 2021 16:09:04) CuisUniversity-4972.image priorSource: 20709518!

TusLibrosRestAPIInterface allInstances. !

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 16:31:21'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 16:31:21'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 16:31:21'!
PASSED!
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 16:35:34' prior: 50978759!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId response |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartId' -> cartId; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			|response|
			response _ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
													     add: 'errorDescription' -> anError messageText;
													     yourself).
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: response] .
		]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId response |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount asNumber of: book toCartIdentifiedAs: cartId asNumber.
			
			response := (Dictionary new) add: 'status' -> 0; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			|response|
			response _ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
													     add: 'errorDescription' -> anError messageText;
													     yourself).
			(anError messageText = systemFacade invalidUserAndOrPasswordErrorDescription ) 
				ifTrue: [request send200Response: response] .
		]
	].
	webServer startListener.
! !
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 16:36:40' prior: 50978849!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId response |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartId' -> cartId; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			|response|
			response _ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
													     add: 'errorDescription' -> anError messageText;
													     yourself).
			request send200Response: response.
		]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId response |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount asNumber of: book toCartIdentifiedAs: cartId asNumber.
			
			response := (Dictionary new) add: 'status' -> 0; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			|response|
			response _ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
													     add: 'errorDescription' -> anError messageText;
													     yourself).
			request send200Response: response .
		]
	].
	webServer startListener.
! !

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 16:36:42'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 16:36:42'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 16:36:42'!
PASSED!
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 16:44:16'!
test04

	|server client cartId response responseDecoded responseExpected|
	self setUp.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	cartId _ (responseDecoded at: 'cartId') asString.
	
	client httpGet: 'http://localhost:8080/addToCart?cartId=',cartId,'&bookIsbn=', testObjectsFactory itemSellByTheStore, '&bookQuantity=1'.
	
	response _ (client httpGet: 'http://localhost:8080/listCart?cartId=',cartId ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	
	client close.
	server destroy.
	
	responseExpected _ (Dictionary new) add: 'status' -> 0; yourself.
	
	self assert: (responseExpected at: 'status') equals: (responseDecoded at: 'status') .! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 16:45:04' prior: 50978971!
test04

	|server client cartId response responseDecoded responseExpected|
	self setUp.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	cartId _ (responseDecoded at: 'cartId') asString.
	
	client httpGet: 'http://localhost:8080/addToCart?cartId=',cartId,'&bookIsbn=', testObjectsFactory itemSellByTheStore, '&bookQuantity=1'.
	
	response _ (client httpGet: 'http://localhost:8080/listCart?cartId=',cartId ).
	responseDecoded _ self decodeJsonMapFrom: response.
	

	client close.
	server destroy.
	
	responseExpected _ (Dictionary new) add: 'status' -> 0; yourself.
	
	self assert: (responseExpected at: 'status') equals: (responseDecoded at: 'status') .! !

!testRun: #TusLibrosRestAPIInterfaceTest #test04 stamp: 'AF 11/19/2021 16:45:06'!
ERROR!

TusLibrosRestAPIInterface allInstancesDo: [:anInstance | anInstance destroy].!
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 16:51:27' prior: 50979003!
test04

	|server client cartId response responseDecoded responseExpected|
	self setUp.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	cartId _ (responseDecoded at: 'cartId') asString.
	
	client httpGet: 'http://localhost:8080/addToCart?cartId=',cartId,'&bookIsbn=', testObjectsFactory itemSellByTheStore, '&bookQuantity=1'.
	
	response _ (client httpGet: 'http://localhost:8080/listCart?cartId=',cartId ).
	responseDecoded _ self decodeJsonMapFrom: response.
	

	client close.
	server destroy.
	
	responseExpected _ (Dictionary new) add: 'status' -> 0; yourself.
	
	self assert: (responseExpected at: 'status') equals: (responseDecoded at: 'status') .! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 16:55:08' prior: 50979040!
test04

	|server client cartId book response responseDecoded responseExpected|
	self setUp.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	cartId _ (responseDecoded at: 'cartId') asString.
	book _ testObjectsFactory itemSellByTheStore .
	
	client httpGet: 'http://localhost:8080/addToCart?cartId=',cartId,'&bookIsbn=', book, '&bookQuantity=1'.
	
	response _ (client httpGet: 'http://localhost:8080/listCart?cartId=',cartId ).
	responseDecoded _ self decodeJsonMapFrom: response.
	

	client close.
	server destroy.
	
	responseExpected _ (Dictionary new) add: 'status' -> 0; add: 'cartContents' -> ((Dictionary new) add: book -> 1 ;yourself) ; yourself.
	
	self assert: (responseExpected at: 'status') equals: (responseDecoded at: 'status') .! !

WebUtils jsonEncode: ((Bag new) add: 'hola'; yourself).!

WebUtils jsonMap: ((Bag new) add: 'hola'; yourself) on: (WriteStream on:'').!
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 17:09:48' prior: 50979072!
test04

	|server client cartId book response responseDecoded responseExpected|
	self setUp.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	cartId _ (responseDecoded at: 'cartId') asString.
	book _ testObjectsFactory itemSellByTheStore.
	
	client httpGet: 'http://localhost:8080/addToCart?cartId=',cartId,'&bookIsbn=', book, '&bookQuantity=1'.
	
	response _ (client httpGet: 'http://localhost:8080/listCart?cartId=',cartId ).
	responseDecoded _ self decodeJsonMapFrom: response.
	

	client close.
	server destroy.
	
	responseExpected _ (Dictionary new) add: 'status' -> 0; add: 'cartContents' -> ((Dictionary new) add: book -> 1 ;yourself) ; yourself.
	
	self assert: (responseExpected at: 'status') equals: (responseDecoded at: 'status') .! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 17:10:56' prior: 50979111!
test04

	|server client cartId book response responseDecoded responseExpected|
	self setUp.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	cartId _ (responseDecoded at: 'cartId') asString.
	book _ testObjectsFactory itemSellByTheStore.
	
	client httpGet: 'http://localhost:8080/addToCart?cartId=',cartId,'&bookIsbn=', book, '&bookQuantity=1'.
	
	response _ (client httpGet: 'http://localhost:8080/listCart?cartId=',cartId ).
	responseDecoded _ self decodeJsonMapFrom: response.
	

	client close.
	server destroy.
	
	responseExpected _ (Dictionary new) add: 'status' -> 0; add: 'cartContents' -> ((Dictionary new) add: book -> 1 ;yourself) ; yourself.
	
	self assert: (responseExpected at: 'status') equals: (responseDecoded at: 'status') .
	self assert: ((responseExpected at: 'cartContents') at: book) equals: ((responseDecoded at: 'cartContents') at: book) .
	! !

|book|
book _ 'hola'.
Dictionary new add: book -> 1.!


|book|
book _ 'hola'.
Dictionary new add: book -> 1; at: book.!

!testRun: #TusLibrosRestAPIInterfaceTest #test04 stamp: 'AF 11/19/2021 17:13:59'!
ERROR!

TusLibrosRestAPIInterface allInstancesDo: [:anInstance | anInstance destroy].!
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 17:15:44' prior: 50978908!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId response |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartId' -> cartId; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			|response|
			response _ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
													     add: 'errorDescription' -> anError messageText;
													     yourself).
			request send200Response: response.
		]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId response |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount asNumber of: book toCartIdentifiedAs: cartId asNumber.
			
			response := (Dictionary new) add: 'status' -> 0; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			|response|
			response _ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
													     add: 'errorDescription' -> anError messageText;
													     yourself).
			request send200Response: response .
		]
	].

	webServer addService: '/listCart' action:[:request | 
		[
			| cartId response |
			cartId := (request fields at:'cartId').	
			
			systemFacade listCartIdentifiedAs: cartId asNumber.
			
			response := (Dictionary new) add: 'status' -> 0; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			|response|
			response _ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
													     add: 'errorDescription' -> anError messageText;
													     yourself).
			request send200Response: response .
		]
	].
	webServer startListener.
! !

----End fileIn of C:\Users\ferra\Desktop\windows64\windows64\Packages\TerseGuide.pck.st----!

----SNAPSHOT----(19 November 2021 17:18:17) CuisUniversity-4972.image priorSource: 20709832!
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 17:24:00' prior: 50979194!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId response |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartId' -> cartId; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			|response|
			response _ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
													     add: 'errorDescription' -> anError messageText;
													     yourself).
			request send200Response: response.
		]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId response |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount asNumber of: book toCartIdentifiedAs: cartId asNumber.
			
			response := (Dictionary new) add: 'status' -> 0; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			|response|
			response _ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
													     add: 'errorDescription' -> anError messageText;
													     yourself).
			request send200Response: response .
		]
	].

	webServer addService: '/listCart' action:[:request | 
		[
			| cartId cartContents cartContentsDictionary response |
			cartId := (request fields at:'cartId').	
			
			cartContents _ systemFacade listCartIdentifiedAs: cartId asNumber.
			cartContentsDictionary _ Dictionary new.
			cartContents do:[:aBook | cartContentsDictionary add: aBook -> (cartContents occurrencesOf: aBook)] .
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartContents' -> cartContentsDictionary ; yourself.
			
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			|response|
			response _ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
													     add: 'errorDescription' -> anError messageText;
													     yourself).
			request send200Response: response .
		]
	].
	webServer startListener.
! !

----SNAPSHOT----(19 November 2021 17:24:37) CuisUniversity-4972.image priorSource: 20817249!

!testRun: #TusLibrosRestAPIInterfaceTest #test04 stamp: 'AF 11/19/2021 17:24:45'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test04 stamp: 'AF 11/19/2021 17:26:23'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 17:26:38'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 17:26:38'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 17:26:38'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test04 stamp: 'AF 11/19/2021 17:26:38'!
PASSED!

----SNAPSHOT----(19 November 2021 17:26:53) CuisUniversity-4972.image priorSource: 20819892!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AF 11/19/2021 17:38:45'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AF 11/19/2021 17:38:45'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AF 11/19/2021 17:38:45'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AF 11/19/2021 17:38:45'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AF 11/19/2021 17:38:45'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AF 11/19/2021 17:38:45'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AF 11/19/2021 17:38:45'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AF 11/19/2021 17:38:45'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AF 11/19/2021 17:38:45'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AF 11/19/2021 17:38:45'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AF 11/19/2021 17:38:45'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AF 11/19/2021 17:38:45'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AF 11/19/2021 17:38:45'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AF 11/19/2021 17:38:45'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 17:38:45'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 17:38:45'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 17:38:45'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test04 stamp: 'AF 11/19/2021 17:38:45'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CanCreateCartWithValidUserAndPassword stamp: 'AF 11/19/2021 17:38:45'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CanNotCreateCartWithInvalidUser stamp: 'AF 11/19/2021 17:38:45'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03CanNotCreateCartWithInvalidPassword stamp: 'AF 11/19/2021 17:38:45'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04CanAddItemsToACreatedCart stamp: 'AF 11/19/2021 17:38:45'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CanNotAddItemToNotCreatedCart stamp: 'AF 11/19/2021 17:38:45'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CanNotAddItemNotSellByTheStore stamp: 'AF 11/19/2021 17:38:45'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07ListCartOfAnEmptyCartReturnsAnEmptyBag stamp: 'AF 11/19/2021 17:38:45'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CanNotListCartOfInvalidCartId stamp: 'AF 11/19/2021 17:38:45'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09ListCartReturnsTheRightNumberOfItems stamp: 'AF 11/19/2021 17:38:45'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CanCheckoutACart stamp: 'AF 11/19/2021 17:38:45'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CanNotCheckoutANotCreatedCart stamp: 'AF 11/19/2021 17:38:45'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12CanNotCheckoutAnEmptyCart stamp: 'AF 11/19/2021 17:38:45'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CanNotCheckoutWithAnExpiredCreditCard stamp: 'AF 11/19/2021 17:38:45'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14ListPurchasesIncludesBoughtItems stamp: 'AF 11/19/2021 17:38:45'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15CanNotListPurchasesOfInvalidCustomer stamp: 'AF 11/19/2021 17:38:45'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16CanNotListPurchasesOfValidCustomerWithInvalidPassword stamp: 'AF 11/19/2021 17:38:45'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test17CanNotAddToCartWhenSessionIsExpired stamp: 'AF 11/19/2021 17:38:45'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test18CanNotListCartWhenSessionIsExpired stamp: 'AF 11/19/2021 17:38:45'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test19CanNotCheckOutCartWhenSessionIsExpired stamp: 'AF 11/19/2021 17:38:45'!
PASSED!
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 17:42:46'!
errorResponseBasedOn: anError

	^ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
													     add: 'errorDescription' -> anError messageText;
													     yourself)! !
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 17:42:46' prior: 50982194!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId response |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartId' -> cartId; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			|response|
			response _ self errorResponseBasedOn: anError.
			request send200Response: response.
		]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId response |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount asNumber of: book toCartIdentifiedAs: cartId asNumber.
			
			response := (Dictionary new) add: 'status' -> 0; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			|response|
			response _ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
													     add: 'errorDescription' -> anError messageText;
													     yourself).
			request send200Response: response .
		]
	].

	webServer addService: '/listCart' action:[:request | 
		[
			| cartId cartContents cartContentsDictionary response |
			cartId := (request fields at:'cartId').	
			
			cartContents _ systemFacade listCartIdentifiedAs: cartId asNumber.
			cartContentsDictionary _ Dictionary new.
			cartContents do:[:aBook | cartContentsDictionary add: aBook -> (cartContents occurrencesOf: aBook)] .
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartContents' -> cartContentsDictionary ; yourself.
			
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			|response|
			response _ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
													     add: 'errorDescription' -> anError messageText;
													     yourself).
			request send200Response: response .
		]
	].
	webServer startListener.
! !
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 17:42:46' prior: 50982438!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId response |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartId' -> cartId; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			|response|
			response _ self errorResponseBasedOn: anError.
			request send200Response: response.
		]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId response |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount asNumber of: book toCartIdentifiedAs: cartId asNumber.
			
			response := (Dictionary new) add: 'status' -> 0; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			|response|
			response _ self errorResponseBasedOn: anError.
			request send200Response: response .
		]
	].

	webServer addService: '/listCart' action:[:request | 
		[
			| cartId cartContents cartContentsDictionary response |
			cartId := (request fields at:'cartId').	
			
			cartContents _ systemFacade listCartIdentifiedAs: cartId asNumber.
			cartContentsDictionary _ Dictionary new.
			cartContents do:[:aBook | cartContentsDictionary add: aBook -> (cartContents occurrencesOf: aBook)] .
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartContents' -> cartContentsDictionary ; yourself.
			
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			|response|
			response _ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
													     add: 'errorDescription' -> anError messageText;
													     yourself).
			request send200Response: response .
		]
	].
	webServer startListener.
! !
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 17:42:47' prior: 50982514!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId response |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartId' -> cartId; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			|response|
			response _ self errorResponseBasedOn: anError.
			request send200Response: response.
		]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId response |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount asNumber of: book toCartIdentifiedAs: cartId asNumber.
			
			response := (Dictionary new) add: 'status' -> 0; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			|response|
			response _ self errorResponseBasedOn: anError.
			request send200Response: response .
		]
	].

	webServer addService: '/listCart' action:[:request | 
		[
			| cartId cartContents cartContentsDictionary response |
			cartId := (request fields at:'cartId').	
			
			cartContents _ systemFacade listCartIdentifiedAs: cartId asNumber.
			cartContentsDictionary _ Dictionary new.
			cartContents do:[:aBook | cartContentsDictionary add: aBook -> (cartContents occurrencesOf: aBook)] .
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartContents' -> cartContentsDictionary ; yourself.
			
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			|response|
			response _ self errorResponseBasedOn: anError.
			request send200Response: response .
		]
	].
	webServer startListener.
! !
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 17:44:46' prior: 50982586!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId response |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartId' -> cartId; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |			 
			request send200Response: (self errorResponseBasedOn: anError).
		]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId response |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount asNumber of: book toCartIdentifiedAs: cartId asNumber.
			
			response := (Dictionary new) add: 'status' -> 0; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			request send200Response: (self errorResponseBasedOn: anError) .
		]
	].

	webServer addService: '/listCart' action:[:request | 
		[
			| cartId cartContents cartContentsDictionary response |
			cartId := (request fields at:'cartId').	
			
			cartContents _ systemFacade listCartIdentifiedAs: cartId asNumber.
			cartContentsDictionary _ Dictionary new.
			cartContents do:[:aBook | cartContentsDictionary add: aBook -> (cartContents occurrencesOf: aBook)] .
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartContents' -> cartContentsDictionary ; yourself.
			
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			request send200Response: (self errorResponseBasedOn: anError) .
		]
	].
	webServer startListener.
! !
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 17:47:22'!
xxxxx: aBag

	! !
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 17:48:37' prior: 50982719!
xxxxx: aBag
	
	|cartContentsDictionary|

	cartContentsDictionary _ Dictionary new.
	aBag do:[:anItem | cartContentsDictionary add: anItem -> (aBag occurrencesOf: anItem)] ! !
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 17:48:50' prior: 50982723!
xxxxx: aBag
	
	|cartContentsDictionary|

	cartContentsDictionary _ Dictionary new.
	aBag do:[:anItem | cartContentsDictionary add: anItem -> (aBag occurrencesOf: anItem)].
	
	^cartContentsDictionary .! !
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 17:50:55' prior: 50982732!
xxxxx: aBag
	
	|cartContentsDictionary|

	cartContentsDictionary _ Dictionary new.
	aBag do:[:anItem | cartContentsDictionary add: anItem -> (aBag occurrencesOf: anItem)].
	
	^cartContentsDictionary.! !
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 17:51:38' prior: 50982654!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId response |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartId' -> cartId; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |			 
			request send200Response: (self errorResponseBasedOn: anError).
		]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId response |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount asNumber of: book toCartIdentifiedAs: cartId asNumber.
			
			response := (Dictionary new) add: 'status' -> 0; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			request send200Response: (self errorResponseBasedOn: anError) .
		]
	].

	webServer addService: '/listCart' action:[:request | 
		[
			| cartId cartContents cartContentsDictionary response |
			cartId := (request fields at:'cartId').	
			
			cartContents _ systemFacade listCartIdentifiedAs: cartId asNumber.
			cartContentsDictionary _ self xxxxx: cartContents.
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartContents' -> cartContentsDictionary ; yourself.
			
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			request send200Response: (self errorResponseBasedOn: anError) .
		]
	].
	webServer startListener.
! !
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 17:52:01'!
convertToDictionary: aBag
	
	|cartContentsDictionary|

	cartContentsDictionary _ Dictionary new.
	aBag do:[:anItem | cartContentsDictionary add: anItem -> (aBag occurrencesOf: anItem)].
	
	^cartContentsDictionary.! !
!TusLibrosRestAPIInterface methodsFor: 'as yet unclassified' stamp: 'AF 11/19/2021 17:52:01' prior: 50982752!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId response |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartId' -> cartId; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |			 
			request send200Response: (self errorResponseBasedOn: anError).
		]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId response |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount asNumber of: book toCartIdentifiedAs: cartId asNumber.
			
			response := (Dictionary new) add: 'status' -> 0; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			request send200Response: (self errorResponseBasedOn: anError) .
		]
	].

	webServer addService: '/listCart' action:[:request | 
		[
			| cartId cartContents cartContentsDictionary response |
			cartId := (request fields at:'cartId').	
			
			cartContents _ systemFacade listCartIdentifiedAs: cartId asNumber.
			cartContentsDictionary _ self convertToDictionary: cartContents.
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartContents' -> cartContentsDictionary ; yourself.
			
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			request send200Response: (self errorResponseBasedOn: anError) .
		]
	].
	webServer startListener.
! !

!methodRemoval: TusLibrosRestAPIInterface #xxxxx: stamp: 'AF 11/19/2021 17:52:01'!
xxxxx: aBag
	
	|cartContentsDictionary|

	cartContentsDictionary _ Dictionary new.
	aBag do:[:anItem | cartContentsDictionary add: anItem -> (aBag occurrencesOf: anItem)].
	
	^cartContentsDictionary.!

----SNAPSHOT----(19 November 2021 17:56:32) CuisUniversity-4972.image priorSource: 20820592!
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 17:58:32' prior: 50982825!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId response |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			
			response := (WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 0; add: 'cartId' -> cartId; yourself)).
			request send200Response: response.
		 ] 
		on: Error 
		do: [ :anError |			 
			request send200Response: (self errorResponseBasedOn: anError).
		]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId response |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount asNumber of: book toCartIdentifiedAs: cartId asNumber.
			
			response := (Dictionary new) add: 'status' -> 0; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			request send200Response: (self errorResponseBasedOn: anError) .
		]
	].

	webServer addService: '/listCart' action:[:request | 
		[
			| cartId cartContents cartContentsDictionary response |
			cartId := (request fields at:'cartId').	
			
			cartContents _ systemFacade listCartIdentifiedAs: cartId asNumber.
			cartContentsDictionary _ self convertToDictionary: cartContents.
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartContents' -> cartContentsDictionary ; yourself.
			
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			request send200Response: (self errorResponseBasedOn: anError) .
		]
	].
	webServer startListener.
! !
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 17:59:10' prior: 50982428!
errorResponseBasedOn: anError

	^ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
									   add: 'errorDescription' -> anError messageText;
									   yourself)! !
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 17:59:42' prior: 50982899!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId response |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			
			response := WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 0; add: 'cartId' -> cartId; yourself).
			request send200Response: response.
		 ] 
		on: Error 
		do: [ :anError |			 
			request send200Response: (self errorResponseBasedOn: anError).
		]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId response |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount asNumber of: book toCartIdentifiedAs: cartId asNumber.
			
			response := (Dictionary new) add: 'status' -> 0; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			request send200Response: (self errorResponseBasedOn: anError) .
		]
	].

	webServer addService: '/listCart' action:[:request | 
		[
			| cartId cartContents cartContentsDictionary response |
			cartId := (request fields at:'cartId').	
			
			cartContents _ systemFacade listCartIdentifiedAs: cartId asNumber.
			cartContentsDictionary _ self convertToDictionary: cartContents.
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartContents' -> cartContentsDictionary ; yourself.
			
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			request send200Response: (self errorResponseBasedOn: anError) .
		]
	].
	webServer startListener.
! !
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 18:00:58'!
responseForCreateCart: cartId

	^ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 0; add: 'cartId' -> cartId; yourself)! !
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 18:00:58' prior: 50982971!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId response |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
			
			response := self responseForCreateCart: cartId.
			request send200Response: response.
		 ] 
		on: Error 
		do: [ :anError |			 
			request send200Response: (self errorResponseBasedOn: anError).
		]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId response |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount asNumber of: book toCartIdentifiedAs: cartId asNumber.
			
			response := (Dictionary new) add: 'status' -> 0; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			request send200Response: (self errorResponseBasedOn: anError) .
		]
	].

	webServer addService: '/listCart' action:[:request | 
		[
			| cartId cartContents cartContentsDictionary response |
			cartId := (request fields at:'cartId').	
			
			cartContents _ systemFacade listCartIdentifiedAs: cartId asNumber.
			cartContentsDictionary _ self convertToDictionary: cartContents.
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartContents' -> cartContentsDictionary ; yourself.
			
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			request send200Response: (self errorResponseBasedOn: anError) .
		]
	].
	webServer startListener.
! !
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 18:01:38' prior: 50983041!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
						
			request send200Response: (self responseForCreateCart: cartId).
		 ] 
		on: Error 
		do: [ :anError |			 
			request send200Response: (self errorResponseBasedOn: anError).
		]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId response |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount asNumber of: book toCartIdentifiedAs: cartId asNumber.
			
			response := (Dictionary new) add: 'status' -> 0; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			request send200Response: (self errorResponseBasedOn: anError) .
		]
	].

	webServer addService: '/listCart' action:[:request | 
		[
			| cartId cartContents cartContentsDictionary response |
			cartId := (request fields at:'cartId').	
			
			cartContents _ systemFacade listCartIdentifiedAs: cartId asNumber.
			cartContentsDictionary _ self convertToDictionary: cartContents.
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartContents' -> cartContentsDictionary ; yourself.
			
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			request send200Response: (self errorResponseBasedOn: anError) .
		]
	].
	webServer startListener.
! !
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 18:02:32'!
jsonResponseForCreateCart: cartId

	^ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 0; add: 'cartId' -> cartId; yourself)! !
!TusLibrosRestAPIInterface methodsFor: 'as yet unclassified' stamp: 'AF 11/19/2021 18:02:32' prior: 50983102!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
						
			request send200Response: (self jsonResponseForCreateCart: cartId).
		 ] 
		on: Error 
		do: [ :anError |			 
			request send200Response: (self errorResponseBasedOn: anError).
		]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId response |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount asNumber of: book toCartIdentifiedAs: cartId asNumber.
			
			response := (Dictionary new) add: 'status' -> 0; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			request send200Response: (self errorResponseBasedOn: anError) .
		]
	].

	webServer addService: '/listCart' action:[:request | 
		[
			| cartId cartContents cartContentsDictionary response |
			cartId := (request fields at:'cartId').	
			
			cartContents _ systemFacade listCartIdentifiedAs: cartId asNumber.
			cartContentsDictionary _ self convertToDictionary: cartContents.
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartContents' -> cartContentsDictionary ; yourself.
			
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			request send200Response: (self errorResponseBasedOn: anError) .
		]
	].
	webServer startListener.
! !

!methodRemoval: TusLibrosRestAPIInterface #responseForCreateCart: stamp: 'AF 11/19/2021 18:02:32'!
responseForCreateCart: cartId

	^ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 0; add: 'cartId' -> cartId; yourself)!
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 18:02:52'!
jsonErrorResponseBasedOn: anError

	^ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
									   add: 'errorDescription' -> anError messageText;
									   yourself)! !
!TusLibrosRestAPIInterface methodsFor: 'as yet unclassified' stamp: 'AF 11/19/2021 18:02:52' prior: 50983169!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user psw cartId |
			user := (request fields at:'clientId').
			psw := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: psw.
						
			request send200Response: (self jsonResponseForCreateCart: cartId).
		 ] 
		on: Error 
		do: [ :anError |			 
			request send200Response: (self jsonErrorResponseBasedOn: anError).
		]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId response |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount asNumber of: book toCartIdentifiedAs: cartId asNumber.
			
			response := (Dictionary new) add: 'status' -> 0; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			request send200Response: (self jsonErrorResponseBasedOn: anError) .
		]
	].

	webServer addService: '/listCart' action:[:request | 
		[
			| cartId cartContents cartContentsDictionary response |
			cartId := (request fields at:'cartId').	
			
			cartContents _ systemFacade listCartIdentifiedAs: cartId asNumber.
			cartContentsDictionary _ self convertToDictionary: cartContents.
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartContents' -> cartContentsDictionary ; yourself.
			
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			request send200Response: (self jsonErrorResponseBasedOn: anError) .
		]
	].
	webServer startListener.
! !

!methodRemoval: TusLibrosRestAPIInterface #errorResponseBasedOn: stamp: 'AF 11/19/2021 18:02:52'!
errorResponseBasedOn: anError

	^ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 1; 
									   add: 'errorDescription' -> anError messageText;
									   yourself)!
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 18:03:28' prior: 50983245!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user password cartId |
			user := (request fields at:'clientId').
			password := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: password.
						
			request send200Response: (self jsonResponseForCreateCart: cartId).
		 ] 
		on: Error 
		do: [ :anError |			 
			request send200Response: (self jsonErrorResponseBasedOn: anError).
		]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId response |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount asNumber of: book toCartIdentifiedAs: cartId asNumber.
			
			response := (Dictionary new) add: 'status' -> 0; yourself.
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			request send200Response: (self jsonErrorResponseBasedOn: anError) .
		]
	].

	webServer addService: '/listCart' action:[:request | 
		[
			| cartId cartContents cartContentsDictionary response |
			cartId := (request fields at:'cartId').	
			
			cartContents _ systemFacade listCartIdentifiedAs: cartId asNumber.
			cartContentsDictionary _ self convertToDictionary: cartContents.
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartContents' -> cartContentsDictionary ; yourself.
			
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			request send200Response: (self jsonErrorResponseBasedOn: anError) .
		]
	].
	webServer startListener.
! !
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 18:04:25' prior: 50983314!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user password cartId |
			user := (request fields at:'clientId').
			password := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: password.
						
			request send200Response: (self jsonResponseForCreateCart: cartId).
		 ] 
		on: Error 
		do: [ :anError |			 
			request send200Response: (self jsonErrorResponseBasedOn: anError).
		]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId response |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount asNumber of: book toCartIdentifiedAs: cartId asNumber.
			
			response := WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 0; yourself).
			request send200Response: response .
		 ] 
		on: Error 
		do: [ :anError |
			request send200Response: (self jsonErrorResponseBasedOn: anError) .
		]
	].

	webServer addService: '/listCart' action:[:request | 
		[
			| cartId cartContents cartContentsDictionary response |
			cartId := (request fields at:'cartId').	
			
			cartContents _ systemFacade listCartIdentifiedAs: cartId asNumber.
			cartContentsDictionary _ self convertToDictionary: cartContents.
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartContents' -> cartContentsDictionary ; yourself.
			
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			request send200Response: (self jsonErrorResponseBasedOn: anError) .
		]
	].
	webServer startListener.
! !
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 18:04:37' prior: 50983375!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user password cartId |
			user := (request fields at:'clientId').
			password := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: password.
						
			request send200Response: (self jsonResponseForCreateCart: cartId).
		 ] 
		on: Error 
		do: [ :anError |			 
			request send200Response: (self jsonErrorResponseBasedOn: anError).
		]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId response |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount asNumber of: book toCartIdentifiedAs: cartId asNumber.
			
			response := WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 0; yourself).
			request send200Response: response .
		 ] 
		on: Error 
		do: [ :anError |
			request send200Response: (self jsonErrorResponseBasedOn: anError) .
		]
	].

	webServer addService: '/listCart' action:[:request | 
		[
			| cartId cartContents cartContentsDictionary response |
			cartId := (request fields at:'cartId').	
			
			cartContents _ systemFacade listCartIdentifiedAs: cartId asNumber.
			cartContentsDictionary _ self convertToDictionary: cartContents.
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartContents' -> cartContentsDictionary ; yourself.
			
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			request send200Response: (self jsonErrorResponseBasedOn: anError) .
		]
	].
	webServer startListener.
! !
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 18:05:09'!
jsonResponseForAddToCart

	^ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 0; yourself)! !
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 18:05:09' prior: 50983436!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user password cartId |
			user := (request fields at:'clientId').
			password := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: password.
						
			request send200Response: (self jsonResponseForCreateCart: cartId).
		 ] 
		on: Error 
		do: [ :anError |			 
			request send200Response: (self jsonErrorResponseBasedOn: anError).
		]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId response |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount asNumber of: book toCartIdentifiedAs: cartId asNumber.
			
			response := self jsonResponseForAddToCart.
			request send200Response: response .
		 ] 
		on: Error 
		do: [ :anError |
			request send200Response: (self jsonErrorResponseBasedOn: anError) .
		]
	].

	webServer addService: '/listCart' action:[:request | 
		[
			| cartId cartContents cartContentsDictionary response |
			cartId := (request fields at:'cartId').	
			
			cartContents _ systemFacade listCartIdentifiedAs: cartId asNumber.
			cartContentsDictionary _ self convertToDictionary: cartContents.
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartContents' -> cartContentsDictionary ; yourself.
			
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			request send200Response: (self jsonErrorResponseBasedOn: anError) .
		]
	].
	webServer startListener.
! !
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 18:05:29' prior: 50983503!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user password cartId |
			user := (request fields at:'clientId').
			password := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: password.
						
			request send200Response: (self jsonResponseForCreateCart: cartId).
		 ] 
		on: Error 
		do: [ :anError |			 
			request send200Response: (self jsonErrorResponseBasedOn: anError).
		]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount asNumber of: book toCartIdentifiedAs: cartId asNumber.

			request send200Response: self jsonResponseForAddToCart.
		 ] 
		on: Error 
		do: [ :anError |
			request send200Response: (self jsonErrorResponseBasedOn: anError) .
		]
	].

	webServer addService: '/listCart' action:[:request | 
		[
			| cartId cartContents cartContentsDictionary response |
			cartId := (request fields at:'cartId').	
			
			cartContents _ systemFacade listCartIdentifiedAs: cartId asNumber.
			cartContentsDictionary _ self convertToDictionary: cartContents.
			
			response := (Dictionary new) add: 'status' -> 0; add: 'cartContents' -> cartContentsDictionary ; yourself.
			
			request send200Response: (WebUtils jsonEncode: response) .
		 ] 
		on: Error 
		do: [ :anError |
			request send200Response: (self jsonErrorResponseBasedOn: anError) .
		]
	].
	webServer startListener.
! !
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 18:05:59' prior: 50983562!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user password cartId |
			user := (request fields at:'clientId').
			password := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: password.
						
			request send200Response: (self jsonResponseForCreateCart: cartId).
		 ] 
		on: Error 
		do: [ :anError |			 
			request send200Response: (self jsonErrorResponseBasedOn: anError).
		]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount asNumber of: book toCartIdentifiedAs: cartId asNumber.

			request send200Response: self jsonResponseForAddToCart.
		 ] 
		on: Error 
		do: [ :anError |
			request send200Response: (self jsonErrorResponseBasedOn: anError) .
		]
	].

	webServer addService: '/listCart' action:[:request | 
		[
			| cartId cartContents cartContentsDictionary response |
			cartId := (request fields at:'cartId').	
			
			cartContents _ systemFacade listCartIdentifiedAs: cartId asNumber.
			cartContentsDictionary _ self convertToDictionary: cartContents.
			
			response := WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 0; add: 'cartContents' -> cartContentsDictionary ; yourself).
			
			request send200Response: response .
		 ] 
		on: Error 
		do: [ :anError |
			request send200Response: (self jsonErrorResponseBasedOn: anError) .
		]
	].
	webServer startListener.
! !
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 18:06:30'!
jsonResponseForListCart: cartContentsDictionary

	^ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 0; add: 'cartContents' -> cartContentsDictionary ; yourself)! !
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 18:06:30' prior: 50983620!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user password cartId |
			user := (request fields at:'clientId').
			password := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: password.
						
			request send200Response: (self jsonResponseForCreateCart: cartId).
		 ] 
		on: Error 
		do: [ :anError |			 
			request send200Response: (self jsonErrorResponseBasedOn: anError).
		]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount asNumber of: book toCartIdentifiedAs: cartId asNumber.

			request send200Response: self jsonResponseForAddToCart.
		 ] 
		on: Error 
		do: [ :anError |
			request send200Response: (self jsonErrorResponseBasedOn: anError) .
		]
	].

	webServer addService: '/listCart' action:[:request | 
		[
			| cartId cartContents cartContentsDictionary response |
			cartId := (request fields at:'cartId').	
			
			cartContents _ systemFacade listCartIdentifiedAs: cartId asNumber.
			cartContentsDictionary _ self convertToDictionary: cartContents.
			
			response := self jsonResponseForListCart: cartContentsDictionary.
			
			request send200Response: response .
		 ] 
		on: Error 
		do: [ :anError |
			request send200Response: (self jsonErrorResponseBasedOn: anError) .
		]
	].
	webServer startListener.
! !
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 18:06:51' prior: 50983687!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user password cartId |
			user := (request fields at:'clientId').
			password := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: password.
						
			request send200Response: (self jsonResponseForCreateCart: cartId).
		 ] 
		on: Error 
		do: [ :anError |			 
			request send200Response: (self jsonErrorResponseBasedOn: anError).
		]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount asNumber of: book toCartIdentifiedAs: cartId asNumber.

			request send200Response: self jsonResponseForAddToCart.
		 ] 
		on: Error 
		do: [ :anError |
			request send200Response: (self jsonErrorResponseBasedOn: anError) .
		]
	].

	webServer addService: '/listCart' action:[:request | 
		[
			| cartId cartContents cartContentsDictionary |
			cartId := (request fields at:'cartId').	
			
			cartContents _ systemFacade listCartIdentifiedAs: cartId asNumber.
			cartContentsDictionary _ self convertToDictionary: cartContents.
			
			
			
			request send200Response: (self jsonResponseForListCart: cartContentsDictionary).
		 ] 
		on: Error 
		do: [ :anError |
			request send200Response: (self jsonErrorResponseBasedOn: anError) .
		]
	].
	webServer startListener.
! !
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 18:06:59' prior: 50983743!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user password cartId |
			user := (request fields at:'clientId').
			password := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: password.
						
			request send200Response: (self jsonResponseForCreateCart: cartId).
		 ] 
		on: Error 
		do: [ :anError |			 
			request send200Response: (self jsonErrorResponseBasedOn: anError).
		]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount asNumber of: book toCartIdentifiedAs: cartId asNumber.

			request send200Response: self jsonResponseForAddToCart.
		 ] 
		on: Error 
		do: [ :anError |
			request send200Response: (self jsonErrorResponseBasedOn: anError) .
		]
	].

	webServer addService: '/listCart' action:[:request | 
		[
			| cartId cartContents cartContentsDictionary |
			cartId := (request fields at:'cartId').	
			
			cartContents _ systemFacade listCartIdentifiedAs: cartId asNumber.
			cartContentsDictionary _ self convertToDictionary: cartContents.

			request send200Response: (self jsonResponseForListCart: cartContentsDictionary).
		 ] 
		on: Error 
		do: [ :anError |
			request send200Response: (self jsonErrorResponseBasedOn: anError) .
		]
	].
	webServer startListener.
! !

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 18:07:00'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 18:07:00'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 18:07:00'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test04 stamp: 'AF 11/19/2021 18:07:00'!
PASSED!
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 18:08:08' prior: 50983798!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user password cartId |
			user := (request fields at:'clientId').
			password := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: password.
						
			request send200Response: (self jsonResponseForCreateCart: cartId).
		 ] 
		on: Error 
		do: [ :anError |			 request send200Response: (self jsonErrorResponseBasedOn: anError).]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount asNumber of: book toCartIdentifiedAs: cartId asNumber.

			request send200Response: self jsonResponseForAddToCart.
		 ] 
		on: Error 
		do: [ :anError | request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].

	webServer addService: '/listCart' action:[:request | 
		[
			| cartId cartContents cartContentsDictionary |
			cartId := (request fields at:'cartId').	
			
			cartContents _ systemFacade listCartIdentifiedAs: cartId asNumber.
			cartContentsDictionary _ self convertToDictionary: cartContents.

			request send200Response: (self jsonResponseForListCart: cartContentsDictionary).
		 ] 
		on: Error 
		do: [ :anError |			request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].
	webServer startListener.
! !

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 18:08:33'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 18:08:33'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 18:08:33'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test04 stamp: 'AF 11/19/2021 18:08:33'!
PASSED!

----SNAPSHOT----(19 November 2021 18:08:37) CuisUniversity-4972.image priorSource: 20839827!

----SNAPSHOT----(19 November 2021 18:16:03) CuisUniversity-4972.image priorSource: 20873026!
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 18:21:33'!
test05

	|server client cartId book response responseDecoded responseExpected|
	self setUp.
	book _ testObjectsFactory itemSellByTheStore.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	cartId _ (responseDecoded at: 'cartId') asString.

	client httpGet: 'http://localhost:8080/addToCart?cartId=',cartId,'&bookIsbn=', book, '&bookQuantity=1'.
	
	response _ (client httpGet: 'http://localhost:8080/checkOutCart?cartId=',cartId,'&ccn=').
	responseDecoded _ self decodeJsonMapFrom: response.
	

	client close.
	server destroy.
	
	responseExpected _ (Dictionary new) add: 'status' -> 0; add: 'cartContents' -> ((Dictionary new) add: book -> 1 ;yourself) ; yourself.
	
	self assert: (responseExpected at: 'status') equals: (responseDecoded at: 'status') .
	self assert: ((responseExpected at: 'cartContents') at: book) equals: ((responseDecoded at: 'cartContents') at: book) .
	! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 18:25:34' prior: 50983939!
test05

	|server client cartId book creditCard response responseDecoded responseExpected|
	self setUp.
	book _ testObjectsFactory itemSellByTheStore.
	creditCard _ testObjectsFactory notExpiredCreditCard .
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	cartId _ (responseDecoded at: 'cartId') asString.

	client httpGet: 'http://localhost:8080/addToCart?cartId=',cartId,'&bookIsbn=', book, '&bookQuantity=1'.
	
	response _ (client httpGet: 'http://localhost:8080/checkOutCart?cartId=',cartId,'&ccn=', creditCard number, '&cced=', testObjectsFactory notExpiredMonthOfYear, '&cco=', testObjectsFactory notExpiredCreditCardOwner ).
	responseDecoded _ self decodeJsonMapFrom: response.
	

	client close.
	server destroy.
	
	responseExpected _ (Dictionary new) add: 'status' -> 0; add: 'cartContents' -> ((Dictionary new) add: book -> 1 ;yourself) ; yourself.
	
	self assert: (responseExpected at: 'status') equals: (responseDecoded at: 'status') .
	self assert: ((responseExpected at: 'cartContents') at: book) equals: ((responseDecoded at: 'cartContents') at: book) .
	! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 18:34:29' prior: 50983978!
test05

	|server client cartId book response responseDecoded responseExpected|
	self setUp.
	book _ testObjectsFactory itemSellByTheStore.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	cartId _ (responseDecoded at: 'cartId') asString.

	client httpGet: 'http://localhost:8080/addToCart?cartId=',cartId,'&bookIsbn=', book, '&bookQuantity=1'.
	
	response _ (client httpGet: 'http://localhost:8080/checkOutCart?cartId=',cartId,'&ccn=', testObjectsFactory notExpiredCreditCardNumber , '&cced=', testObjectsFactory notExpiredMonthOfYear, '&cco=', testObjectsFactory notExpiredCreditCardOwner).
	responseDecoded _ self decodeJsonMapFrom: response.
	

	client close.
	server destroy.
	
	responseExpected _ (Dictionary new) add: 'status' -> 0; add: 'cartContents' -> ((Dictionary new) add: book -> 1 ;yourself) ; yourself.
	
	self assert: (responseExpected at: 'status') equals: (responseDecoded at: 'status') .
	self assert: ((responseExpected at: 'cartContents') at: book) equals: ((responseDecoded at: 'cartContents') at: book) .
	! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 18:37:16' prior: 50984023!
test05

	|server client cartId book response responseDecoded responseExpected|
	self setUp.
	book _ testObjectsFactory itemSellByTheStore.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	cartId _ (responseDecoded at: 'cartId') asString.

	client httpGet: 'http://localhost:8080/addToCart?cartId=',cartId,'&bookIsbn=', book, '&bookQuantity=1'.
	
	response _ (client httpGet: 'http://localhost:8080/checkOutCart?cartId=', cartId,
			    										    '&ccn=', testObjectsFactory notExpiredCreditCardNumber, 
			    										  '&cced=', testObjectsFactory notExpiredMonthOfYear,
			    										   '&cco=', testObjectsFactory notExpiredCreditCardOwner).
	responseDecoded _ self decodeJsonMapFrom: response.
	

	client close.
	server destroy.
	
	responseExpected _ (Dictionary new) add: 'status' -> 0; add: 'cartContents' -> ((Dictionary new) add: book -> 1 ;yourself) ; yourself.
	
	self assert: (responseExpected at: 'status') equals: (responseDecoded at: 'status') .
	self assert: ((responseExpected at: 'cartContents') at: book) equals: ((responseDecoded at: 'cartContents') at: book) .
	! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 18:37:53' prior: 50984067!
test05

	|server client cartId book response responseDecoded responseExpected|
	self setUp.
	book _ testObjectsFactory itemSellByTheStore.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	cartId _ (responseDecoded at: 'cartId') asString.

	client httpGet: 'http://localhost:8080/addToCart?cartId=',cartId,'&bookIsbn=', book, '&bookQuantity=1'.
	
	response _ (client httpGet: 'http://localhost:8080/checkOutCart?cartId=', cartId,
			    										    '&ccn=', testObjectsFactory notExpiredCreditCardNumber, 
			    										  '&cced=', testObjectsFactory notExpiredMonthOfYear,
			    										   '&cco=', testObjectsFactory notExpiredCreditCardOwner).
	responseDecoded _ self decodeJsonMapFrom: response.

	client close.
	server destroy.
	
	responseExpected _ (Dictionary new) add: 'status' -> 0; add: 'cartContents' -> ((Dictionary new) add: book -> 1 ;yourself) ; yourself.
	
	self assert: (responseExpected at: 'status') equals: (responseDecoded at: 'status') .
	self assert: ((responseExpected at: 'cartContents') at: book) equals: ((responseDecoded at: 'cartContents') at: book) .
	! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 18:49:27' prior: 50984113!
test05

	|server client cartId book response responseDecoded responseExpected|
	self setUp.
	book _ testObjectsFactory itemSellByTheStore.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	cartId _ (responseDecoded at: 'cartId') asString.

	client httpGet: 'http://localhost:8080/addToCart?cartId=',cartId,'&bookIsbn=', book, '&bookQuantity=1'.
	
	response _ (client httpGet: 'http://localhost:8080/checkOutCart?cartId=', cartId,
			    										    '&ccn=', testObjectsFactory notExpiredCreditCardNumber, 
			    										  '&cced=', testObjectsFactory notExpiredMonthOfYear,
			    										   '&cco=', testObjectsFactory notExpiredCreditCardOwner).
	responseDecoded _ self decodeJsonMapFrom: response.

	client close.
	server destroy.
	
	responseExpected _ (Dictionary new) add: 'status' -> 0; yourself.
	
	self assert: (responseExpected at: 'status') equals: (responseDecoded at: 'status') .
	self assert: ((responseExpected at: 'cartContents') at: book) equals: ((responseDecoded at: 'cartContents') at: book) .
	! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 18:49:31' prior: 50984159!
test05

	|server client cartId book response responseDecoded responseExpected|
	self setUp.
	book _ testObjectsFactory itemSellByTheStore.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	cartId _ (responseDecoded at: 'cartId') asString.

	client httpGet: 'http://localhost:8080/addToCart?cartId=',cartId,'&bookIsbn=', book, '&bookQuantity=1'.
	
	response _ (client httpGet: 'http://localhost:8080/checkOutCart?cartId=', cartId,
			    										    '&ccn=', testObjectsFactory notExpiredCreditCardNumber, 
			    										  '&cced=', testObjectsFactory notExpiredMonthOfYear,
			    										   '&cco=', testObjectsFactory notExpiredCreditCardOwner).
	responseDecoded _ self decodeJsonMapFrom: response.

	client close.
	server destroy.
	
	responseExpected _ (Dictionary new) add: 'status' -> 0; yourself.
	
	self assert: (responseExpected at: 'status') equals: (responseDecoded at: 'status') .
	! !

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'AF 11/19/2021 18:49:35'!
ERROR!
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 18:54:30' prior: 50983866!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user password cartId |
			user := (request fields at:'clientId').
			password := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: password.
						
			request send200Response: (self jsonResponseForCreateCart: cartId).
		 ] 
		on: Error 
		do: [ :anError |			 request send200Response: (self jsonErrorResponseBasedOn: anError).]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount asNumber of: book toCartIdentifiedAs: cartId asNumber.

			request send200Response: self jsonResponseForAddToCart.
		 ] 
		on: Error 
		do: [ :anError | request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].

	webServer addService: '/listCart' action:[:request | 
		[
			| cartId cartContents cartContentsDictionary |
			cartId := (request fields at:'cartId').	
			
			cartContents _ systemFacade listCartIdentifiedAs: cartId asNumber.
			cartContentsDictionary _ self convertToDictionary: cartContents.

			request send200Response: (self jsonResponseForListCart: cartContentsDictionary).
		 ] 
		on: Error 
		do: [ :anError |			request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].

	webServer addService: '/checkOutCart' action:[:request | 
		[
			| cartId cardNumber cardExpirationDate cardOwner|
			cartId := (request fields at:'cartId') asNumber.	
			cardNumber := (request fields at:'ccn') .	
			cardExpirationDate := (request fields at:'ccn') .	
			cardOwner := (request fields at:'ccn') .	
			
			systemFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber  ownedBy: cardOwner expiringOn: cardExpirationDate .
			
			request send200Response: (self jsonSuccessfulResponse).
		 ] 
		on: Error 
		do: [ :anError |			request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].
	webServer startListener.
! !
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 18:54:56'!
jsonSuccessfulResponse

	^ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 0; yourself)! !
!TusLibrosRestAPIInterface methodsFor: 'as yet unclassified' stamp: 'AF 11/19/2021 18:54:56' prior: 50984245!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user password cartId |
			user := (request fields at:'clientId').
			password := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: password.
						
			request send200Response: (self jsonResponseForCreateCart: cartId).
		 ] 
		on: Error 
		do: [ :anError |			 request send200Response: (self jsonErrorResponseBasedOn: anError).]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount asNumber of: book toCartIdentifiedAs: cartId asNumber.

			request send200Response: self jsonSuccessfulResponse.
		 ] 
		on: Error 
		do: [ :anError | request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].

	webServer addService: '/listCart' action:[:request | 
		[
			| cartId cartContents cartContentsDictionary |
			cartId := (request fields at:'cartId').	
			
			cartContents _ systemFacade listCartIdentifiedAs: cartId asNumber.
			cartContentsDictionary _ self convertToDictionary: cartContents.

			request send200Response: (self jsonResponseForListCart: cartContentsDictionary).
		 ] 
		on: Error 
		do: [ :anError |			request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].

	webServer addService: '/checkOutCart' action:[:request | 
		[
			| cartId cardNumber cardExpirationDate cardOwner|
			cartId := (request fields at:'cartId') asNumber.	
			cardNumber := (request fields at:'ccn') .	
			cardExpirationDate := (request fields at:'ccn') .	
			cardOwner := (request fields at:'ccn') .	
			
			systemFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber  ownedBy: cardOwner expiringOn: cardExpirationDate .
			
			request send200Response: (self jsonSuccessfulResponse).
		 ] 
		on: Error 
		do: [ :anError |			request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].
	webServer startListener.
! !

!methodRemoval: TusLibrosRestAPIInterface #jsonResponseForAddToCart stamp: 'AF 11/19/2021 18:54:56'!
jsonResponseForAddToCart

	^ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 0; yourself)!
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 18:56:48' prior: 50984326!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user password cartId |
			user := (request fields at:'clientId').
			password := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: password.
						
			request send200Response: (self jsonResponseForCreateCart: cartId).
		 ] 
		on: Error 
		do: [ :anError |			 request send200Response: (self jsonErrorResponseBasedOn: anError).]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount asNumber of: book toCartIdentifiedAs: cartId asNumber.

			request send200Response: self jsonSuccessfulResponse.
		 ] 
		on: Error 
		do: [ :anError | request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].

	webServer addService: '/listCart' action:[:request | 
		[
			| cartId cartContents cartContentsDictionary |
			cartId := (request fields at:'cartId').	
			
			cartContents _ systemFacade listCartIdentifiedAs: cartId asNumber.
			cartContentsDictionary _ self convertToDictionary: cartContents.

			request send200Response: (self jsonResponseForListCart: cartContentsDictionary).
		 ] 
		on: Error 
		do: [ :anError |			request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].

	webServer addService: '/checkOutCart' action:[:request | 
		[
			| cartId cardNumber cardExpirationDate cardOwner|
			cartId := (request fields at:'cartId') asNumber.	
			cardNumber := (request fields at:'ccn') .	
			cardExpirationDate := (request fields at:'ccn') .	
			cardOwner := (request fields at:'ccn') .	
			
			systemFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber  ownedBy: cardOwner expiringOn: cardExpirationDate .
			
			request send200Response: (self jsonSuccessfulResponse).
		 ] 
		on: Error 
		do: [ :anError |			request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].
	webServer startListener.
! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 18:58:07' prior: 50984202!
test05

	|server client cartId book response responseDecoded responseExpected|
	self setUp.
	book _ testObjectsFactory itemSellByTheStore.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	cartId _ (responseDecoded at: 'cartId') asString.

	client httpGet: 'http://localhost:8080/addToCart?cartId=',cartId,'&bookIsbn=', book, '&bookQuantity=1'.
	
	response _ (client httpGet: 'http://localhost:8080/checkOutCart?cartId=', cartId,
			    										    '&ccn=', testObjectsFactory notExpiredCreditCardNumber, 
			    										  '&cced=', testObjectsFactory notExpiredMonthOfYear asString,
			    										   '&cco=', testObjectsFactory notExpiredCreditCardOwner).
	responseDecoded _ self decodeJsonMapFrom: response.

	client close.
	server destroy.
	
	responseExpected _ (Dictionary new) add: 'status' -> 0; yourself.
	
	self assert: (responseExpected at: 'status') equals: (responseDecoded at: 'status') .
	! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 19:03:20' prior: 50984481!
test05

	|server client cartId book response responseDecoded responseExpected|
	self setUp.
	book _ testObjectsFactory itemSellByTheStore.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	cartId _ (responseDecoded at: 'cartId') asString.

	client httpGet: 'http://localhost:8080/addToCart?cartId=',cartId,'&bookIsbn=', book, '&bookQuantity=1'.
	
	response _ (client httpGet: 'http://localhost:8080/checkOutCart?cartId=', cartId,
			    										    '&ccn=', testObjectsFactory notExpiredCreditCardNumber, 
			    										  '&cced=', testObjectsFactory notExpiredMonthOfYear,
			    										   '&cco=', testObjectsFactory notExpiredCreditCardOwner).
	responseDecoded _ self decodeJsonMapFrom: response.

	client close.
	server destroy.
	
	responseExpected _ (Dictionary new) add: 'status' -> 0; yourself.
	
	self assert: (responseExpected at: 'status') equals: (responseDecoded at: 'status') .
	! !

(Month month: DateAndTime now monthIndex year: DateAndTime now yearNumber) asString!

((Month month: DateAndTime now monthIndex year: DateAndTime now yearNumber) asString) asMonth!
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 19:09:45' prior: 50984521!
test05

	|server client cartId book response responseDecoded responseExpected|
	self setUp.
	book _ testObjectsFactory itemSellByTheStore.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	cartId _ (responseDecoded at: 'cartId') asString.

	client httpGet: 'http://localhost:8080/addToCart?cartId=',cartId,'&bookIsbn=', book, '&bookQuantity=1'.
	
	response _ (client httpGet: 'http://localhost:8080/checkOutCart?cartId=', cartId,
			    										    '&ccn=', testObjectsFactory notExpiredCreditCardNumber, 
			    										  '&cced=', testObjectsFactory notExpiredMonthOfYear asString,
			    										   '&cco=', testObjectsFactory notExpiredCreditCardOwner).
	responseDecoded _ self decodeJsonMapFrom: response.

	client close.
	server destroy.
	
	responseExpected _ (Dictionary new) add: 'status' -> 0; yourself.
	
	self assert: (responseExpected at: 'status') equals: (responseDecoded at: 'status') .
	! !
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 19:10:20' prior: 50984407!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user password cartId |
			user := (request fields at:'clientId').
			password := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: password.
						
			request send200Response: (self jsonResponseForCreateCart: cartId).
		 ] 
		on: Error 
		do: [ :anError |			 request send200Response: (self jsonErrorResponseBasedOn: anError).]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount asNumber of: book toCartIdentifiedAs: cartId asNumber.

			request send200Response: self jsonSuccessfulResponse.
		 ] 
		on: Error 
		do: [ :anError | request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].

	webServer addService: '/listCart' action:[:request | 
		[
			| cartId cartContents cartContentsDictionary |
			cartId := (request fields at:'cartId').	
			
			cartContents _ systemFacade listCartIdentifiedAs: cartId asNumber.
			cartContentsDictionary _ self convertToDictionary: cartContents.

			request send200Response: (self jsonResponseForListCart: cartContentsDictionary).
		 ] 
		on: Error 
		do: [ :anError |			request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].

	webServer addService: '/checkOutCart' action:[:request | 
		[
			| cartId cardNumber cardExpirationDate cardOwner|
			cartId := (request fields at:'cartId') asNumber.	
			cardNumber := (request fields at:'ccn') .	
			cardExpirationDate := (request fields at:'cced') asMonth.	
			cardOwner := (request fields at:'cco') .	
			
			systemFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber  ownedBy: cardOwner expiringOn: cardExpirationDate .
			
			request send200Response: (self jsonSuccessfulResponse).
		 ] 
		on: Error 
		do: [ :anError |			request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].
	webServer startListener.
! !

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 19:10:22'!
FAILURE!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 19:10:22'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 19:10:22'!
FAILURE!

!testRun: #TusLibrosRestAPIInterfaceTest #test04 stamp: 'AF 11/19/2021 19:10:22'!
ERROR!

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'AF 11/19/2021 19:10:22'!
ERROR!

TusLibrosRestAPIInterface allInstancesDo: [:anInstance | anInstance destroy].!

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 19:10:57'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 19:10:58'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 19:10:59'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test04 stamp: 'AF 11/19/2021 19:11:01'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'AF 11/19/2021 19:11:02'!
FAILURE!

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'AF 11/19/2021 19:11:02'!
FAILURE!

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'AF 11/19/2021 19:11:22'!
FAILURE!

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'AF 11/19/2021 19:11:22'!
FAILURE!

self content!

self contents!

self content!

TusLibrosRestAPIInterface allInstances. 
TusLibrosRestAPIInterface allInstancesDo: [:anInstance | anInstance destroy].
!
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 19:15:21' prior: 50984606!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user password cartId |
			user := (request fields at:'clientId').
			password := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: password.
						
			request send200Response: (self jsonResponseForCreateCart: cartId).
		 ] 
		on: Error 
		do: [ :anError |			 request send200Response: (self jsonErrorResponseBasedOn: anError).]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount asNumber of: book toCartIdentifiedAs: cartId asNumber.

			request send200Response: self jsonSuccessfulResponse.
		 ] 
		on: Error 
		do: [ :anError | request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].

	webServer addService: '/listCart' action:[:request | 
		[
			| cartId cartContents cartContentsDictionary |
			cartId := (request fields at:'cartId').	
			
			cartContents _ systemFacade listCartIdentifiedAs: cartId asNumber.
			cartContentsDictionary _ self convertToDictionary: cartContents.

			request send200Response: (self jsonResponseForListCart: cartContentsDictionary).
		 ] 
		on: Error 
		do: [ :anError |			request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].

	webServer addService: '/checkOutCart' action:[:request | 
		[
			| cartId cardNumber cardExpirationDate cardOwner|
			cartId := (request fields at:'cartId') asNumber.	
			cardNumber := (request fields at:'ccn') .	
			cardExpirationDate := (request fields at:'cced') asMonth.	
			cardOwner := (request fields at:'cco') .	
			
			self halt.
			systemFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber  ownedBy: cardOwner expiringOn: cardExpirationDate .
			
			request send200Response: (self jsonSuccessfulResponse).
		 ] 
		on: Error 
		do: [ :anError |			request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].
	webServer startListener.
! !

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'AF 11/19/2021 19:15:27'!
FAILURE!

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'AF 11/19/2021 19:15:27'!
FAILURE!

TusLibrosRestAPIInterface allInstancesDo: [:anInstance | anInstance destroy].
!

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'AF 11/19/2021 19:16:26'!
FAILURE!

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'AF 11/19/2021 19:16:26'!
FAILURE!

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'AF 11/19/2021 19:16:38'!
PASSED!

----SNAPSHOT----(19 November 2021 19:16:48) CuisUniversity-4972.image priorSource: 20873120!

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'AF 11/19/2021 19:16:52'!
FAILURE!

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'AF 11/19/2021 19:16:52'!
FAILURE!

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'AF 11/19/2021 19:16:55'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 19:17:03'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 19:17:03'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 19:17:04'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test04 stamp: 'AF 11/19/2021 19:17:04'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'AF 11/19/2021 19:17:04'!
FAILURE!

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'AF 11/19/2021 19:17:04'!
FAILURE!

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'AF 11/19/2021 19:17:06'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 19:17:18'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 19:17:18'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 19:17:18'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test04 stamp: 'AF 11/19/2021 19:17:18'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'AF 11/19/2021 19:17:18'!
FAILURE!

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'AF 11/19/2021 19:17:18'!
FAILURE!

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'AF 11/19/2021 19:17:21'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 19:17:22'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 19:17:22'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 19:17:22'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test04 stamp: 'AF 11/19/2021 19:17:22'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'AF 11/19/2021 19:17:22'!
FAILURE!

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'AF 11/19/2021 19:17:22'!
FAILURE!

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'AF 11/19/2021 19:17:34'!
PASSED!
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 19:19:29' prior: 50984729!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user password cartId |
			user := (request fields at:'clientId').
			password := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: password.
						
			request send200Response: (self jsonResponseForCreateCart: cartId).
		 ] 
		on: Error 
		do: [ :anError |			 request send200Response: (self jsonErrorResponseBasedOn: anError).]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount asNumber of: book toCartIdentifiedAs: cartId asNumber.

			request send200Response: self jsonSuccessfulResponse.
		 ] 
		on: Error 
		do: [ :anError | request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].

	webServer addService: '/listCart' action:[:request | 
		[
			| cartId cartContents cartContentsDictionary |
			cartId := (request fields at:'cartId').	
			
			cartContents _ systemFacade listCartIdentifiedAs: cartId asNumber.
			cartContentsDictionary _ self convertToDictionary: cartContents.

			request send200Response: (self jsonResponseForListCart: cartContentsDictionary).
		 ] 
		on: Error 
		do: [ :anError |			request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].

	webServer addService: '/checkOutCart' action:[:request | 
		[
			| cartId cardNumber cardExpirationDate cardOwner|
			cartId := (request fields at:'cartId') asNumber.	
			cardNumber := (request fields at:'ccn') .	
			cardExpirationDate := (request fields at:'cced') asMonth.	
			cardOwner := (request fields at:'cco') .	
			
			self halt.
			
			systemFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber  ownedBy: cardOwner expiringOn: cardExpirationDate .
			
			request send200Response: (self jsonSuccessfulResponse).
		 ] 
		on: Error 
		do: [ :anError |			request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].
	webServer startListener.
! !

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 19:19:30'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 19:19:30'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 19:19:30'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test04 stamp: 'AF 11/19/2021 19:19:30'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'AF 11/19/2021 19:19:30'!
FAILURE!

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'AF 11/19/2021 19:19:30'!
FAILURE!

----SNAPSHOT----(19 November 2021 19:19:39) CuisUniversity-4972.image priorSource: 20901412!
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 19:22:05' prior: 50984898!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user password cartId |
			user := (request fields at:'clientId').
			password := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: password.
						
			request send200Response: (self jsonResponseForCreateCart: cartId).
		 ] 
		on: Error 
		do: [ :anError |			 request send200Response: (self jsonErrorResponseBasedOn: anError).]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount asNumber of: book toCartIdentifiedAs: cartId asNumber.

			request send200Response: self jsonSuccessfulResponse.
		 ] 
		on: Error 
		do: [ :anError | request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].

	webServer addService: '/listCart' action:[:request | 
		[
			| cartId cartContents cartContentsDictionary |
			cartId := (request fields at:'cartId').	
			
			cartContents _ systemFacade listCartIdentifiedAs: cartId asNumber.
			cartContentsDictionary _ self convertToDictionary: cartContents.

			request send200Response: (self jsonResponseForListCart: cartContentsDictionary).
		 ] 
		on: Error 
		do: [ :anError |			request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].

	webServer addService: '/checkOutCart' action:[:request | 
		[
			| cartId cardNumber cardExpirationDate cardOwner|
			cartId := (request fields at:'cartId') asNumber.	
			cardNumber := (request fields at:'ccn') .	
			cardExpirationDate := (request fields at:'cced') asMonth.	
			cardOwner := (request fields at:'cco') .	
			
			systemFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber  ownedBy: cardOwner expiringOn: cardExpirationDate .
			
			request send200Response: (self jsonSuccessfulResponse).
		 ] 
		on: Error 
		do: [ :anError |			request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].
	webServer startListener.
! !
!TusLibrosSystemFacade methodsFor: 'facade protocol' stamp: 'AF 11/19/2021 19:22:36' prior: 50975463!
checkOutCartIdentifiedAs: aCartId withCreditCardNumbered: aCreditCartNumber ownedBy: anOwner expiringOn: anExpirationMonthOfYear

	self halt.

	self
		withCartSessionIdentifiedAs: aCartId
		do: [ :cartSession | cartSession
			checkOutCartWithCreditCardNumbered: aCreditCartNumber
			ownedBy: anOwner
			expiringOn: anExpirationMonthOfYear ]
! !

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 19:22:40'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 19:22:40'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 19:22:40'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test04 stamp: 'AF 11/19/2021 19:22:40'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'AF 11/19/2021 19:22:40'!
FAILURE!

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'AF 11/19/2021 19:22:40'!
FAILURE!
!TusLibrosSystemFacade methodsFor: 'facade protocol' stamp: 'AF 11/19/2021 19:22:56' prior: 50985070!
checkOutCartIdentifiedAs: aCartId withCreditCardNumbered: aCreditCartNumber ownedBy: anOwner expiringOn: anExpirationMonthOfYear

	self
		withCartSessionIdentifiedAs: aCartId
		do: [ :cartSession | cartSession
			checkOutCartWithCreditCardNumbered: aCreditCartNumber
			ownedBy: anOwner
			expiringOn: anExpirationMonthOfYear ]
! !

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/19/2021 19:23:15'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/19/2021 19:23:15'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/19/2021 19:23:15'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test04 stamp: 'AF 11/19/2021 19:23:15'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'AF 11/19/2021 19:23:15'!
FAILURE!

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'AF 11/19/2021 19:23:15'!
FAILURE!

----SNAPSHOT----(19 November 2021 19:23:21) CuisUniversity-4972.image priorSource: 20906892!

TusLibrosRestAPIInterface allInstances. 
TusLibrosRestAPIInterface allInstancesDo: [:anInstance | anInstance destroy].!

TusLibrosRestAPIInterface allInstancesDo: [:anInstance | anInstance destroy].!

TusLibrosRestAPIInterface allInstancesDo: [:anInstance | anInstance destroy].!

TusLibrosRestAPIInterface allInstancesDo: [:anInstance | anInstance destroy].!

TusLibrosRestAPIInterface allInstancesDo: [:anInstance | anInstance destroy].!

----SNAPSHOT----(19 November 2021 19:24:53) CuisUniversity-4972.image priorSource: 20911499!
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 19:25:07' prior: 50984995!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user password cartId |
			user := (request fields at:'clientId').
			password := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: password.
						
			request send200Response: (self jsonResponseForCreateCart: cartId).
		 ] 
		on: Error 
		do: [ :anError |			 request send200Response: (self jsonErrorResponseBasedOn: anError).]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount asNumber of: book toCartIdentifiedAs: cartId asNumber.

			request send200Response: self jsonSuccessfulResponse.
		 ] 
		on: Error 
		do: [ :anError | request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].

	webServer addService: '/listCart' action:[:request | 
		[
			| cartId cartContents cartContentsDictionary |
			cartId := (request fields at:'cartId').	
			
			cartContents _ systemFacade listCartIdentifiedAs: cartId asNumber.
			cartContentsDictionary _ self convertToDictionary: cartContents.

			request send200Response: (self jsonResponseForListCart: cartContentsDictionary).
		 ] 
		on: Error 
		do: [ :anError |			request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].

	webServer addService: '/checkOutCart' action:[:request | 
		[
			| cartId cardNumber cardExpirationDate cardOwner|
			cartId := (request fields at:'cartId') asNumber.	
			cardNumber := (request fields at:'ccn') .	
			cardExpirationDate := (request fields at:'cced') asMonth.	
			cardOwner := (request fields at:'cco') .	
			
			self halt.
			
			systemFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber  ownedBy: cardOwner expiringOn: cardExpirationDate .
			
			request send200Response: (self jsonSuccessfulResponse).
		 ] 
		on: Error 
		do: [ :anError |			request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].
	webServer startListener.
! !

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'AF 11/19/2021 19:25:14'!
FAILURE!

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'AF 11/19/2021 19:25:14'!
FAILURE!
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 19:47:55' prior: 50984566!
test05

	|server client cartId book response responseDecoded responseExpected creditCardExpirationHttpEncoded |
	self setUp.
	book _ testObjectsFactory itemSellByTheStore.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	cartId _ (responseDecoded at: 'cartId') asString.

	client httpGet: 'http://localhost:8080/addToCart?cartId=',cartId,'&bookIsbn=', book, '&bookQuantity=1'.
	
	creditCardExpirationHttpEncoded _ testObjectsFactory notExpiredMonthOfYear monthName, '%20',testObjectsFactory notExpiredMonthOfYear yearNumber.
	
	response _ (client httpGet: 'http://localhost:8080/checkOutCart?cartId=', cartId,
			    										    '&ccn=', testObjectsFactory notExpiredCreditCardNumber, 
			    										  '&cced=', creditCardExpirationHttpEncoded,
			    										   '&cco=', testObjectsFactory notExpiredCreditCardOwner).
	responseDecoded _ self decodeJsonMapFrom: response.

	client close.
	server destroy.
	
	responseExpected _ (Dictionary new) add: 'status' -> 0; yourself.
	
	self assert: (responseExpected at: 'status') equals: (responseDecoded at: 'status') .
	! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 19:48:38' prior: 50985237!
test05

	|server client cartId book response responseDecoded responseExpected creditCardExpirationHttpEncoded |
	self setUp.
	book _ testObjectsFactory itemSellByTheStore.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	cartId _ (responseDecoded at: 'cartId') asString.

	client httpGet: 'http://localhost:8080/addToCart?cartId=',cartId,'&bookIsbn=', book, '&bookQuantity=1'.
	
	creditCardExpirationHttpEncoded _ testObjectsFactory notExpiredMonthOfYear monthName,'%20',testObjectsFactory notExpiredMonthOfYear yearNumber.
	
	response _ (client httpGet: 'http://localhost:8080/checkOutCart?cartId=', cartId,
			    										    '&ccn=', testObjectsFactory notExpiredCreditCardNumber, 
			    										  '&cced=', creditCardExpirationHttpEncoded,
			    										   '&cco=', testObjectsFactory notExpiredCreditCardOwner).
	responseDecoded _ self decodeJsonMapFrom: response.

	client close.
	server destroy.
	
	responseExpected _ (Dictionary new) add: 'status' -> 0; yourself.
	
	self assert: (responseExpected at: 'status') equals: (responseDecoded at: 'status') .
	! !

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'AF 11/19/2021 19:48:53'!
ERROR!

TusLibrosRestAPIInterface allInstances. 
TusLibrosRestAPIInterface allInstancesDo: [:anInstance | anInstance destroy].
!
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 19:49:14' prior: 50985282!
test05

	|server client cartId book response responseDecoded responseExpected creditCardExpirationHttpEncoded |
	self setUp.
	book _ testObjectsFactory itemSellByTheStore.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	cartId _ (responseDecoded at: 'cartId') asString.

	client httpGet: 'http://localhost:8080/addToCart?cartId=',cartId,'&bookIsbn=', book, '&bookQuantity=1'.
	
	creditCardExpirationHttpEncoded _ testObjectsFactory notExpiredMonthOfYear monthName,'%20',testObjectsFactory notExpiredMonthOfYear yearNumber asString.
	
	response _ (client httpGet: 'http://localhost:8080/checkOutCart?cartId=', cartId,
			    										    '&ccn=', testObjectsFactory notExpiredCreditCardNumber, 
			    										  '&cced=', creditCardExpirationHttpEncoded,
			    										   '&cco=', testObjectsFactory notExpiredCreditCardOwner).
	responseDecoded _ self decodeJsonMapFrom: response.

	client close.
	server destroy.
	
	responseExpected _ (Dictionary new) add: 'status' -> 0; yourself.
	
	self assert: (responseExpected at: 'status') equals: (responseDecoded at: 'status') .
	! !

----STARTUP---- (19 November 2021 19:50:15) as C:\Users\ferra\Desktop\windows64\windows64\CuisUniversity-4972.image!

!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 19:25:07' prior: 50984995!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user password cartId |
			user := (request fields at:'clientId').
			password := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: password.
						
			request send200Response: (self jsonResponseForCreateCart: cartId).
		 ] 
		on: Error 
		do: [ :anError |			 request send200Response: (self jsonErrorResponseBasedOn: anError).]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount asNumber of: book toCartIdentifiedAs: cartId asNumber.

			request send200Response: self jsonSuccessfulResponse.
		 ] 
		on: Error 
		do: [ :anError | request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].

	webServer addService: '/listCart' action:[:request | 
		[
			| cartId cartContents cartContentsDictionary |
			cartId := (request fields at:'cartId').	
			
			cartContents _ systemFacade listCartIdentifiedAs: cartId asNumber.
			cartContentsDictionary _ self convertToDictionary: cartContents.

			request send200Response: (self jsonResponseForListCart: cartContentsDictionary).
		 ] 
		on: Error 
		do: [ :anError |			request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].

	webServer addService: '/checkOutCart' action:[:request | 
		[
			| cartId cardNumber cardExpirationDate cardOwner|
			cartId := (request fields at:'cartId') asNumber.	
			cardNumber := (request fields at:'ccn') .	
			cardExpirationDate := (request fields at:'cced') asMonth.	
			cardOwner := (request fields at:'cco') .	
			
			self halt.
			
			systemFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber  ownedBy: cardOwner expiringOn: cardExpirationDate .
			
			request send200Response: (self jsonSuccessfulResponse).
		 ] 
		on: Error 
		do: [ :anError |			request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].
	webServer startListener.
! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 19:47:55' prior: 50984566!
test05

	|server client cartId book response responseDecoded responseExpected creditCardExpirationHttpEncoded |
	self setUp.
	book _ testObjectsFactory itemSellByTheStore.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	cartId _ (responseDecoded at: 'cartId') asString.

	client httpGet: 'http://localhost:8080/addToCart?cartId=',cartId,'&bookIsbn=', book, '&bookQuantity=1'.
	
	creditCardExpirationHttpEncoded _ testObjectsFactory notExpiredMonthOfYear monthName, '%20',testObjectsFactory notExpiredMonthOfYear yearNumber.
	
	response _ (client httpGet: 'http://localhost:8080/checkOutCart?cartId=', cartId,
			    										    '&ccn=', testObjectsFactory notExpiredCreditCardNumber, 
			    										  '&cced=', creditCardExpirationHttpEncoded,
			    										   '&cco=', testObjectsFactory notExpiredCreditCardOwner).
	responseDecoded _ self decodeJsonMapFrom: response.

	client close.
	server destroy.
	
	responseExpected _ (Dictionary new) add: 'status' -> 0; yourself.
	
	self assert: (responseExpected at: 'status') equals: (responseDecoded at: 'status') .
	! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 19:48:38' prior: 50985458!
test05

	|server client cartId book response responseDecoded responseExpected creditCardExpirationHttpEncoded |
	self setUp.
	book _ testObjectsFactory itemSellByTheStore.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	cartId _ (responseDecoded at: 'cartId') asString.

	client httpGet: 'http://localhost:8080/addToCart?cartId=',cartId,'&bookIsbn=', book, '&bookQuantity=1'.
	
	creditCardExpirationHttpEncoded _ testObjectsFactory notExpiredMonthOfYear monthName,'%20',testObjectsFactory notExpiredMonthOfYear yearNumber.
	
	response _ (client httpGet: 'http://localhost:8080/checkOutCart?cartId=', cartId,
			    										    '&ccn=', testObjectsFactory notExpiredCreditCardNumber, 
			    										  '&cced=', creditCardExpirationHttpEncoded,
			    										   '&cco=', testObjectsFactory notExpiredCreditCardOwner).
	responseDecoded _ self decodeJsonMapFrom: response.

	client close.
	server destroy.
	
	responseExpected _ (Dictionary new) add: 'status' -> 0; yourself.
	
	self assert: (responseExpected at: 'status') equals: (responseDecoded at: 'status') .
	! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 19:49:14' prior: 50985503!
test05

	|server client cartId book response responseDecoded responseExpected creditCardExpirationHttpEncoded |
	self setUp.
	book _ testObjectsFactory itemSellByTheStore.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	cartId _ (responseDecoded at: 'cartId') asString.

	client httpGet: 'http://localhost:8080/addToCart?cartId=',cartId,'&bookIsbn=', book, '&bookQuantity=1'.
	
	creditCardExpirationHttpEncoded _ testObjectsFactory notExpiredMonthOfYear monthName,'%20',testObjectsFactory notExpiredMonthOfYear yearNumber asString.
	
	response _ (client httpGet: 'http://localhost:8080/checkOutCart?cartId=', cartId,
			    										    '&ccn=', testObjectsFactory notExpiredCreditCardNumber, 
			    										  '&cced=', creditCardExpirationHttpEncoded,
			    										   '&cco=', testObjectsFactory notExpiredCreditCardOwner).
	responseDecoded _ self decodeJsonMapFrom: response.

	client close.
	server destroy.
	
	responseExpected _ (Dictionary new) add: 'status' -> 0; yourself.
	
	self assert: (responseExpected at: 'status') equals: (responseDecoded at: 'status') .
	! !
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 19:51:01' prior: 50985383!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user password cartId |
			user := (request fields at:'clientId').
			password := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: password.
						
			request send200Response: (self jsonResponseForCreateCart: cartId).
		 ] 
		on: Error 
		do: [ :anError |			 request send200Response: (self jsonErrorResponseBasedOn: anError).]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount asNumber of: book toCartIdentifiedAs: cartId asNumber.

			request send200Response: self jsonSuccessfulResponse.
		 ] 
		on: Error 
		do: [ :anError | request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].

	webServer addService: '/listCart' action:[:request | 
		[
			| cartId cartContents cartContentsDictionary |
			cartId := (request fields at:'cartId').	
			
			cartContents _ systemFacade listCartIdentifiedAs: cartId asNumber.
			cartContentsDictionary _ self convertToDictionary: cartContents.

			request send200Response: (self jsonResponseForListCart: cartContentsDictionary).
		 ] 
		on: Error 
		do: [ :anError |			request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].

	webServer addService: '/checkOutCart' action:[:request | 
		[
			| cartId cardNumber cardExpirationDate cardOwner|
			cartId := (request fields at:'cartId') asNumber.	
			cardNumber := (request fields at:'ccn').	
			cardExpirationDate := (request fields at:'cced') asMonth.	
			cardOwner := (request fields at:'cco').	
			
			self halt.
			
			systemFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber  ownedBy: cardOwner expiringOn: cardExpirationDate .
			
			request send200Response: (self jsonSuccessfulResponse).
		 ] 
		on: Error 
		do: [ :anError |			request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].
	webServer startListener.
! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 19:54:06' prior: 50985548!
test05

	|server client cartId book response responseDecoded responseExpected creditCardExpirationHttpEncoded |
	self setUp.
	book _ testObjectsFactory itemSellByTheStore.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	cartId _ (responseDecoded at: 'cartId') asString.

	client httpGet: 'http://localhost:8080/addToCart?cartId=',cartId,'&bookIsbn=', book, '&bookQuantity=1'.
	
	creditCardExpirationHttpEncoded _ testObjectsFactory notExpiredMonthOfYear monthName,'%20',testObjectsFactory notExpiredMonthOfYear yearNumber asString.
	
	
	response _ (client httpGet: 'http://localhost:8080/checkOutCart?cartId=', cartId,
			    										    '&ccn=', testObjectsFactory notExpiredCreditCardNumber, 
			    										  '&cced=', creditCardExpirationHttpEncoded,
			    										   '&cco=', testObjectsFactory notExpiredCreditCardOwner).
	responseDecoded _ self decodeJsonMapFrom: response.

	client close.
	server destroy.
	
	responseExpected _ (Dictionary new) add: 'status' -> 0; yourself.
	
	self assert: (responseExpected at: 'status') equals: (responseDecoded at: 'status') .
	! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'AF 11/19/2021 19:59:00' prior: 50985668!
test05

	|server client cartId book response responseDecoded responseExpected creditCardExpirationHttpEncoded creditCardOwnerHttpEncoded |
	self setUp.
	book _ testObjectsFactory itemSellByTheStore.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	cartId _ (responseDecoded at: 'cartId') asString.

	client httpGet: 'http://localhost:8080/addToCart?cartId=',cartId,'&bookIsbn=', book, '&bookQuantity=1'.
	
	creditCardExpirationHttpEncoded _ testObjectsFactory notExpiredMonthOfYear monthName,'%20',testObjectsFactory notExpiredMonthOfYear yearNumber asString.
	
	creditCardOwnerHttpEncoded _ 'Juan%20Perez'.
	
	response _ (client httpGet: 'http://localhost:8080/checkOutCart?cartId=', cartId,
			    										    '&ccn=', testObjectsFactory notExpiredCreditCardNumber, 
			    										  '&cced=', creditCardExpirationHttpEncoded,
			    										   '&cco=', creditCardOwnerHttpEncoded).
	responseDecoded _ self decodeJsonMapFrom: response.

	client close.
	server destroy.
	
	responseExpected _ (Dictionary new) add: 'status' -> 0; yourself.
	
	self assert: (responseExpected at: 'status') equals: (responseDecoded at: 'status') .
	! !

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'AF 11/19/2021 19:59:55'!
ERROR!

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'AF 11/19/2021 20:00:11'!
ERROR!

TusLibrosRestAPIInterface allInstances. 
TusLibrosRestAPIInterface allInstancesDo: [:anInstance | anInstance destroy].!
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'AF 11/19/2021 20:00:40' prior: 50985593!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user password cartId |
			user := (request fields at:'clientId').
			password := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: password.
						
			request send200Response: (self jsonResponseForCreateCart: cartId).
		 ] 
		on: Error 
		do: [ :anError |			 request send200Response: (self jsonErrorResponseBasedOn: anError).]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount asNumber of: book toCartIdentifiedAs: cartId asNumber.

			request send200Response: self jsonSuccessfulResponse.
		 ] 
		on: Error 
		do: [ :anError | request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].

	webServer addService: '/listCart' action:[:request | 
		[
			| cartId cartContents cartContentsDictionary |
			cartId := (request fields at:'cartId').	
			
			cartContents _ systemFacade listCartIdentifiedAs: cartId asNumber.
			cartContentsDictionary _ self convertToDictionary: cartContents.

			request send200Response: (self jsonResponseForListCart: cartContentsDictionary).
		 ] 
		on: Error 
		do: [ :anError |			request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].

	webServer addService: '/checkOutCart' action:[:request | 
		[
			| cartId cardNumber cardExpirationDate cardOwner|
			cartId := (request fields at:'cartId') asNumber.	
			cardNumber := (request fields at:'ccn').	
			cardExpirationDate := (request fields at:'cced') asMonth.	
			cardOwner := (request fields at:'cco').	
			
			systemFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber  ownedBy: cardOwner expiringOn: cardExpirationDate .
			
			request send200Response: (self jsonSuccessfulResponse).
		 ] 
		on: Error 
		do: [ :anError |			request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].
	webServer startListener.
! !

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'AF 11/19/2021 20:01:03'!
FAILURE!

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'AF 11/19/2021 20:01:03'!
FAILURE!
!TusLibrosRestAPIInterfaceTest methodsFor: 'setup' stamp: 'AF 11/19/2021 20:02:30'!
debit: anAmount from: aCreditCard
! !

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'AF 11/19/2021 20:02:38'!
PASSED!

----SNAPSHOT----(19 November 2021 20:02:45) CuisUniversity-4972.image priorSource: 20912034!

----SNAPSHOT----(19 November 2021 20:02:52) CuisUniversity-4972.image priorSource: 20934592!

----SNAPSHOT----(19 November 2021 20:03:36) CuisUniversity-4972.image priorSource: 20934686!

----STARTUP---- (20 November 2021 15:42:12) as D:\001.Maca\2c2021\inge1\qa3\CuisUniversity-4972.image!


----End fileIn of D:\001.Maca\2c2021\inge1\qa3\TusLibros-Model.st----!

----End fileIn of D:\001.Maca\2c2021\inge1\qa3\TusLibros-Tests.st----!

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'MP 11/20/2021 15:44:59'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'MP 11/20/2021 15:44:59'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'MP 11/20/2021 15:44:59'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'MP 11/20/2021 15:44:59'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test04 stamp: 'MP 11/20/2021 15:44:59'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'MP 11/20/2021 15:44:59'!
PASSED!

TusLibrosRestAPIInterface allInstances.!

TusLibrosRestAPIInterface do: [:instance | instance destroy].!

TusLibrosRestAPIInterface allInstances do: [:instance | instance destroy].!

----SNAPSHOT----(20 November 2021 15:45:41) CuisUniversity-4972.image priorSource: 21019572!

|x| !

|x| 
x _ WriteStream on: OrderedCollection new.
'Nov 2021' do: [:a | a = ' ' ifTrue: [x nextPutAll: '%20'] ifFalse: [x nextPutAll: a]].
!

'Nov 2021' do: [:a | a = ' ' ifTrue: [x nextPutAll: '%20'] ifFalse: [x nextPut: a]].!

sep _ Character space!

'Nov 2021' do: [:a | a = sep ifTrue: [x nextPutAll: '%20'] ifFalse: [x nextPut: a]].!

|x sep| 
sep _ Character space.
x _ WriteStream on: OrderedCollection new.
'Nov 2021' do: [:a | a = sep ifTrue: [x nextPutAll: '%20'] ifFalse: [x nextPut: a]].
!

'Nov 2021' do: [:a | a = sep ifTrue: [x nextPutAll: '%20'] ifFalse: [x nextPut: a]].!

|x sep| 
sep _ Character space.
x _ WriteStream on: OrderedCollection new.
'Nov 2021' do: [:a | a = sep ifTrue: [x nextPutAll: '%20'] ifFalse: [x nextPut: a]].
x.!

|x sep| 
sep _ Character space.
x _ WriteStream on: OrderedCollection new.
'Nov 2021' do: [:a | a = sep ifTrue: [x nextPutAll: '%20'] ifFalse: [x nextPut: a]].
x asString.!

x _ WriteStream on: OrderedCollection new.!

x print: String.!

x contents.!

|x sep| 
sep _ Character space.
x _ WriteStream on: OrderedCollection new.
'Nov 2021' do: [:a | a = sep ifTrue: [x nextPutAll: '%20'] ifFalse: [x nextPut: a]].
x contents.!

x print.!

String streamContents: x.!

String streamContents: [x].!

x originalContents.!

|x sep| 
sep _ Character space.
x _ WriteStream on: OrderedCollection new.
'Nov 2021' do: [:a | a = sep ifTrue: [x nextPutAll: '%20'] ifFalse: [x nextPut: a]].
x originalContents.!

x contents.!
!TusLibrosRestAPIInterfaceTest methodsFor: 'nil' stamp: 'MP 11/20/2021 16:10:06'!
correctlyEncodeSpacesForUrlRequestParameter: aParameter
	
	^ aParameter copyReplaceAll: ' ' with: '%20'. ! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 16:10:28'!
encodeSpacesForUrl: aParameter
	
	^ aParameter copyReplaceAll: ' ' with: '%20'. ! !

!methodRemoval: TusLibrosRestAPIInterfaceTest #correctlyEncodeSpacesForUrlRequestParameter: stamp: 'MP 11/20/2021 16:11:16'!
correctlyEncodeSpacesForUrlRequestParameter: aParameter
	
	^ aParameter copyReplaceAll: ' ' with: '%20'. !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'MP 11/20/2021 16:15:05' prior: 50989899!
test05

	|server client cartId book response responseDecoded responseExpected creditCardExpirationHttpEncoded creditCardOwnerHttpEncoded |
	self setUp.
	book _ testObjectsFactory itemSellByTheStore.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	cartId _ (responseDecoded at: 'cartId') asString.

	client httpGet: 'http://localhost:8080/addToCart?cartId=',cartId,'&bookIsbn=', book, '&bookQuantity=1'.
	
	creditCardExpirationHttpEncoded _ self encodeSpacesForUrl: testObjectsFactory notExpiredMonthOfYear asString. 
	
	creditCardOwnerHttpEncoded _ self encodeSpacesForUrl: testObjectsFactory notExpiredCreditCardOwner.
	
	response _ (client httpGet: 'http://localhost:8080/checkOutCart?cartId=', cartId,
			    										    '&ccn=', testObjectsFactory notExpiredCreditCardNumber, 
			    										  '&cced=', creditCardExpirationHttpEncoded,
			    										   '&cco=', creditCardOwnerHttpEncoded).
	responseDecoded _ self decodeJsonMapFrom: response.

	client close.
	server destroy.
	
	responseExpected _ (Dictionary new) add: 'status' -> 0; yourself.
	
	self assert: (responseExpected at: 'status') equals: (responseDecoded at: 'status') .
	! !

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'MP 11/20/2021 16:15:33'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'MP 11/20/2021 16:15:33'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'MP 11/20/2021 16:15:33'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'MP 11/20/2021 16:15:33'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test04 stamp: 'MP 11/20/2021 16:15:34'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'MP 11/20/2021 16:15:34'!
PASSED!

----SNAPSHOT----(20 November 2021 16:15:37) CuisUniversity-4972.image priorSource: 21085111!
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'MP 11/20/2021 16:16:41'!
test06listPurhcases

	|server client cartId book response responseDecoded responseExpected creditCardExpirationHttpEncoded creditCardOwnerHttpEncoded |
	self setUp.
	book _ testObjectsFactory itemSellByTheStore.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	cartId _ (responseDecoded at: 'cartId') asString.

	client httpGet: 'http://localhost:8080/addToCart?cartId=',cartId,'&bookIsbn=', book, '&bookQuantity=1'.
	
	creditCardExpirationHttpEncoded _ self encodeSpacesForUrl: testObjectsFactory notExpiredMonthOfYear asString. 
	
	creditCardOwnerHttpEncoded _ self encodeSpacesForUrl: testObjectsFactory notExpiredCreditCardOwner.
	
	response _ (client httpGet: 'http://localhost:8080/checkOutCart?cartId=', cartId,
			    										    '&ccn=', testObjectsFactory notExpiredCreditCardNumber, 
			    										  '&cced=', creditCardExpirationHttpEncoded,
			    										   '&cco=', creditCardOwnerHttpEncoded).
	responseDecoded _ self decodeJsonMapFrom: response.

	client close.
	server destroy.
	
	responseExpected _ (Dictionary new) add: 'status' -> 0; yourself.
	
	self assert: (responseExpected at: 'status') equals: (responseDecoded at: 'status') .
	! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'MP 11/20/2021 16:18:49' prior: 50990700!
test06listPurhcases

	|server client cartId book response responseDecoded responseExpected creditCardExpirationHttpEncoded creditCardOwnerHttpEncoded |
	self setUp.
	book _ testObjectsFactory itemSellByTheStore.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	cartId _ (responseDecoded at: 'cartId') asString.

	client httpGet: 'http://localhost:8080/addToCart?cartId=',cartId,'&bookIsbn=', book, '&bookQuantity=1'.
	
	creditCardExpirationHttpEncoded _ self encodeSpacesForUrl: testObjectsFactory notExpiredMonthOfYear asString. 
	
	creditCardOwnerHttpEncoded _ self encodeSpacesForUrl: testObjectsFactory notExpiredCreditCardOwner.
	
	client httpGet: 'http://localhost:8080/checkOutCart?cartId=', cartId,
			    										    '&ccn=', testObjectsFactory notExpiredCreditCardNumber, 
			    										  '&cced=', creditCardExpirationHttpEncoded,
			    										   '&cco=', creditCardOwnerHttpEncoded.
	responseDecoded _ self decodeJsonMapFrom: response.

	response _ (client httpGet: 'http://localhost:8080/listPurchases?clientId=',self validUser,'&password=',self validUserPassword ).

	client close.
	server destroy.
	
	! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'MP 11/20/2021 16:19:12' prior: 50990748!
test06listPurhcases

	|server client cartId book response responseDecoded responseExpected creditCardExpirationHttpEncoded creditCardOwnerHttpEncoded |
	self setUp.
	book _ testObjectsFactory itemSellByTheStore.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	cartId _ (responseDecoded at: 'cartId') asString.

	client httpGet: 'http://localhost:8080/addToCart?cartId=',cartId,'&bookIsbn=', book, '&bookQuantity=1'.
	
	creditCardExpirationHttpEncoded _ self encodeSpacesForUrl: testObjectsFactory notExpiredMonthOfYear asString. 
	
	creditCardOwnerHttpEncoded _ self encodeSpacesForUrl: testObjectsFactory notExpiredCreditCardOwner.
	
	client httpGet: 'http://localhost:8080/checkOutCart?cartId=', cartId,
			    										    '&ccn=', testObjectsFactory notExpiredCreditCardNumber, 
			    										  '&cced=', creditCardExpirationHttpEncoded,
			    										   '&cco=', creditCardOwnerHttpEncoded.
	responseDecoded _ self decodeJsonMapFrom: response.

	response _ (client httpGet: 'http://localhost:8080/listPurchases?clientId=',self validUser,'&password=',self validUserPassword ).

	client close.
	server destroy.
	
	responseExpected _ 'u'.! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'MP 11/20/2021 16:26:57' prior: 50990795!
test06listPurhcases

	|server client cartId book response responseDecoded responseExpected creditCardExpirationHttpEncoded creditCardOwnerHttpEncoded |
	self setUp.
	book _ testObjectsFactory itemSellByTheStore.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	cartId _ (responseDecoded at: 'cartId') asString.

	client httpGet: 'http://localhost:8080/addToCart?cartId=',cartId,'&bookIsbn=', book, '&bookQuantity=1'.
	
	creditCardExpirationHttpEncoded _ self encodeSpacesForUrl: testObjectsFactory notExpiredMonthOfYear asString. 
	
	creditCardOwnerHttpEncoded _ self encodeSpacesForUrl: testObjectsFactory notExpiredCreditCardOwner.
	
	client httpGet: 'http://localhost:8080/checkOutCart?cartId=', cartId,
			    										    '&ccn=', testObjectsFactory notExpiredCreditCardNumber, 
			    										  '&cced=', creditCardExpirationHttpEncoded,
			    										   '&cco=', creditCardOwnerHttpEncoded.
	responseDecoded _ self decodeJsonMapFrom: response.

	response _ (client httpGet: 'http://localhost:8080/listPurchases?clientId=',self validUser,'&password=',self validUserPassword ).

	client close.
	server destroy.
	
	self assert: (testObjectsFactory itemSellByTheStorePrice ) equals: (response)! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'MP 11/20/2021 16:27:26' prior: 50990842!
test06listPurhcases

	|server client cartId book response responseDecoded creditCardExpirationHttpEncoded creditCardOwnerHttpEncoded |
	self setUp.
	book _ testObjectsFactory itemSellByTheStore.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	cartId _ (responseDecoded at: 'cartId') asString.

	client httpGet: 'http://localhost:8080/addToCart?cartId=',cartId,'&bookIsbn=', book, '&bookQuantity=1'.
	
	creditCardExpirationHttpEncoded _ self encodeSpacesForUrl: testObjectsFactory notExpiredMonthOfYear asString. 
	
	creditCardOwnerHttpEncoded _ self encodeSpacesForUrl: testObjectsFactory notExpiredCreditCardOwner.
	
	client httpGet: 'http://localhost:8080/checkOutCart?cartId=', cartId,
			    										    '&ccn=', testObjectsFactory notExpiredCreditCardNumber, 
			    										  '&cced=', creditCardExpirationHttpEncoded,
			    										   '&cco=', creditCardOwnerHttpEncoded.
	responseDecoded _ self decodeJsonMapFrom: response.

	response _ (client httpGet: 'http://localhost:8080/listPurchases?clientId=',self validUser,'&password=',self validUserPassword ).

	client close.
	server destroy.
	
	self assert: (testObjectsFactory itemSellByTheStorePrice ) equals: (responseDecoded)! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'MP 11/20/2021 16:27:42' prior: 50990891!
test06listPurhcases

	|server client cartId book response responseDecoded creditCardExpirationHttpEncoded creditCardOwnerHttpEncoded |
	self setUp.
	book _ testObjectsFactory itemSellByTheStore.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	cartId _ (responseDecoded at: 'cartId') asString.

	client httpGet: 'http://localhost:8080/addToCart?cartId=',cartId,'&bookIsbn=', book, '&bookQuantity=1'.
	
	creditCardExpirationHttpEncoded _ self encodeSpacesForUrl: testObjectsFactory notExpiredMonthOfYear asString. 
	
	creditCardOwnerHttpEncoded _ self encodeSpacesForUrl: testObjectsFactory notExpiredCreditCardOwner.
	
	client httpGet: 'http://localhost:8080/checkOutCart?cartId=', cartId,
			    										    '&ccn=', testObjectsFactory notExpiredCreditCardNumber, 
			    										  '&cced=', creditCardExpirationHttpEncoded,
			    										   '&cco=', creditCardOwnerHttpEncoded.
	responseDecoded _ self decodeJsonMapFrom: response.

	response _ (client httpGet: 'http://localhost:8080/listPurchases?clientId=',self validUser,'&password=',self validUserPassword ).

	client close.
	server destroy.
	
	self assert: (testObjectsFactory itemSellByTheStorePrice ) equals: (responseDecoded at: self validBook)! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'MP 11/20/2021 16:27:57' prior: 50990940!
test06listPurhcases

	|server client cartId book response responseDecoded creditCardExpirationHttpEncoded creditCardOwnerHttpEncoded |
	self setUp.
	book _ testObjectsFactory itemSellByTheStore.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	cartId _ (responseDecoded at: 'cartId') asString.

	client httpGet: 'http://localhost:8080/addToCart?cartId=',cartId,'&bookIsbn=', book, '&bookQuantity=1'.
	
	creditCardExpirationHttpEncoded _ self encodeSpacesForUrl: testObjectsFactory notExpiredMonthOfYear asString. 
	
	creditCardOwnerHttpEncoded _ self encodeSpacesForUrl: testObjectsFactory notExpiredCreditCardOwner.
	
	client httpGet: 'http://localhost:8080/checkOutCart?cartId=', cartId,
			    										    '&ccn=', testObjectsFactory notExpiredCreditCardNumber, 
			    										  '&cced=', creditCardExpirationHttpEncoded,
			    										   '&cco=', creditCardOwnerHttpEncoded.
	responseDecoded _ self decodeJsonMapFrom: response.

	response _ (client httpGet: 'http://localhost:8080/listPurchases?clientId=',self validUser,'&password=',self validUserPassword ).

	client close.
	server destroy.
	
	self assert: (testObjectsFactory itemSellByTheStorePrice ) equals: (responseDecoded at: book)! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'MP 11/20/2021 16:30:52' prior: 50990989!
test06listPurhcases

	|server client cartId book response responseDecoded creditCardExpirationHttpEncoded creditCardOwnerHttpEncoded |
	self setUp.
	book _ testObjectsFactory itemSellByTheStore.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	cartId _ (responseDecoded at: 'cartId') asString.

	client httpGet: 'http://localhost:8080/addToCart?cartId=',cartId,'&bookIsbn=', book, '&bookQuantity=2'.
	
	creditCardExpirationHttpEncoded _ self encodeSpacesForUrl: testObjectsFactory notExpiredMonthOfYear asString. 
	
	creditCardOwnerHttpEncoded _ self encodeSpacesForUrl: testObjectsFactory notExpiredCreditCardOwner.
	
	client httpGet: 'http://localhost:8080/checkOutCart?cartId=', cartId,
			    										    '&ccn=', testObjectsFactory notExpiredCreditCardNumber, 
			    										  '&cced=', creditCardExpirationHttpEncoded,
			    										   '&cco=', creditCardOwnerHttpEncoded.
	responseDecoded _ self decodeJsonMapFrom: response.

	response _ (client httpGet: 'http://localhost:8080/listPurchases?clientId=',self validUser,'&password=',self validUserPassword ).

	client close.
	server destroy.
	
	self assert: (testObjectsFactory itemSellByTheStorePrice * 2) equals: (responseDecoded at: book)! !

!testRun: #TusLibrosRestAPIInterfaceTest #test06listPurhcases stamp: 'MP 11/20/2021 16:30:53'!
ERROR!

!testRun: #TusLibrosRestAPIInterfaceTest #test06listPurhcases stamp: 'MP 11/20/2021 16:31:20'!
FAILURE!
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'MP 11/20/2021 16:32:06' prior: 50991038!
test06listPurhcases

	|server client cartId book response responseDecoded creditCardExpirationHttpEncoded creditCardOwnerHttpEncoded |
	self setUp.
	book _ testObjectsFactory itemSellByTheStore.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	cartId _ (responseDecoded at: 'cartId') asString.

	client httpGet: 'http://localhost:8080/addToCart?cartId=',cartId,'&bookIsbn=', book, '&bookQuantity=2'.
	
	creditCardExpirationHttpEncoded _ self encodeSpacesForUrl: testObjectsFactory notExpiredMonthOfYear asString. 
	
	creditCardOwnerHttpEncoded _ self encodeSpacesForUrl: testObjectsFactory notExpiredCreditCardOwner.
	
	client httpGet: 'http://localhost:8080/checkOutCart?cartId=', cartId,
			    										    '&ccn=', testObjectsFactory notExpiredCreditCardNumber, 
			    										  '&cced=', creditCardExpirationHttpEncoded,
			    										   '&cco=', creditCardOwnerHttpEncoded.
	responseDecoded _ self decodeJsonMapFrom: response.

	response _ (client httpGet: 'http://localhost:8080/listPurchases?clientId=',self validUser,'&password=',self validUserPassword ).

	client close.
	server destroy.
	
	self assert: (testObjectsFactory itemSellByTheStorePrice * 2) equals: ((responseDecoded at: 'list') at: book)! !

!testRun: #TusLibrosRestAPIInterfaceTest #test06listPurhcases stamp: 'MP 11/20/2021 16:32:07'!
ERROR!

TusLibrosRestAPIInterface allInstances do: [:instance | instance destroy].!
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'MP 11/20/2021 16:34:16' prior: 50989082!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user password cartId |
			user := (request fields at:'clientId').
			password := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: password.
						
			request send200Response: (self jsonResponseForCreateCart: cartId).
		 ] 
		on: Error 
		do: [ :anError |			 request send200Response: (self jsonErrorResponseBasedOn: anError).]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount asNumber of: book toCartIdentifiedAs: cartId asNumber.

			request send200Response: self jsonSuccessfulResponse.
		 ] 
		on: Error 
		do: [ :anError | request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].

	webServer addService: '/listCart' action:[:request | 
		[
			| cartId cartContents cartContentsDictionary |
			cartId := (request fields at:'cartId').	
			
			cartContents _ systemFacade listCartIdentifiedAs: cartId asNumber.
			cartContentsDictionary _ self convertToDictionary: cartContents.

			request send200Response: (self jsonResponseForListCart: cartContentsDictionary).
		 ] 
		on: Error 
		do: [ :anError |			request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].

	webServer addService: '/checkOutCart' action:[:request | 
		[
			| cartId cardNumber cardExpirationDate cardOwner|
			cartId := (request fields at:'cartId') asNumber.	
			cardNumber := (request fields at:'ccn').	
			cardExpirationDate := (request fields at:'cced') asMonth.	
			cardOwner := (request fields at:'cco').	
			
			systemFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber  ownedBy: cardOwner expiringOn: cardExpirationDate .
			
			request send200Response: (self jsonSuccessfulResponse).
		 ] 
		on: Error 
		do: [ :anError |			request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].
	
	webServer addService: '/listPurchases' action:[:request | 
		[
			| user password list |
			user := (request fields at:'clientId').
			password := (request fields at:'password').
				
			list := systemFacade listPurchasesOf: user authenticatingWith: password.
						
			request send200Response: (self jsonResponseForListPurchases: list).
		 ] 
		on: Error 
		do: [ :anError |			 request send200Response: (self jsonErrorResponseBasedOn: anError).]
	].

	webServer startListener.
! !
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'MP 11/20/2021 16:34:50' prior: 50991149!
initializeWith: aPortNumber and: aSystemFacade    
	
	port := aPortNumber.
	systemFacade := aSystemFacade.
	
	webServer := WebServer new listenOn: port.
	
	webServer addService: '/createCart' action:[:request | 
		[
			| user password cartId |
			user := (request fields at:'clientId').
			password := (request fields at:'password').
				
			cartId := systemFacade createCartFor: user authenticatedWith: password.
						
			request send200Response: (self jsonResponseForCreateCart: cartId).
		 ] 
		on: Error 
		do: [ :anError |			 request send200Response: (self jsonErrorResponseBasedOn: anError).]
	].
	
	webServer addService: '/addToCart' action:[:request | 
		[
			| book bookAmount cartId |
			cartId := (request fields at:'cartId').
			book := (request fields at:'bookIsbn').
			bookAmount := (request fields at:'bookQuantity').		
			
			systemFacade add: bookAmount asNumber of: book toCartIdentifiedAs: cartId asNumber.

			request send200Response: self jsonSuccessfulResponse.
		 ] 
		on: Error 
		do: [ :anError | request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].

	webServer addService: '/listCart' action:[:request | 
		[
			| cartId cartContents cartContentsDictionary |
			cartId := (request fields at:'cartId').	
			
			cartContents _ systemFacade listCartIdentifiedAs: cartId asNumber.
			cartContentsDictionary _ self convertToDictionary: cartContents.

			request send200Response: (self jsonResponseForListCart: cartContentsDictionary).
		 ] 
		on: Error 
		do: [ :anError |			request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].

	webServer addService: '/checkOutCart' action:[:request | 
		[
			| cartId cardNumber cardExpirationDate cardOwner|
			cartId := (request fields at:'cartId') asNumber.	
			cardNumber := (request fields at:'ccn').	
			cardExpirationDate := (request fields at:'cced') asMonth.	
			cardOwner := (request fields at:'cco').	
			
			systemFacade checkOutCartIdentifiedAs: cartId withCreditCardNumbered: cardNumber  ownedBy: cardOwner expiringOn: cardExpirationDate .
			
			request send200Response: (self jsonSuccessfulResponse).
		 ] 
		on: Error 
		do: [ :anError |			request send200Response: (self jsonErrorResponseBasedOn: anError) .		]
	].
	
	webServer addService: '/listPurchases' action:[:request | 
		[
			| user password list |
			user := (request fields at:'clientId').
			password := (request fields at:'password').
				
			list := systemFacade listPurchasesOf: user authenticatingWith: password.
						
			request send200Response: (self jsonResponseForListPurchases: list).
		 ] 
		on: Error 
		do: [ :anError |			 request send200Response: (self jsonErrorResponseBasedOn: anError).]
	].

	webServer startListener.
! !
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'MP 11/20/2021 16:35:22'!
jsonResponseForListPurchases: purchasesDictionary

	^ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 0; add: 'list' -> purchasesDictionary ; yourself)! !
!TusLibrosRestAPIInterface methodsFor: 'initialization' stamp: 'MP 11/20/2021 16:35:48' prior: 50991326!
jsonResponseForListPurchases: purchasesDictionary

	^ WebUtils jsonEncode: ((Dictionary new) add: 'status' -> 0; add: 'purchases' -> purchasesDictionary ; yourself)! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'MP 11/20/2021 16:35:52' prior: 50991094!
test06listPurhcases

	|server client cartId book response responseDecoded creditCardExpirationHttpEncoded creditCardOwnerHttpEncoded |
	self setUp.
	book _ testObjectsFactory itemSellByTheStore.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	cartId _ (responseDecoded at: 'cartId') asString.

	client httpGet: 'http://localhost:8080/addToCart?cartId=',cartId,'&bookIsbn=', book, '&bookQuantity=2'.
	
	creditCardExpirationHttpEncoded _ self encodeSpacesForUrl: testObjectsFactory notExpiredMonthOfYear asString. 
	
	creditCardOwnerHttpEncoded _ self encodeSpacesForUrl: testObjectsFactory notExpiredCreditCardOwner.
	
	client httpGet: 'http://localhost:8080/checkOutCart?cartId=', cartId,
			    										    '&ccn=', testObjectsFactory notExpiredCreditCardNumber, 
			    										  '&cced=', creditCardExpirationHttpEncoded,
			    										   '&cco=', creditCardOwnerHttpEncoded.
	responseDecoded _ self decodeJsonMapFrom: response.

	response _ (client httpGet: 'http://localhost:8080/listPurchases?clientId=',self validUser,'&password=',self validUserPassword ).

	client close.
	server destroy.
	
	self assert: (testObjectsFactory itemSellByTheStorePrice * 2) equals: ((responseDecoded at: 'purchases') at: book)! !

!testRun: #TusLibrosRestAPIInterfaceTest #test06listPurhcases stamp: 'MP 11/20/2021 16:36:00'!
ERROR!

TusLibrosRestAPIInterface allInstances do: [:instance | instance destroy].!

----SNAPSHOT----(20 November 2021 16:44:48) CuisUniversity-4972.image priorSource: 21089463!

TusLibrosRestAPIInterface allInstances do: [:instance | instance destroy].!

!testRun: #TusLibrosRestAPIInterfaceTest #test06listPurhcases stamp: 'MP 11/20/2021 16:44:56'!
ERROR!
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'MP 11/20/2021 16:45:36' prior: 50991344!
test06listPurhcases

	|server client cartId book response responseDecoded creditCardExpirationHttpEncoded creditCardOwnerHttpEncoded |
	self setUp.
	book _ testObjectsFactory itemSellByTheStore.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self validUserPassword ).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	cartId _ (responseDecoded at: 'cartId') asString.

	client httpGet: 'http://localhost:8080/addToCart?cartId=',cartId,'&bookIsbn=', book, '&bookQuantity=2'.
	
	creditCardExpirationHttpEncoded _ self encodeSpacesForUrl: testObjectsFactory notExpiredMonthOfYear asString. 
	
	creditCardOwnerHttpEncoded _ self encodeSpacesForUrl: testObjectsFactory notExpiredCreditCardOwner.
	
	client httpGet: 'http://localhost:8080/checkOutCart?cartId=', cartId,
			    										    '&ccn=', testObjectsFactory notExpiredCreditCardNumber, 
			    										  '&cced=', creditCardExpirationHttpEncoded,
			    										   '&cco=', creditCardOwnerHttpEncoded.

	response _ (client httpGet: 'http://localhost:8080/listPurchases?clientId=',self validUser,'&password=',self validUserPassword ).

	responseDecoded _ self decodeJsonMapFrom: response.

	client close.
	server destroy.
	
	self assert: (testObjectsFactory itemSellByTheStorePrice * 2) equals: ((responseDecoded at: 'purchases') at: book)! !

TusLibrosRestAPIInterface allInstances.!

TusLibrosRestAPIInterface allInstances do: [:instance | instance destroy].!

----SNAPSHOT----(20 November 2021 16:45:52) CuisUniversity-4972.image priorSource: 21111926!

!testRun: #TusLibrosRestAPIInterfaceTest #test06listPurhcases stamp: 'MP 11/20/2021 16:45:54'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'MP 11/20/2021 16:45:54'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'MP 11/20/2021 16:45:54'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'MP 11/20/2021 16:45:54'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test04 stamp: 'MP 11/20/2021 16:45:55'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'MP 11/20/2021 16:45:55'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test06listPurhcases stamp: 'MP 11/20/2021 16:45:55'!
PASSED!

----SNAPSHOT----(20 November 2021 16:47:16) CuisUniversity-4972.image priorSource: 21113914!

|server|
server _ StringsServicesRestInterface listeningOn: 8080.
WordsClientWindow open.!

server destroy.!

TusLibrosRestAPIInterface allInstances do: [:instance | instance destroy].!

StringsServicesRestInterface allInstances do: [:i | i destroy]!

Object subclass: #LoginWindow
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Graphics'!

!classDefinition: #LoginWindow category: 'TusLibros-Graphics' stamp: 'MP 11/20/2021 17:03:07'!
Object subclass: #LoginWindow
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Graphics'!
!WordsClientWindow methodsFor: 'GUI building' stamp: 'MP 11/20/2021 17:07:23' prior: 50970977!
build1stColumn2ndRow
	| firstColumnLayoutMorphOfSecondRow |
	
	wordsListMorph := PluggableListMorph model: self model listGetter: #words indexGetter: #wordsListIndex indexSetter: #wordsListIndex:.
	wordsListMorph  borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.
		
	firstColumnLayoutMorphOfSecondRow := LayoutMorph newColumn.
	firstColumnLayoutMorphOfSecondRow separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Results');
	addMorph: wordsListMorph.
	
	"Dos opciones para jugar con los layouts... Qu diferencia hay?"
	firstColumnLayoutMorphOfSecondRow layoutSpec fixedWidth: 390.
	"wordsListMorph layoutSpec proportionalWidth: 1.
	wordsListMorph layoutSpec proportionalHeight: 1."
		
	^firstColumnLayoutMorphOfSecondRow.
	! !

|server|
server _ StringsServicesRestInterface listeningOn: 8080.
WordsClientWindow open.!

server destroy.!

StringsServicesRestInterface allInstances do: [:i | i destroy]!
!LoginWindow class methodsFor: 'nil' stamp: 'MP 11/20/2021 17:34:15'!
open
	
	^self new initializeWith: 'TusLibros login window'.! !

Panel subclass: #LoginWindow
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Graphics'!

!classDefinition: #LoginWindow category: 'TusLibros-Graphics' stamp: 'MP 11/20/2021 17:35:09'!
Panel subclass: #LoginWindow
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Graphics'!

Object subclass: #LoginWindowModel
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Graphics'!

!classDefinition: #LoginWindowModel category: 'TusLibros-Graphics' stamp: 'MP 11/20/2021 17:35:47'!
Object subclass: #LoginWindowModel
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Graphics'!
!LoginWindow methodsFor: 'nil' stamp: 'MP 11/20/2021 17:38:47'!
initializeWith: aTitle

	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aTitle.
	self model: (LoginWindowModel new).
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
			
	self model when: #loginButtonPressed send: #authenticate to: self.
	
	"Investigar:
	self model when: #newWordsArrived send: #refreshListOfWords:and: to: self."! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 17:39:07' overrides: 50929028!
defaultExtent

	^ 1035@485
	! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 17:39:52' overrides: 50928932!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 15;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow;
	addMorph: self build4rdRow.! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'MP 11/20/2021 17:45:40'!
startTestServerAndGraphicInterface

	|server client cartId |
	self setUp.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	LoginWindow open.! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'MP 11/20/2021 17:45:59' prior: 50991600!
startTestServerAndGraphicInterface

	|server|
	self setUp.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	LoginWindow open.! !

!classDefinition: #LoginWindow category: 'TusLibros-Graphics' stamp: 'MP 11/20/2021 17:50:43'!
Panel subclass: #LoginWindow
	instanceVariableNames: 'userTextBoxMorph'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Graphics'!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 17:50:38'!
build1stRow
	| firstRowLayoutMorph |
	
	userTextBoxMorph := TextModelMorph textProvider: self model textGetter: #username textSetter: #username:. 
	userTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | userTextBoxMorph innerTextMorph acceptContents ] .
	userTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Username:');
	addMorph: userTextBoxMorph.
	
	^firstRowLayoutMorph.! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 17:51:04' prior: 50991590 overrides: 50928932!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 15;
	axisEdgeWeight: 0;
	addMorph: self build1stRow.
	"addMorph: self build2ndRow;
	addMorph: self build3rdRow;
	addMorph: self build4rdRow."! !

!classDefinition: #LoginWindowModel category: 'TusLibros-Graphics' stamp: 'MP 11/20/2021 17:51:55'!
Object subclass: #LoginWindowModel
	instanceVariableNames: 'username'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Graphics'!
!LoginWindowModel methodsFor: 'nil' stamp: 'MP 11/20/2021 17:51:54'!
username
	^ username.
	! !
!LoginWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 17:52:27'!
username: aUsername
	username _ aUsername.
	^ true.
	! !

!classDefinition: #LoginWindowModel category: 'TusLibros-Graphics' stamp: 'MP 11/20/2021 17:53:40'!
Object subclass: #LoginWindowModel
	instanceVariableNames: 'username password'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Graphics'!
!LoginWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 17:53:35' overrides: 16896425!
initialize

	username := ''.
	password := '' "Dont do this at home kids".! !

LoginWindow open.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 17:54:35' prior: 50991625!
build1stRow
	| firstRowLayoutMorph |
	
	userTextBoxMorph := TextModelMorph textProvider: self model textGetter: #username textSetter: #username:. 
	userTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | userTextBoxMorph innerTextMorph acceptContents ] .
	userTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 100. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Username:');
	addMorph: userTextBoxMorph.
	
	^firstRowLayoutMorph.! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 17:55:06' prior: 50991689!
build1stRow
	| firstRowLayoutMorph |
	
	userTextBoxMorph := TextModelMorph textProvider: self model textGetter: #username textSetter: #username:. 
	userTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | userTextBoxMorph innerTextMorph acceptContents ] .
	userTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 100 ; morphHeight: 20. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Username:');
	addMorph: userTextBoxMorph.
	
	^firstRowLayoutMorph.! !

LoginWindow open.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 17:55:19' prior: 50991710!
build1stRow
	| firstRowLayoutMorph |
	
	userTextBoxMorph := TextModelMorph textProvider: self model textGetter: #username textSetter: #username:. 
	userTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | userTextBoxMorph innerTextMorph acceptContents ] .
	userTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 150 ; morphHeight: 20. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Username:');
	addMorph: userTextBoxMorph.
	
	^firstRowLayoutMorph.! !

LoginWindow open. !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 17:55:29' prior: 50991732!
build1stRow
	| firstRowLayoutMorph |
	
	userTextBoxMorph := TextModelMorph textProvider: self model textGetter: #username textSetter: #username:. 
	userTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | userTextBoxMorph innerTextMorph acceptContents ] .
	userTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 200 ; morphHeight: 20. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Username:');
	addMorph: userTextBoxMorph.
	
	^firstRowLayoutMorph.! !

LoginWindow open.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 17:56:14'!
build2ndRow
	| firstRowLayoutMorph |
	
	userTextBoxMorph := TextModelMorph textProvider: self model textGetter: #password textSetter: #password:. 
	userTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | userTextBoxMorph innerTextMorph acceptContents ] .
	userTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 200 ; morphHeight: 20. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Password:');
	addMorph: userTextBoxMorph.
	
	^firstRowLayoutMorph.! !

!classDefinition: #LoginWindow category: 'TusLibros-Graphics' stamp: 'MP 11/20/2021 17:56:29'!
Panel subclass: #LoginWindow
	instanceVariableNames: 'userTextBoxMorph passwordTextBoxMorph'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Graphics'!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 17:56:28' prior: 50991776!
build2ndRow
	| firstRowLayoutMorph |
	
	passwordTextBoxMorph := TextModelMorph textProvider: self model textGetter: #password textSetter: #password:. 
	userTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | userTextBoxMorph innerTextMorph acceptContents ] .
	userTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 200 ; morphHeight: 20. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Password:');
	addMorph: userTextBoxMorph.
	
	^firstRowLayoutMorph.! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 17:56:36' prior: 50991806!
build2ndRow
	| firstRowLayoutMorph |
	
	passwordTextBoxMorph := TextModelMorph textProvider: self model textGetter: #password textSetter: #password:. 
	passwordTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | passwordTextBoxMorph innerTextMorph acceptContents ] .
	passwordTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 200 ; morphHeight: 20. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Password:');
	addMorph: passwordTextBoxMorph.
	
	^firstRowLayoutMorph.! !
!LoginWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 17:56:49'!
password
	^ password.
	! !
!LoginWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 17:57:15'!
password: aPassword
	password _ aPassword.
	^ true.
	! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 17:58:00' prior: 50991647 overrides: 50928932!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 15;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow.
	"addMorph: self build3rdRow;
	addMorph: self build4rdRow."! !

LoginWindow open.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:00:05'!
build3rdRow
	| sendRequestButtonMorph thirdRowLayoutMorph |
	
	sendRequestButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #authenticate  label: 'login'.
	
	thirdRowLayoutMorph := LayoutMorph newRow.
	thirdRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
 	addMorph: sendRequestButtonMorph.
	
	^thirdRowLayoutMorph.! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:00:13' prior: 50991828!
build2ndRow
	| secondRowLayoutMorph |
	
	passwordTextBoxMorph := TextModelMorph textProvider: self model textGetter: #password textSetter: #password:. 
	passwordTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | passwordTextBoxMorph innerTextMorph acceptContents ] .
	passwordTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 200 ; morphHeight: 20. 
		
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Password:');
	addMorph: passwordTextBoxMorph.
	
	^secondRowLayoutMorph.! !

!classDefinition: #LoginWindowModel category: 'TusLibros-Graphics' stamp: 'MP 11/20/2021 18:02:38'!
Object subclass: #LoginWindowModel
	instanceVariableNames: 'username password response'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Graphics'!
!LoginWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:02:37'!
authenticate
	|client|
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self username,'&password=',self password ).
	client close.! !
!LoginWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:02:58'!
response
	^ response.
	! !
!LoginWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:03:31' prior: 50991915!
authenticate
	|client|
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self username,'&password=',self password ).
	client close.
	
	self triggerEvent: #hola! !
!LoginWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:04:56' prior: 50991928!
authenticate
	|client|
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self username,'&password=',self password ).
	client close.
	
	self triggerEvent: #authenticationResponse! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:05:19' prior: 50991569!
initializeWith: aTitle

	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aTitle.
	self model: (LoginWindowModel new).
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
			
	self model when: #authenticationResponse send: #login to: self.
	
	"Investigar:
	self model when: #newWordsArrived send: #refreshListOfWords:and: to: self."! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:05:39'!
login
! !

LoginWindow open. !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:06:02' prior: 50991860 overrides: 50928932!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 15;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow.
	"addMorph: self build4rdRow."! !

LoginWindow open.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:06:20' prior: 50991969 overrides: 50928932!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 5;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow.
	"addMorph: self build4rdRow."! !

LoginWindow open.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:06:30' prior: 50991980 overrides: 50928932!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 100;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow.
	"addMorph: self build4rdRow."! !

LoginWindow open.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:06:45' prior: 50991991 overrides: 50928932!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 1;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow.
	"addMorph: self build4rdRow."! !

LoginWindow open.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:07:07' prior: 50991754!
build1stRow
	| firstRowLayoutMorph |
	
	userTextBoxMorph := TextModelMorph textProvider: self model textGetter: #username textSetter: #username:. 
	userTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | userTextBoxMorph innerTextMorph acceptContents ] .
	userTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 200 ; morphHeight: 20. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 5;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Username:');
	addMorph: userTextBoxMorph.
	
	^firstRowLayoutMorph.! !

LoginWindow open.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:07:13' prior: 50992013!
build1stRow
	| firstRowLayoutMorph |
	
	userTextBoxMorph := TextModelMorph textProvider: self model textGetter: #username textSetter: #username:. 
	userTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | userTextBoxMorph innerTextMorph acceptContents ] .
	userTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 200 ; morphHeight: 20. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Username:');
	addMorph: userTextBoxMorph.
	
	^firstRowLayoutMorph.! !

LoginWindow open.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:07:49' prior: 50992035!
build1stRow
	| firstRowLayoutMorph |
	
	userTextBoxMorph := TextModelMorph textProvider: self model textGetter: #username textSetter: #username:. 
	userTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | userTextBoxMorph innerTextMorph acceptContents ] .
	userTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 200 . 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Username:');
	addMorph: userTextBoxMorph.
	
	^firstRowLayoutMorph.! !

LoginWindow open.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:07:58' prior: 50992057!
build1stRow
	| firstRowLayoutMorph |
	
	userTextBoxMorph := TextModelMorph textProvider: self model textGetter: #username textSetter: #username:. 
	userTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | userTextBoxMorph innerTextMorph acceptContents ] .
	userTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 200 ; morphHeight: 20. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Username:');
	addMorph: userTextBoxMorph.
	
	^firstRowLayoutMorph.! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:10:30' prior: 50992002 overrides: 50928932!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 1;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow.
	"addMorph: self build4rdRow."! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:11:40' prior: 50992101 overrides: 50928932!
buildMorphicWindow
		
	self layoutMorph beColumn;
	minimumExtent;
	separation: 1;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow.
	"addMorph: self build4rdRow."! !

LoginWindow open.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:12:51' prior: 50992112 overrides: 50928932!
buildMorphicWindow
		
	self layoutMorph beColumn;
	extent: #minimumExtent;
	separation: 1;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow.
	"addMorph: self build4rdRow."! !

LoginWindow open.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:13:00' prior: 50992124 overrides: 50928932!
buildMorphicWindow
		
	self layoutMorph beColumn;
	minimumExtent;
	separation: 1;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow.
	"addMorph: self build4rdRow."! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:13:13' prior: 50992136 overrides: 50928932!
buildMorphicWindow
		
	self layoutMorph beColumn;
	morphExtent: self minimumExtent;
	separation: 1;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow.
	"addMorph: self build4rdRow."! !

LoginWindow open.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:13:38' prior: 50992147 overrides: 50928932!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 1;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow.
	"addMorph: self build4rdRow."! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:13:55' prior: 50992079!
build1stRow
	| firstRowLayoutMorph |
	
	userTextBoxMorph := TextModelMorph textProvider: self model textGetter: #username textSetter: #username:. 
	userTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | userTextBoxMorph innerTextMorph acceptContents ] .
	userTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 200 ; morphHeight: 20. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: self minimumExtent;
	addMorph: (LabelMorph contents:'Username:');
	addMorph: userTextBoxMorph.
	
	^firstRowLayoutMorph.! !

LoginWindow open.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:14:06' prior: 50991885!
build2ndRow
	| secondRowLayoutMorph |
	
	passwordTextBoxMorph := TextModelMorph textProvider: self model textGetter: #password textSetter: #password:. 
	passwordTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | passwordTextBoxMorph innerTextMorph acceptContents ] .
	passwordTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 200 ; morphHeight: 20. 
		
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: self minimumExtent;
	addMorph: (LabelMorph contents:'Password:');
	addMorph: passwordTextBoxMorph.
	
	^secondRowLayoutMorph.! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:14:11' prior: 50991870!
build3rdRow
	| sendRequestButtonMorph thirdRowLayoutMorph |
	
	sendRequestButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #authenticate  label: 'login'.
	
	thirdRowLayoutMorph := LayoutMorph newRow.
	thirdRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: self minimumExtent;
 	addMorph: sendRequestButtonMorph.
	
	^thirdRowLayoutMorph.! !

LoginWindow open.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:14:41' prior: 50992159 overrides: 50928932!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 1;
	axisEdgeWeight: 0;
	morphExtent: self minimumExtent;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow.
	"addMorph: self build4rdRow."! !

LoginWindow open.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:15:18' prior: 50991949!
initializeWith: aTitle

	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aTitle.
	self model: (LoginWindowModel new).
	self morphExtent: self minimumExtent.
	self buildMorphicWindow.
	self openInWorld.
			
	self model when: #authenticationResponse send: #login to: self.
	
	"Investigar:
	self model when: #newWordsArrived send: #refreshListOfWords:and: to: self."! !

LoginWindow open.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:15:38' prior: 50992244!
initializeWith: aTitle

	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aTitle.
	self model: (LoginWindowModel new).
	self morphExtent: self defaultExtent .
	self buildMorphicWindow.
	self openInWorld.
			
	self model when: #authenticationResponse send: #login to: self.
	
	"Investigar:
	self model when: #newWordsArrived send: #refreshListOfWords:and: to: self."! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:15:38' prior: 50992260!
initializeWith: aTitle

	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aTitle.
	self model: (LoginWindowModel new).
	self morphExtent: self defaultExtent.
	self buildMorphicWindow.
	self openInWorld.
			
	self model when: #authenticationResponse send: #login to: self.
	
	"Investigar:
	self model when: #newWordsArrived send: #refreshListOfWords:and: to: self."! !

LoginWindow open.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:16:20' prior: 50992215!
build3rdRow
	| errorMessageMorph thirdRowLayoutMorph |
	
	errorMessageMorph := PluggableButtonMorph model: self model stateGetter: nil action: #authenticate  label: 'login'.
	
	thirdRowLayoutMorph := LayoutMorph newRow.
	thirdRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: self minimumExtent;
 	addMorph: errorMessageMorph.
	
	^thirdRowLayoutMorph.! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:16:45' prior: 50992292!
build3rdRow
	| loginButtonMorph thirdRowLayoutMorph |
	
	loginButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #authenticate  label: 'login'.
	
	thirdRowLayoutMorph := LayoutMorph newRow.
	thirdRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: self minimumExtent;
 	addMorph: loginButtonMorph.
	
	^thirdRowLayoutMorph.! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:16:50'!
build4rdRow
	| loginButtonMorph thirdRowLayoutMorph |
	
	loginButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #authenticate  label: 'login'.
	
	thirdRowLayoutMorph := LayoutMorph newRow.
	thirdRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: self minimumExtent;
 	addMorph: loginButtonMorph.
	
	^thirdRowLayoutMorph.! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:16:56' prior: 50992322!
build4rdRow
	| errorMessageMorph thirdRowLayoutMorph |
	
	errorMessageMorph := PluggableButtonMorph model: self model stateGetter: nil action: #authenticate  label: 'login'.
	
	thirdRowLayoutMorph := LayoutMorph newRow.
	thirdRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: self minimumExtent;
 	addMorph: errorMessageMorph.
	
	^thirdRowLayoutMorph.! !

!classDefinition: #LoginWindow category: 'TusLibros-Graphics' stamp: 'MP 11/20/2021 18:20:48'!
Panel subclass: #LoginWindow
	instanceVariableNames: 'userTextBoxMorph passwordTextBoxMorph a'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Graphics'!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:20:46' prior: 50992337!
build4rdRow
	| thirdRowLayoutMorph |
	
	a := LabelMorph contents: ''.
	
	thirdRowLayoutMorph := LayoutMorph newRow.
	thirdRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: self minimumExtent;
 	addMorph: a.
	
	^thirdRowLayoutMorph.! !

!classDefinition: #LoginWindow category: 'TusLibros-Graphics' stamp: 'MP 11/20/2021 18:20:56'!
Panel subclass: #LoginWindow
	instanceVariableNames: 'userTextBoxMorph passwordTextBoxMorph errorMessageMorph'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Graphics'!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:20:56' prior: 50992361!
build4rdRow
	| thirdRowLayoutMorph |
	
	errorMessageMorph := LabelMorph contents: ''.
	
	thirdRowLayoutMorph := LayoutMorph newRow.
	thirdRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: self minimumExtent;
 	addMorph: errorMessageMorph.
	
	^thirdRowLayoutMorph.! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:22:37' prior: 50991964!
login
	errorMessageMorph contents: self model response.! !
!TusLibrosRestAPIInterfaceTest methodsFor: 'tests' stamp: 'MP 11/20/2021 18:25:32' prior: 50989804!
test02CreateCartForInvalidCredentials

	|server response client responseDecoded responseExpected|
	
	self setUp.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	client _ WebClient new.
	response _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self validUser,'&password=',self invalidPassword).
	responseDecoded _ self decodeJsonMapFrom: response.
	
	client close.
	server destroy.
	
	responseExpected := Dictionary new add: 'status' -> 1; add: 'errorDescription' -> (systemFacade invalidUserAndOrPasswordErrorDescription); yourself.
	
	self assert: (responseExpected at: 'status') equals: (responseDecoded at: 'status').
	self assert: (responseExpected at: 'errorDescription') equals: (responseDecoded at: 'errorDescription').
	! !
!LoginWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:25:46' prior: 50991938!
authenticate
	|client notDecodedResponse|
	client _ WebClient new.
	notDecodedResponse _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self username,'&password=',self password ).
	response _ (WebUtils jsonMapFrom: (response content) readStream).
	client close.
	
	self triggerEvent: #authenticationResponse! !
!LoginWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:25:56' prior: 50992426!
authenticate
	|client notDecodedResponse|
	client _ WebClient new.
	notDecodedResponse _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self username,'&password=',self password ).
	response _ (WebUtils jsonMapFrom: (notDecodedResponse content) readStream).
	client close.
	
	self triggerEvent: #authenticationResponse! !
!LoginWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:26:01' prior: 50992440!
authenticate
	|client notDecodedResponse|
	client _ WebClient new.
	notDecodedResponse _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self username,'&password=',self password ).
	response _ WebUtils jsonMapFrom: (notDecodedResponse content) readStream.
	client close.
	
	self triggerEvent: #authenticationResponse! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:26:27' prior: 50992232 overrides: 50928932!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 1;
	axisEdgeWeight: 0;
	morphExtent: self minimumExtent;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow;
	addMorph: self build4rdRow.! !

LoginWindow open.!

test startTestServerAndGraphicInterface.!
!TusLibrosRestAPIInterfaceTest methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:28:09' prior: 50991609!
startTestServerAndGraphicInterface

	|server|
	self setUp.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	LoginWindow open.
	
	^ server.! !

|server test|
test _ TusLibrosRestAPIInterfaceTest new.
server _ test startTestServerAndGraphicInterface.!
!LoginWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:29:31' prior: 50991854!
password: aPassword
	password _ aPassword asString.
	^ true.
	! !
!LoginWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:29:38' prior: 50991668!
username: aUsername
	username _ aUsername asString.
	^ true.
	! !

LoginWindow open.!
!LoginWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:32:45' prior: 50992454!
authenticate
	|client notDecodedResponse|
	client _ WebClient new.
	notDecodedResponse _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self username,'&password=',self password ).
	response _ WebUtils jsonMapFrom: (notDecodedResponse content) readStream asString.
	client close.
	
	self triggerEvent: #authenticationResponse! !
!LoginWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:33:25' prior: 50992507!
authenticate
	|client notDecodedResponse respDict |
	client _ WebClient new.
	notDecodedResponse _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self username,'&password=',self password ).
	respDict _ WebUtils jsonMapFrom: (notDecodedResponse content) readStream.
	response _ respDict at: 'errorMessage'.
	client close.
	
	self triggerEvent: #authenticationResponse! !

LoginWindow open.!
!LoginWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:34:02' prior: 50992521!
authenticate
	|client notDecodedResponse respDict |
	client _ WebClient new.
	notDecodedResponse _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self username,'&password=',self password ).
	respDict _ WebUtils jsonMapFrom: (notDecodedResponse content) readStream.
	response _ respDict at: 'errorDescription'.
	client close.
	
	self triggerEvent: #authenticationResponse! !

LoginWindow open.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:34:53' prior: 50992381!
build4rdRow
	| thirdRowLayoutMorph |
	
	errorMessageMorph := LabelMorph contents: ''.
	
	thirdRowLayoutMorph := LayoutMorph newRow.
	thirdRowLayoutMorph separation: 25;
	color: #red;
	axisEdgeWeight: 0.5;
	morphExtent: self minimumExtent;
 	addMorph: errorMessageMorph.
	
	^thirdRowLayoutMorph.! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:34:58' prior: 50992553!
build4rdRow
	| thirdRowLayoutMorph |
	
	errorMessageMorph := LabelMorph contents: ''.
	
	thirdRowLayoutMorph := LayoutMorph newRow.
	thirdRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: self minimumExtent;
 	addMorph: errorMessageMorph.
	
	^thirdRowLayoutMorph.! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:35:14' prior: 50992566!
build4rdRow
	| thirdRowLayoutMorph |
	
	errorMessageMorph := LabelMorph contents: ''; color: #red.
	
	thirdRowLayoutMorph := LayoutMorph newRow.
	thirdRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: self minimumExtent;
 	addMorph: errorMessageMorph.
	
	^thirdRowLayoutMorph.! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:36:05' prior: 50992578!
build4rdRow
	| thirdRowLayoutMorph |
	
	errorMessageMorph := LabelMorph contents: ''; color: Color red.
	
	thirdRowLayoutMorph := LayoutMorph newRow.
	thirdRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: self minimumExtent;
 	addMorph: errorMessageMorph.
	
	^thirdRowLayoutMorph.! !

LoginWindow open.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:37:14' prior: 50992591!
build4rdRow
	| thirdRowLayoutMorph |
	
	errorMessageMorph := LabelMorph contents: ''; color: Color red.
	
	thirdRowLayoutMorph := LayoutMorph newRow.
	thirdRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: self minimumExtent;
 	addMorph: errorMessageMorph.
	
	^thirdRowLayoutMorph.! !

LoginWindow open.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:38:23' prior: 50992605!
build4rdRow
	| thirdRowLayoutMorph |
	
	errorMessageMorph := LabelMorph contents: ''.
	errorMessageMorph color: Color red.
	
	thirdRowLayoutMorph := LayoutMorph newRow.
	thirdRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: self minimumExtent;
 	addMorph: errorMessageMorph.
	
	^thirdRowLayoutMorph.! !

LoginWindow open.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:40:17' prior: 50992619!
build4rdRow
	| thirdRowLayoutMorph |
	
	errorMessageMorph := LabelMorph contents: '' font: FontFamily defaultFamilyName emphasis: 'bold'.
	errorMessageMorph color: Color red.
	
	thirdRowLayoutMorph := LayoutMorph newRow.
	thirdRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: self minimumExtent;
 	addMorph: errorMessageMorph.
	
	^thirdRowLayoutMorph.! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:40:45' prior: 50992633!
build4rdRow
	| thirdRowLayoutMorph |
	
	errorMessageMorph := LabelMorph contents: '' font: FontFamily defaultFamilyName emphasis: AbstractFont boldCode.
	errorMessageMorph color: Color red.
	
	thirdRowLayoutMorph := LayoutMorph newRow.
	thirdRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: self minimumExtent;
 	addMorph: errorMessageMorph.
	
	^thirdRowLayoutMorph.! !

LoginWindow open.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:42:24' prior: 50992648!
build4rdRow
	| thirdRowLayoutMorph |
	
	errorMessageMorph := LabelMorph contents: '' font: Preferences standardMenuFont emphasis: AbstractFont boldCode.
	errorMessageMorph color: Color red.
	
	thirdRowLayoutMorph := LayoutMorph newRow.
	thirdRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: self minimumExtent;
 	addMorph: errorMessageMorph.
	
	^thirdRowLayoutMorph.! !

LoginWindow open.!
!LoginWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:43:14' prior: 50992537!
authenticate
	|client notDecodedResponse respDict |
	client _ WebClient new.
	notDecodedResponse _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self username,'&password=',self password ).
	respDict _ WebUtils jsonMapFrom: (notDecodedResponse content) readStream.
	response _ respDict at: 'errorDescription' ifAbsent: [''].
	client close.
	
	self triggerEvent: #authenticationResponse! !
!LoginWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:43:20' prior: 50992680!
authenticate
	|client notDecodedResponse respDict |
	client _ WebClient new.
	notDecodedResponse _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self username,'&password=',self password ).
	respDict _ WebUtils jsonMapFrom: (notDecodedResponse content) readStream.
	response _ respDict at: 'errorDescription' ifAbsent: [response _ ''].
	client close.
	
	self triggerEvent: #authenticationResponse! !
!LoginWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:43:30' prior: 50992696!
authenticate
	|client notDecodedResponse respDict |
	client _ WebClient new.
	notDecodedResponse _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self username,'&password=',self password ).
	respDict _ WebUtils jsonMapFrom: (notDecodedResponse content) readStream.
	response _ respDict at: 'errorDescription' ifAbsent: [''].
	client close.
	
	self triggerEvent: #authenticationResponse! !
!LoginWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:43:35' prior: 50992713!
authenticate
	|client notDecodedResponse respDict |
	client _ WebClient new.
	notDecodedResponse _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self username,'&password=',self password ).
	respDict _ WebUtils jsonMapFrom: (notDecodedResponse content) readStream.
	response _ respDict at: 'errorDescription' ifAbsent: [].
	client close.
	
	self triggerEvent: #authenticationResponse! !
!LoginWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:43:43' prior: 50992729!
authenticate
	|client notDecodedResponse respDict |
	client _ WebClient new.
	notDecodedResponse _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self username,'&password=',self password ).
	respDict _ WebUtils jsonMapFrom: (notDecodedResponse content) readStream.
	response _ respDict at: 'errorDescription' ifAbsent: [''].
	client close.
	
	self triggerEvent: #authenticationResponse! !
!LoginWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:44:10' prior: 50992745!
authenticate
	|client notDecodedResponse respDict |
	client _ WebClient new.
	notDecodedResponse _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self username,'&password=',self password ).
	respDict _ WebUtils jsonMapFrom: (notDecodedResponse content) readStream.
	response _ respDict at: 'errorDescription' ifAbsent: [response _ 'Authentication successful'].
	client close.
	
	self triggerEvent: #authenticationResponse! !

LoginWindow open.!
!LoginWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:45:31' prior: 50992761!
authenticate
	|client notDecodedResponse respDict |
	client _ WebClient new.
	notDecodedResponse _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self username,'&password=',self password ).
	respDict _ WebUtils jsonMapFrom: (notDecodedResponse content) readStream.
	response _ respDict at: 'errorDescription' ifAbsent: [''].
	client close.
	
	self triggerEvent: #authenticationResponse! !

LoginWindow open.!
!LoginWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:47:36' prior: 50992779!
authenticate
	|client notDecodedResponse respDict |
	client _ WebClient new.
	notDecodedResponse _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self username,'&password=',self password ).
	respDict _ WebUtils jsonMapFrom: (notDecodedResponse content) readStream.
	self halt.
	response _ respDict at: 'errorDescription' ifAbsent: [''].
	client close.
	
	self triggerEvent: #authenticationResponse! !

LoginWindow open.!

[''] value.!

[test _ ''.] value.!

[test _ 'hola'.] value. !

test2 _ [test _ 'hola'.] value.!

test2 = test.!

test2 _ [test _ 'hola'. 'chau'] value.!

test2 _ [test _ 'hola'. test2 _ 'chau'] value.!
!LoginWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:51:25' prior: 50992796!
authenticate
	|client notDecodedResponse respDict |
	client _ WebClient new.
	notDecodedResponse _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self username,'&password=',self password ).
	respDict _ WebUtils jsonMapFrom: (notDecodedResponse content) readStream.
	response _ respDict at: 'errorDescription' ifAbsent: [''].
	client close.
	
	self triggerEvent: #authenticationResponse! !

[] value.!

----SNAPSHOT----(20 November 2021 18:53:45) CuisUniversity-4972.image priorSource: 21114731!

----SNAPSHOT----(20 November 2021 18:53:49) CuisUniversity-4972.image priorSource: 21157919!
!LoginWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 18:59:51' prior: 50991682 overrides: 16896425!
initialize

	username := ''.
	password := '' "Dont do this at home kids".! !

Panel subclass: #CatalogWindow
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Graphics'!

!classDefinition: #CatalogWindow category: 'TusLibros-Graphics' stamp: 'MP 11/20/2021 19:09:11'!
Panel subclass: #CatalogWindow
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Graphics'!
!LoginWindow class methodsFor: 'instance creation' stamp: 'MP 11/20/2021 19:10:19' prior: 50991541!
open
	
	^self new initializeWith: 'TusLibros - login'.! !
!CatalogWindow class methodsFor: 'no messages' stamp: 'MP 11/20/2021 19:10:21'!
open
	
	^self new initializeWith: 'TusLibros - shop'.! !

!classDefinition: #CatalogWindowModel category: 'TusLibros-Graphics' stamp: 'MP 11/20/2021 19:15:38'!
Object subclass: #CatalogWindowModel
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Graphics'!
!CatalogWindow methodsFor: 'nil' stamp: 'MP 11/20/2021 19:15:27'!
initializeWith: aTitle

	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aTitle.
	self model: (CatalogWindowModel new).
	self morphExtent: self defaultExtent.
	self buildMorphicWindow.
	self openInWorld.
			
	self model when: #authenticationResponse send: #login to: self.
	
	"Investigar:
	self model when: #newWordsArrived send: #refreshListOfWords:and: to: self."! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 19:15:48' prior: 50992878!
initializeWith: aTitle

	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aTitle.
	self model: (CatalogWindowModel new).
	self morphExtent: self defaultExtent.
	self buildMorphicWindow.
	self openInWorld.
			
	"self model when: #authenticationResponse send: #login to: self."
	
	"Investigar:
	self model when: #newWordsArrived send: #refreshListOfWords:and: to: self."! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 19:16:11' overrides: 50929028!
defaultExtent

	^ 1035@900
	! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 19:17:15' prior: 50992307!
build3rdRow
	| loginButtonMorph thirdRowLayoutMorph |
	
	loginButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #authenticate  label: 'Create Cart'.
	
	thirdRowLayoutMorph := LayoutMorph newRow.
	thirdRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: self minimumExtent;
 	addMorph: loginButtonMorph.
	
	^thirdRowLayoutMorph.! !

----SNAPSHOT----(20 November 2021 19:34:55) CuisUniversity-4972.image priorSource: 21158013!
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 19:36:27' overrides: 50928932!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 1;
	axisEdgeWeight: 0;
	morphExtent: self minimumExtent;
	addMorph: self buildShopHeader;
	addMorph: self buildShopBody.! !

!classDefinition: #CatalogWindow category: 'TusLibros-Graphics' stamp: 'MP 11/20/2021 19:38:56'!
Panel subclass: #CatalogWindow
	instanceVariableNames: 'username'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Graphics'!
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 19:38:53'!
buildShopHeader
	| firstRowLayoutMorph headerButtonsMorph |
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: self minimumExtent;
	addMorph: (LabelMorph contents:'Welcome, ',username,'!!');
	addMorph: headerButtonsMorph.
	
	^firstRowLayoutMorph.! !
!CatalogWindow class methodsFor: 'instance creation' stamp: 'MP 11/20/2021 19:39:55'!
openWithUser: aUsername and: aPassword
	
	^self basicNew initializeWith: 'TusLibros - shop' and: aUsername and: aPassword.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 19:40:10'!
initializeWith: aTitle and: aUsername and: aPassword

	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aTitle.
	self model: (CatalogWindowModel new).
	self morphExtent: self defaultExtent.
	self buildMorphicWindow.
	self openInWorld.
			
	"self model when: #authenticationResponse send: #login to: self."
	
	"Investigar:
	self model when: #newWordsArrived send: #refreshListOfWords:and: to: self."! !

!methodRemoval: CatalogWindow #initializeWith: stamp: 'MP 11/20/2021 19:40:15'!
initializeWith: aTitle

	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aTitle.
	self model: (CatalogWindowModel new).
	self morphExtent: self defaultExtent.
	self buildMorphicWindow.
	self openInWorld.
			
	"self model when: #authenticationResponse send: #login to: self."
	
	"Investigar:
	self model when: #newWordsArrived send: #refreshListOfWords:and: to: self."!

!classDefinition: #CatalogWindow category: 'TusLibros-Graphics' stamp: 'MP 11/20/2021 19:40:41'!
Panel subclass: #CatalogWindow
	instanceVariableNames: 'username password'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Graphics'!
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 19:40:37' prior: 50992968!
initializeWith: aTitle and: aUsername and: aPassword
	
	username _ aUsername.
	password _ aPassword.
	
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aTitle.
	self model: (CatalogWindowModel new).
	self morphExtent: self defaultExtent.
	self buildMorphicWindow.
	self openInWorld.
			
	"self model when: #authenticationResponse send: #login to: self."
	
	"Investigar:
	self model when: #newWordsArrived send: #refreshListOfWords:and: to: self."! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 19:42:01'!
initializeWith: aTitle and: aUsername and: aPassword and: aCartID 
	
	username _ aUsername.
	password _ aPassword.
	
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aTitle.
	self model: (CatalogWindowModel new).
	self morphExtent: self defaultExtent.
	self buildMorphicWindow.
	self openInWorld.
			
	"self model when: #authenticationResponse send: #login to: self."
	
	"Investigar:
	self model when: #newWordsArrived send: #refreshListOfWords:and: to: self."! !
!CatalogWindow class methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 19:42:01' prior: 50992961!
openWithUser: aUsername and: aPassword
	
	^self basicNew initializeWith: 'TusLibros - shop' and: aUsername and: aPassword and: cartId.! !

!methodRemoval: CatalogWindow #initializeWith:and:and: stamp: 'MP 11/20/2021 19:42:01'!
initializeWith: aTitle and: aUsername and: aPassword
	
	username _ aUsername.
	password _ aPassword.
	
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aTitle.
	self model: (CatalogWindowModel new).
	self morphExtent: self defaultExtent.
	self buildMorphicWindow.
	self openInWorld.
			
	"self model when: #authenticationResponse send: #login to: self."
	
	"Investigar:
	self model when: #newWordsArrived send: #refreshListOfWords:and: to: self."!

!methodRemoval: CatalogWindow class #open stamp: 'MP 11/20/2021 19:42:18'!
open
	
	^self new initializeWith: 'TusLibros - shop'.!
!CatalogWindow class methodsFor: 'instance creation' stamp: 'MP 11/20/2021 19:42:38'!
openWithUser: aUsername and: aPassword and: cartId 
	
	^self basicNew initializeWith: 'TusLibros - shop' and: aUsername and: aPassword and: cartId.! !

!methodRemoval: CatalogWindow class #openWithUser:and: stamp: 'MP 11/20/2021 19:42:38'!
openWithUser: aUsername and: aPassword
	
	^self basicNew initializeWith: 'TusLibros - shop' and: aUsername and: aPassword and: cartId.!
!CatalogWindow class methodsFor: 'instance creation' stamp: 'MP 11/20/2021 19:42:47' prior: 50993073!
openWithUser: aUsername and: aPassword and: aCartID 
	
	^self basicNew initializeWith: 'TusLibros - shop' and: aUsername and: aPassword and: aCartID.! !
!CatalogWindow class methodsFor: 'instance creation' stamp: 'MP 11/20/2021 19:43:07'!
openWithUser: aUsername andPass: aPassword andCart: aCartID 
	
	^self basicNew initializeWith: 'TusLibros - shop' and: aUsername and: aPassword and: aCartID.! !

!methodRemoval: CatalogWindow class #openWithUser:and:and: stamp: 'MP 11/20/2021 19:43:07'!
openWithUser: aUsername and: aPassword and: aCartID 
	
	^self basicNew initializeWith: 'TusLibros - shop' and: aUsername and: aPassword and: aCartID.!
!LoginWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 19:45:50' prior: 50992820!
authenticate
	|client notDecodedResponse respDict |
	client _ WebClient new.
	notDecodedResponse _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self username,'&password=',self password ).
	respDict _ WebUtils jsonMapFrom: (notDecodedResponse content) readStream.
	(respDict at: 'status') = '0' 
		ifTrue: [
			|cartId|
			cartId _ respDict at: 'cartId'.
			
		] 
		ifFalse: [
			response _ respDict at: 'errorDescription'.
		].
	
	
	client close.
	
	self triggerEvent: #authenticationResponse! !
!LoginWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 19:46:54' prior: 50993112!
authenticate
	|client notDecodedResponse respDict |
	client _ WebClient new.
	notDecodedResponse _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self username,'&password=',self password ).
	respDict _ WebUtils jsonMapFrom: (notDecodedResponse content) readStream.
	(respDict at: 'status') = '0' 
		ifTrue: [
			|cartId|
			cartId _ respDict at: 'cartId'.
			CatalogWindow openWithUser: username andPass: password andCart: cartId. 
		] 
		ifFalse: [
			response _ respDict at: 'errorDescription'.
		].
	
	
	client close.
	
	self triggerEvent: #authenticationResponse! !
!LoginWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 19:46:56' prior: 50993132!
authenticate
	|client notDecodedResponse respDict |
	client _ WebClient new.
	notDecodedResponse _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self username,'&password=',self password ).
	respDict _ WebUtils jsonMapFrom: (notDecodedResponse content) readStream.
	(respDict at: 'status') = '0' 
		ifTrue: [
			|cartId|
			cartId _ respDict at: 'cartId'.
			CatalogWindow openWithUser: username andPass: password andCart: cartId.
		] 
		ifFalse: [
			response _ respDict at: 'errorDescription'.
		].
	
	
	client close.
	
	self triggerEvent: #authenticationResponse! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 19:53:14' prior: 50992948!
buildShopHeader
	| firstRowLayoutMorph headerButtonsMorph |
		
	headerButtonsMorph := LayoutMorph newRow.
	headerButtonsMorph separation: 25;
	axisEdgeWeight: 1.0;
	morphExtent: self minimumExtent;
	addMorph: (LabelMorph contents: 'test1');
	addMorph: (LabelMorph contents: 'test2').
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.0;
	morphExtent: self minimumExtent;
	addMorph: (LabelMorph contents:'Welcome, ',username,'!!');
	addMorph: headerButtonsMorph.
	
	^firstRowLayoutMorph.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 19:54:21' prior: 50992932 overrides: 50928932!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 1;
	axisEdgeWeight: 0;
	morphExtent: self minimumExtent;
	addMorph: self buildShopHeader.
	"addMorph: self buildShopBody."! !

TusLibrosRestAPIInterface allInstances !

LoginWindow open.!
!LoginWindowModel methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 19:56:08' prior: 50993154!
authenticate
	|client notDecodedResponse respDict |
	client _ WebClient new.
	notDecodedResponse _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self username,'&password=',self password ).
	respDict _ WebUtils jsonMapFrom: (notDecodedResponse content) readStream.
	(respDict at: 'status') = 0
		ifTrue: [
			|cartId|
			cartId _ respDict at: 'cartId'.
			CatalogWindow openWithUser: username andPass: password andCart: cartId.
		] 
		ifFalse: [
			response _ respDict at: 'errorDescription'.
		].
	
	
	client close.
	
	self triggerEvent: #authenticationResponse! !

LoginWindow open.!
!CatalogWindow class methodsFor: 'instance creation' stamp: 'MP 11/20/2021 19:57:41' prior: 50993096!
openWithUser: aUsername andPass: aPassword andCart: aCartID 
	
	^self new initializeWith: 'TusLibros - shop' and: aUsername and: aPassword and: aCartID.! !

LoginWindow open.!
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 19:58:33' prior: 50992910 overrides: 50929028!
defaultExtent

	^ 1035@485
	! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 19:59:19' prior: 50993197 overrides: 50928932!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 1;
	axisEdgeWeight: 0.0;
	morphExtent: self minimumExtent;
	addMorph: self buildShopHeader.
	"addMorph: self buildShopBody."! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 19:59:31' prior: 50993245 overrides: 50928932!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 1;
	axisEdgeWeight: 0.0;
	morphExtent: self defaultExtent;
	addMorph: self buildShopHeader.
	"addMorph: self buildShopBody."! !

LoginWindow open.!

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !

----SNAPSHOT----(20 November 2021 20:00:52) CuisUniversity-4972.image priorSource: 21160886!
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:01:11' prior: 50993255 overrides: 50928932!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 1;
	axisEdgeWeight: 0.0;
	morphExtent: self defaultExtent;
	addMorph: self buildShopHeader;
	addMorph: self buildShopBody.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:01:42'!
buildShopBody
	| firstRowLayoutMorph headerButtonsMorph |
		
	headerButtonsMorph := LayoutMorph newRow.
	headerButtonsMorph separation: 25;
	axisEdgeWeight: 1.0;
	morphExtent: self minimumExtent;
	addMorph: (LabelMorph contents: 'test1');
	addMorph: (LabelMorph contents: 'test2').
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.0;
	morphExtent: self minimumExtent;
	addMorph: (LabelMorph contents:'Welcome, ',username,'!!');
	addMorph: headerButtonsMorph.
	
	^firstRowLayoutMorph.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:02:01' prior: 50993280!
buildShopBody
	| firstRowLayoutMorph catalogMorph |
		
	catalogMorph := LayoutMorph newRow.
	catalogMorph separation: 25;
	axisEdgeWeight: 1.0;
	morphExtent: self minimumExtent;
	addMorph: (LabelMorph contents: 'test1');
	addMorph: (LabelMorph contents: 'test2').
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.0;
	morphExtent: self minimumExtent;
	addMorph: (LabelMorph contents:'Welcome, ',username,'!!');
	addMorph: catalogMorph.
	
	^firstRowLayoutMorph.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:02:32' prior: 50993300!
buildShopBody
	| firstRowLayoutMorph catalogMorph buildCartListMorph buildCatalogMorph cartListMorph |
		
	catalogMorph := buildCatalogMorph.
	cartListMorph := buildCartListMorph.
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.0;
	morphExtent: self minimumExtent;
	addMorph: (LabelMorph contents:'Welcome, ',username,'!!');
	addMorph: catalogMorph.
	
	^firstRowLayoutMorph.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:03:10' prior: 50993320!
buildShopBody
	| firstRowLayoutMorph catalogMorph buildCartListMorph buildCatalogMorph cartListMorph |
		
	catalogMorph := buildCatalogMorph.
	cartListMorph := buildCartListMorph.
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.0;
	morphExtent: self minimumExtent;
	addMorph: catalogMorph;
	addMorph: cartListMorph.
	
	^firstRowLayoutMorph.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:03:28' prior: 50993337!
buildShopBody
	| bodyLayoutMorph catalogMorph buildCartListMorph buildCatalogMorph cartListMorph |
		
	catalogMorph := buildCatalogMorph.
	cartListMorph := buildCartListMorph.
		
	bodyLayoutMorph := LayoutMorph newRow.
	bodyLayoutMorph separation: 25;
	axisEdgeWeight: 0.0;
	morphExtent: self minimumExtent;
	addMorph: catalogMorph;
	addMorph: cartListMorph.
	
	^bodyLayoutMorph.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:03:40'!
buildCatalogMorph! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:03:54' prior: 50993353!
buildShopBody
	| bodyLayoutMorph catalogMorph cartListMorph |
		
	catalogMorph := self buildCatalogMorph.
	cartListMorph := self buildCartListMorph.
		
	bodyLayoutMorph := LayoutMorph newRow.
	bodyLayoutMorph separation: 25;
	axisEdgeWeight: 0.0;
	morphExtent: self minimumExtent;
	addMorph: catalogMorph;
	addMorph: cartListMorph.
	
	^bodyLayoutMorph.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:04:14'!
buildCartListMorph
	^ self shouldBeImplemented.! !

----SNAPSHOT----(20 November 2021 20:09:34) CuisUniversity-4972.image priorSource: 21171719!
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:16:41' prior: 50993368!
buildCatalogMorph
	
	| catalogMorph p |
	catalogMorph := LayoutMorph newColumn.
	p := PluggableScrollPane new.
	p scroller: catalogMorph.
	^ p.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:16:46' prior: 50993394!
buildCatalogMorph
	
	| catalogMorph p |
	
	catalogMorph := LayoutMorph newColumn.
	p := PluggableScrollPane new.
	p scroller: catalogMorph.
	^ p.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:17:25' prior: 50993402!
buildCatalogMorph
	
	| catalogMorph p |
	
	catalogMorph := LayoutMorph newColumn.
	catalogMorph separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Results');
	addMorph: (LabelMorph contents:'Results');
	addMorph: (LabelMorph contents:'Results');
	addMorph: (LabelMorph contents:'Results');
	addMorph: (LabelMorph contents:'Results');
	addMorph: (LabelMorph contents:'Results');
	addMorph: (LabelMorph contents:'Results');
	addMorph: (LabelMorph contents:'Results');
	addMorph: (LabelMorph contents:'Results');
	addMorph: (LabelMorph contents:'Results');
	addMorph: (LabelMorph contents:'Results');
	addMorph: (LabelMorph contents:'Results').
	p := PluggableScrollPane new.
	p scroller: catalogMorph.
	^ p.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:17:45' prior: 50993372!
buildShopBody
	| bodyLayoutMorph catalogMorph cartListMorph |
		
	catalogMorph := self buildCatalogMorph.
	cartListMorph := self buildCartListMorph.
		
	bodyLayoutMorph := LayoutMorph newRow.
	bodyLayoutMorph separation: 25;
	axisEdgeWeight: 0.0;
	morphExtent: self minimumExtent;
	addMorph: catalogMorph.
	"addMorph: cartListMorph."
	
	^bodyLayoutMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:18:14' prior: 50993436!
buildShopBody
	| bodyLayoutMorph catalogMorph cartListMorph |
		
	catalogMorph := self buildCatalogMorph.
	"cartListMorph := self buildCartListMorph."
		
	bodyLayoutMorph := LayoutMorph newRow.
	bodyLayoutMorph separation: 25;
	axisEdgeWeight: 0.0;
	morphExtent: self minimumExtent;
	addMorph: catalogMorph.
	"addMorph: cartListMorph."
	
	^bodyLayoutMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:19:07' prior: 50993410!
buildCatalogMorph
	
	| catalogMorph p |
	
	catalogMorph := LayoutMorph newColumn.
	catalogMorph separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Results');
	addMorph: (LabelMorph contents:'Results').
	p := PluggableScrollPane new.
	p scroller: catalogMorph.
	^ p.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:22:37' prior: 50993473!
buildCatalogMorph
	
	| catalogMorph p |
	
	catalogMorph := LayoutMorph newColumn.
	catalogMorph separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN');
	addMorph: (LabelMorph contents:'Results').
	p := PluggableScrollPane new.
	p scroller: catalogMorph.
	^ p.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:23:36'!
buildCatalogItemMorphWithName: aBookName withISBN: anISBN

	| catalogMorph itemMorph p |
	itemMorph := LayoutMorph newRow.
	itemMorph separation: 5; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN');
	addMorph: (LabelMorph contents:'Results').
	p := PluggableScrollPane new.
	p scroller: catalogMorph.
	^ p.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:23:51' prior: 50993486!
buildCatalogMorph
	
	| catalogMorph p |
	
	catalogMorph := LayoutMorph newColumn.
	catalogMorph separation: 5; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN');
	addMorph: (LabelMorph contents:'Results').
	p := PluggableScrollPane new.
	p scroller: catalogMorph.
	^ p.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:24:05' prior: 50993499!
buildCatalogItemMorphWithName: aBookName withISBN: anISBN

	| catalogMorph itemMorph p |
	itemMorph := LayoutMorph newRow.
	itemMorph separation: 0; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN');
	addMorph: (LabelMorph contents:'Results').
	p := PluggableScrollPane new.
	p scroller: catalogMorph.
	^ p.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:24:19' prior: 50993528!
buildCatalogItemMorphWithName: aBookName withISBN: anISBN

	| itemMorph |
	itemMorph := LayoutMorph newRow.
	itemMorph separation: 0; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN');
	addMorph: (LabelMorph contents:'Results').

	^ itemMorph.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:25:15' prior: 50993543!
buildCatalogItemMorphWithName: aBookName withISBN: anISBN

	| itemMorph |
	itemMorph := LayoutMorph newRow.
	itemMorph separation: 0; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN');
	addMorph: (LabelMorph contents: aBookName);
	addMorph: (LabelMorph contents: anISBN).

	^ itemMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:25:30' prior: 50993556!
buildCatalogItemMorphWithName: aBookName withISBN: anISBN

	| itemMorph |
	itemMorph := LayoutMorph newRow.
	itemMorph separation: 0; 
	axisEdgeWeight: 0.0;
	addMorph: (LabelMorph contents: aBookName);
	addMorph: (LabelMorph contents: anISBN).

	^ itemMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:26:10' prior: 50993514!
buildCatalogMorph
	
	| catalogMorph p |
	
	catalogMorph := LayoutMorph newColumn.
	catalogMorph separation: 5; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN');
	addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN');
	addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN');
	addMorph: (LabelMorph contents:'Results').
	p := PluggableScrollPane new.
	p scroller: catalogMorph.
	^ p.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:26:41' prior: 50993587!
buildCatalogMorph
	
	| catalogMorph p |
	
	catalogMorph := LayoutMorph newColumn.
	catalogMorph separation: 5; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogListHeader);
	addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN');
	addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN');
	addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN').
	p := PluggableScrollPane new.
	p scroller: catalogMorph.
	^ p.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:27:35'!
buildCatalogListHeader
	
	| catalogMorph |
	
	catalogMorph := LayoutMorph newRow.
	catalogMorph separation: 5; 
	axisEdgeWeight: 0.0;
	addMorph: (LabelMorph contents:'Book name');
	addMorph: (LabelMorph contents:'ISBN').
	^ catalogMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:27:51' prior: 50993623!
buildCatalogListHeader
	
	| catalogMorph |
	
	catalogMorph := LayoutMorph newRow.
	catalogMorph separation: 25; 
	axisEdgeWeight: 0.0;
	addMorph: (LabelMorph contents:'Book name');
	addMorph: (LabelMorph contents:'ISBN').
	^ catalogMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:29:17' prior: 50993456!
buildShopBody
	| bodyLayoutMorph catalogMorph cartListMorph |
		
	catalogMorph := self buildCatalogMorph.
	"cartListMorph := self buildCartListMorph."
		
	bodyLayoutMorph := LayoutMorph newRow.
	bodyLayoutMorph separation: 25;
	axisEdgeWeight: 0.0;
	morphExtent: (self defaultExtent x)@(self defaultExtent y * 0.66) ;
	addMorph: catalogMorph.
	"addMorph: cartListMorph."
	
	^bodyLayoutMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:29:54' prior: 50993176!
buildShopHeader
	| firstRowLayoutMorph headerButtonsMorph |
		
	headerButtonsMorph := LayoutMorph newRow.
	headerButtonsMorph separation: 25;
	axisEdgeWeight: 1.0;
	morphExtent: self minimumExtent;
	addMorph: (LabelMorph contents: 'test1');
	addMorph: (LabelMorph contents: 'test2').
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.0;
	morphExtent: (self defaultExtent x)@(self defaultExtent y * 0.30) ;
	addMorph: (LabelMorph contents:'Welcome, ',username,'!!');
	addMorph: headerButtonsMorph.
	
	^firstRowLayoutMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:31:41' prior: 50993670!
buildShopHeader
	| firstRowLayoutMorph headerButtonsMorph |
		
	headerButtonsMorph := LayoutMorph newRow.
	headerButtonsMorph separation: 25;
	axisEdgeWeight: 1.0;
	morphExtent: self minimumExtent;
	addMorph: (LabelMorph contents: 'test1');
	addMorph: (LabelMorph contents: 'test2').
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.0;
	morphExtent: (self defaultExtent x)@(self defaultExtent y * 0.30) ;
	addMorph: (LabelMorph contents:'Welcome, ',username,'!!');
	addMorph: headerButtonsMorph.
	
	^firstRowLayoutMorph.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:32:10' prior: 50993605!
buildCatalogMorph
	
	| catalogMorph p |
	
	catalogMorph := LayoutMorph newColumn.
	catalogMorph separation: 5; 
	axisEdgeWeight: 0.0;
	morphExtent: self defaultExtent;
	addMorph: (self buildCatalogListHeader);
	addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN');
	addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN');
	addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN').
	p := PluggableScrollPane new.
	p scroller: catalogMorph.
	^ p.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:32:48' prior: 50993716!
buildCatalogMorph
	
	| catalogMorph p |
	
	catalogMorph := LayoutMorph newColumn.
	catalogMorph separation: 5; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogListHeader);
	addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN');
	addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN');
	addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN').
	p := PluggableScrollPane new.
	p morphExtent: self defaultExtent;
	scroller: catalogMorph.
	^ p.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:33:06' prior: 50993738!
buildCatalogMorph
	
	| catalogMorph p |
	
	catalogMorph := LayoutMorph newColumn.
	catalogMorph separation: 5; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogListHeader);
	addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN');
	addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN');
	addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN').
	p := PluggableScrollPane new.
	p morphExtent: (self defaultExtent x)@(self defaultExtent y * 0.60);
	scroller: catalogMorph.
	^ p.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:33:21' prior: 50993757!
buildCatalogMorph
	
	| catalogMorph p |
	
	catalogMorph := LayoutMorph newColumn.
	catalogMorph separation: 5; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogListHeader);
	addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN');
	addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN');
	addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN').
	p := PluggableScrollPane new.
	p morphExtent: (self defaultExtent x*0.6)@(self defaultExtent y * 0.60);
	scroller: catalogMorph.
	^ p.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:34:06' prior: 50993780!
buildCatalogMorph
	
	| catalogMorph p |
	
	catalogMorph := LayoutMorph newColumn.
	catalogMorph separation: 5; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogListHeader).
	
	catalogMorph addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN');
	addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN');
	addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN').
	p := PluggableScrollPane new.
	p morphExtent: (self defaultExtent x*0.6)@(self defaultExtent y * 0.60);
	scroller: catalogMorph.
	^ p.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:34:16' prior: 50993803!
buildCatalogMorph
	
	| catalogMorph p |
	
	catalogMorph := LayoutMorph newColumn.
	catalogMorph separation: 5; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogListHeader).
	
	catalogMorph addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN').
	
	p := PluggableScrollPane new.
	p morphExtent: (self defaultExtent x*0.6)@(self defaultExtent y * 0.60);
	scroller: catalogMorph.
	^ p.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:34:51' prior: 50993824!
buildCatalogMorph
	
	| catalogMorph p |
	
	catalogMorph := LayoutMorph newColumn.
	catalogMorph separation: 5; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogListHeader).
	
	catalogMorph addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN').
	
	p := PluggableScrollPane new.
	p morphExtent: (self defaultExtent x*0.6)@(self defaultExtent y * 0.60);
	scroller: catalogMorph.
	^ p.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:35:39' prior: 50993840!
buildCatalogMorph
	
	| catalogMorph p |
	
	catalogMorph := LayoutMorph newColumn.
	catalogMorph separation: 5; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogListHeader).
	[catalogMorph addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN').] timesRepeat: 20.
	
	
	p := PluggableScrollPane new.
	p morphExtent: (self defaultExtent x*0.6)@(self defaultExtent y * 0.60);
	scroller: catalogMorph.
	^ p.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:39:50' prior: 50993856!
buildCatalogMorph
	
	| catalogMorph p |
	
	catalogMorph := LayoutMorph newColumn.
	catalogMorph separation: 5; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogListHeader).
	20 timesRepeat: [catalogMorph addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN').].
	
	
	
	p := PluggableScrollPane new.
	p morphExtent: (self defaultExtent x*0.6)@(self defaultExtent y * 0.60);
	scroller: catalogMorph.
	^ p.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !

----SNAPSHOT----(20 November 2021 20:40:11) CuisUniversity-4972.image priorSource: 21175666!
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:40:58' prior: 50993573!
buildCatalogItemMorphWithName: aBookName withISBN: anISBN

	| itemMorph |
	itemMorph := LayoutMorph newRow.
	itemMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: (LabelMorph contents: aBookName);
	addMorph: (LabelMorph contents: anISBN).

	^ itemMorph.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:41:01' prior: 50993897!
buildCatalogItemMorphWithName: aBookName withISBN: anISBN

	| itemMorph |
	itemMorph := LayoutMorph newRow.
	itemMorph separation: 25; 
	axisEdgeWeight: 0.0;
	addMorph: (LabelMorph contents: aBookName);
	addMorph: (LabelMorph contents: anISBN).

	^ itemMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:48:42' prior: 50993637!
buildCatalogListHeader
	
	| catalogMorph |
	
	catalogMorph := LayoutMorph newRow.
	catalogMorph separation: 25; 
	axisEdgeWeight: 0.0;
	addMorph: ((LabelMorph contents:'Book name') morphExtent: (super morphExtent x*0.25)@(super morphExtent y) );
	addMorph: (LabelMorph contents:'ISBN').
	^ catalogMorph.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:48:49' prior: 50993923!
buildCatalogListHeader
	
	| catalogMorph |
	
	catalogMorph := LayoutMorph newRow.
	catalogMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: ((LabelMorph contents:'Book name') morphExtent: (super morphExtent x*0.25)@(super morphExtent y) );
	addMorph: (LabelMorph contents:'ISBN').
	^ catalogMorph.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:49:02' prior: 50993936!
buildCatalogListHeader
	
	| catalogMorph |
	
	catalogMorph := LayoutMorph newRow.
	catalogMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: ((LabelMorph contents:'Book name') morphExtent: (super morphExtent x*0.25)@(super morphExtent y) );
	addMorph: ((LabelMorph contents:'ISBN') morphExtent: (super morphExtent x*0.25)@(super morphExtent y) ).
	^ catalogMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:49:22' prior: 50993949!
buildCatalogListHeader
	
	| catalogMorph |
	
	catalogMorph := LayoutMorph newRow.
	catalogMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: ((LabelMorph contents:'Book name') morphExtent: (super morphExtent x*0.5)@(super morphExtent y) );
	addMorph: ((LabelMorph contents:'ISBN') morphExtent: (super morphExtent x*0.5)@(super morphExtent y) ).
	^ catalogMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:49:48' prior: 50993967!
buildCatalogListHeader
	
	| catalogMorph |
	
	catalogMorph := LayoutMorph newRow.
	catalogMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: ((LabelMorph contents:'Book name') morphExtent: (self morphExtentInOwner x*0.5)@(self morphExtentInOwner y) );
	addMorph: ((LabelMorph contents:'ISBN') morphExtent: (super morphExtent x*0.5)@(super morphExtent y) ).
	^ catalogMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:50:10' prior: 50993985!
buildCatalogListHeader
	
	| catalogMorph |
	
	catalogMorph := LayoutMorph newRow.
	catalogMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: ((LabelMorph contents:'Book name') morphExtent: (super morphExtent x*0.1)@(super morphExtent y) );
	addMorph: ((LabelMorph contents:'ISBN') morphExtent: (super morphExtent x*0.1)@(super morphExtent y) ).
	^ catalogMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:50:19' prior: 50994003!
buildCatalogListHeader
	
	| catalogMorph |
	
	catalogMorph := LayoutMorph newRow.
	catalogMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: ((LabelMorph contents:'Book name') morphExtent: (super morphExtent x*0.2)@(super morphExtent y) );
	addMorph: ((LabelMorph contents:'ISBN') morphExtent: (super morphExtent x*0.2)@(super morphExtent y) ).
	^ catalogMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:50:39' prior: 50993875!
buildCatalogMorph
	
	| catalogMorph p |
	
	catalogMorph := LayoutMorph newColumn.
	catalogMorph separation: 5; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogListHeader).
	20 timesRepeat: [catalogMorph addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN').].
	
	
	
	p := PluggableScrollPane new.
	p morphExtent: (self defaultExtent x*0.6)@(self defaultExtent y * 0.66);
	scroller: catalogMorph.
	^ p.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:50:45' prior: 50994039!
buildCatalogMorph
	
	| catalogMorph p |
	
	catalogMorph := LayoutMorph newColumn.
	catalogMorph separation: 5; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogListHeader).
	20 timesRepeat: [catalogMorph addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN').].
	
	
	
	p := PluggableScrollPane new.
	p morphExtent: (self defaultExtent x*0.6)@(self defaultExtent y * 0.60);
	scroller: catalogMorph.
	^ p.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:51:01' prior: 50993694!
buildShopHeader
	| firstRowLayoutMorph headerButtonsMorph |
		
	headerButtonsMorph := LayoutMorph newRow.
	headerButtonsMorph separation: 25;
	axisEdgeWeight: 1.0;
	morphExtent: self minimumExtent;
	addMorph: (LabelMorph contents: 'test1');
	addMorph: (LabelMorph contents: 'test2').
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.0;
	morphExtent: (self defaultExtent x)@(self defaultExtent y * 0.2) ;
	addMorph: (LabelMorph contents:'Welcome, ',username,'!!');
	addMorph: headerButtonsMorph.
	
	^firstRowLayoutMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:51:09' prior: 50994076!
buildShopHeader
	| firstRowLayoutMorph headerButtonsMorph |
		
	headerButtonsMorph := LayoutMorph newRow.
	headerButtonsMorph separation: 25;
	axisEdgeWeight: 1.0;
	morphExtent: self minimumExtent;
	addMorph: (LabelMorph contents: 'test1');
	addMorph: (LabelMorph contents: 'test2').
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.0;
	morphExtent: (self defaultExtent x)@(self defaultExtent y * 0.3) ;
	addMorph: (LabelMorph contents:'Welcome, ',username,'!!');
	addMorph: headerButtonsMorph.
	
	^firstRowLayoutMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:51:26' prior: 50994100!
buildShopHeader
	| firstRowLayoutMorph headerButtonsMorph |
		
	headerButtonsMorph := LayoutMorph newRow.
	headerButtonsMorph separation: 25;
	axisEdgeWeight: 1.0;
	morphExtent: self minimumExtent;
	addMorph: (LabelMorph contents: 'test1');
	addMorph: (LabelMorph contents: 'test2').
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.0;
	morphExtent: (self defaultExtent x)@(self defaultExtent y * 0.2) ;
	addMorph: (LabelMorph contents:'Welcome, ',username,'!!');
	addMorph: headerButtonsMorph.
	
	^firstRowLayoutMorph.! !

CatalogWindow allInstances!

CatalogWindow allInstances do: [:i | i close ]!

CatalogWindow allInstances do: [:i | i delete ]!

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !

----SNAPSHOT----(20 November 2021 20:52:19) CuisUniversity-4972.image priorSource: 21191775!
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:52:23' prior: 50994124!
buildShopHeader
	| firstRowLayoutMorph headerButtonsMorph |
		
	headerButtonsMorph := LayoutMorph newRow.
	headerButtonsMorph separation: 25;
	axisEdgeWeight: 1.0;
	morphExtent: self minimumExtent;
	addMorph: (LabelMorph contents: 'test1');
	addMorph: (LabelMorph contents: 'test2').
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 1;
	axisEdgeWeight: 0.0;
	morphExtent: (self defaultExtent x)@(self defaultExtent y * 0.2) ;
	addMorph: (LabelMorph contents:'Welcome, ',username,'!!');
	addMorph: headerButtonsMorph.
	
	^firstRowLayoutMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:52:31' prior: 50994155!
buildShopHeader
	| firstRowLayoutMorph headerButtonsMorph |
		
	headerButtonsMorph := LayoutMorph newRow.
	headerButtonsMorph separation: 25;
	axisEdgeWeight: 1.0;
	morphExtent: self minimumExtent;
	addMorph: (LabelMorph contents: 'test1');
	addMorph: (LabelMorph contents: 'test2').
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.0;
	morphExtent: (self defaultExtent x)@(self defaultExtent y * 0.2) ;
	addMorph: (LabelMorph contents:'Welcome, ',username,'!!');
	addMorph: headerButtonsMorph.
	
	^firstRowLayoutMorph.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:52:53' prior: 50993651!
buildShopBody
	| bodyLayoutMorph catalogMorph cartListMorph |
		
	catalogMorph := self buildCatalogMorph.
	"cartListMorph := self buildCartListMorph."
		
	bodyLayoutMorph := LayoutMorph newRow.
	bodyLayoutMorph separation: 25;
	axisEdgeWeight: 0.0;
	morphExtent: (self defaultExtent x)@(self defaultExtent y * 0.80) ;
	addMorph: catalogMorph.
	"addMorph: cartListMorph."
	
	^bodyLayoutMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:53:05' prior: 50994201!
buildShopBody
	| bodyLayoutMorph catalogMorph cartListMorph |
		
	catalogMorph := self buildCatalogMorph.
	"cartListMorph := self buildCartListMorph."
		
	bodyLayoutMorph := LayoutMorph newRow.
	bodyLayoutMorph separation: 25;
	axisEdgeWeight: 0.0;
	morphExtent: (self defaultExtent x)@(self defaultExtent y * 1) ;
	addMorph: catalogMorph.
	"addMorph: cartListMorph."
	
	^bodyLayoutMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:53:17' prior: 50994220!
buildShopBody
	| bodyLayoutMorph catalogMorph cartListMorph |
		
	catalogMorph := self buildCatalogMorph.
	"cartListMorph := self buildCartListMorph."
		
	bodyLayoutMorph := LayoutMorph newRow.
	bodyLayoutMorph separation: 25;
	axisEdgeWeight: 0.0;
	morphExtent: (self defaultExtent x)@(self defaultExtent y * 0.66) ;
	addMorph: catalogMorph.
	"addMorph: cartListMorph."
	
	^bodyLayoutMorph.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:53:29' prior: 50994238!
buildShopBody
	| bodyLayoutMorph catalogMorph cartListMorph |
		
	catalogMorph := self buildCatalogMorph.
	"cartListMorph := self buildCartListMorph."
		
	bodyLayoutMorph := LayoutMorph newRow.
	bodyLayoutMorph separation: 1;
	axisEdgeWeight: 0.0;
	morphExtent: (self defaultExtent x)@(self defaultExtent y * 0.66) ;
	addMorph: catalogMorph.
	"addMorph: cartListMorph."
	
	^bodyLayoutMorph.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:53:51' prior: 50994059!
buildCatalogMorph
	
	| catalogMorph p |
	
	catalogMorph := LayoutMorph newColumn.
	catalogMorph separation: 5; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogListHeader).
	20 timesRepeat: [catalogMorph addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN').].
	
	
	
	p := PluggableScrollPane new.
	p morphExtent: (self defaultExtent x*0.6)@(self defaultExtent y * 0.80);
	scroller: catalogMorph.
	^ p.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:54:04' prior: 50994254!
buildShopBody
	| bodyLayoutMorph catalogMorph cartListMorph |
		
	catalogMorph := self buildCatalogMorph.
	"cartListMorph := self buildCartListMorph."
		
	bodyLayoutMorph := LayoutMorph newRow.
	bodyLayoutMorph separation: 1;
	axisEdgeWeight: 0.0;
	morphExtent: (self defaultExtent x)@(self defaultExtent y * 0.80) ;
	addMorph: catalogMorph.
	"addMorph: cartListMorph."
	
	^bodyLayoutMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:54:20' prior: 50994270!
buildCatalogMorph
	
	| catalogMorph p |
	
	catalogMorph := LayoutMorph newColumn.
	catalogMorph separation: 5; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogListHeader).
	20 timesRepeat: [catalogMorph addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN').].
	
	
	
	p := PluggableScrollPane new.
	p morphExtent: (self defaultExtent x*0.6)@(self defaultExtent y * 0.60);
	scroller: catalogMorph.
	^ p.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:54:33' prior: 50994290!
buildShopBody
	| bodyLayoutMorph catalogMorph cartListMorph |
		
	catalogMorph := self buildCatalogMorph.
	"cartListMorph := self buildCartListMorph."
		
	bodyLayoutMorph := LayoutMorph newRow.
	bodyLayoutMorph separation: 1;
	axisEdgeWeight: 0.0;
	morphExtent: (self defaultExtent x)@(self defaultExtent y * 0.60) ;
	addMorph: catalogMorph.
	"addMorph: cartListMorph."
	
	^bodyLayoutMorph.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:54:41' prior: 50994179!
buildShopHeader
	| firstRowLayoutMorph headerButtonsMorph |
		
	headerButtonsMorph := LayoutMorph newRow.
	headerButtonsMorph separation: 25;
	axisEdgeWeight: 1.0;
	morphExtent: self minimumExtent;
	addMorph: (LabelMorph contents: 'test1');
	addMorph: (LabelMorph contents: 'test2').
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.0;
	morphExtent: (self defaultExtent x)@(self defaultExtent y * 0.1) ;
	addMorph: (LabelMorph contents:'Welcome, ',username,'!!');
	addMorph: headerButtonsMorph.
	
	^firstRowLayoutMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:55:57' prior: 50994345!
buildShopHeader
	| firstRowLayoutMorph headerButtonsMorph |
		
	headerButtonsMorph := LayoutMorph newRow.
	headerButtonsMorph separation: 25;
	axisEdgeWeight: 1.0;
	morphExtent: (self defaultExtent x*0.6)@(self defaultExtent y * 0.1) ;
	addMorph: (LabelMorph contents: 'test1');
	addMorph: (LabelMorph contents: 'test2').
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.0;
	morphExtent: (self defaultExtent x)@(self defaultExtent y * 0.1) ;
	addMorph: (LabelMorph contents:'Welcome, ',username,'!!');
	addMorph: headerButtonsMorph.
	
	^firstRowLayoutMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:56:31' prior: 50994329!
buildShopBody
	| bodyLayoutMorph catalogMorph cartListMorph |
		
	catalogMorph := self buildCatalogMorph.
	"cartListMorph := self buildCartListMorph."
		
	bodyLayoutMorph := LayoutMorph newRow.
	bodyLayoutMorph separation: 25;
	axisEdgeWeight: 0.0;
	morphExtent: (self defaultExtent x)@(self defaultExtent y * 0.60) ;
	addMorph: catalogMorph.
	"addMorph: cartListMorph."
	
	^bodyLayoutMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:57:14' prior: 50993271 overrides: 50928932!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 25;
	axisEdgeWeight: 0.0;
	morphExtent: self defaultExtent;
	addMorph: self buildShopHeader;
	addMorph: self buildShopBody.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:57:29' prior: 50994394!
buildShopBody
	| bodyLayoutMorph catalogMorph cartListMorph |
		
	catalogMorph := self buildCatalogMorph.
	"cartListMorph := self buildCartListMorph."
		
	bodyLayoutMorph := LayoutMorph newRow.
	bodyLayoutMorph separation: 1;
	axisEdgeWeight: 0.0;
	morphExtent: (self defaultExtent x)@(self defaultExtent y * 0.60) ;
	addMorph: catalogMorph.
	"addMorph: cartListMorph."
	
	^bodyLayoutMorph.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:57:40' prior: 50994369!
buildShopHeader
	| firstRowLayoutMorph headerButtonsMorph |
		
	headerButtonsMorph := LayoutMorph newRow.
	headerButtonsMorph separation: 25;
	axisEdgeWeight: 1.0;
	morphExtent: (self defaultExtent x*0.6)@(self defaultExtent y * 0.1) ;
	addMorph: (LabelMorph contents: 'test1');
	addMorph: (LabelMorph contents: 'test2').
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 1;
	axisEdgeWeight: 0.0;
	morphExtent: (self defaultExtent x)@(self defaultExtent y * 0.1) ;
	addMorph: (LabelMorph contents:'Welcome, ',username,'!!');
	addMorph: headerButtonsMorph.
	
	^firstRowLayoutMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:58:13' prior: 50994441!
buildShopHeader
	| firstRowLayoutMorph headerButtonsMorph |
		
	headerButtonsMorph := LayoutMorph newRow.
	headerButtonsMorph separation: 25;
	axisEdgeWeight: 1.0;
	morphExtent: (self defaultExtent x*0.6)@(self defaultExtent y * 0.1) ;
	addMorph: (LabelMorph contents: 'test1');
	addMorph: (LabelMorph contents: 'test2').
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 1;
	axisEdgeWeight: 0.0;
	morphExtent: (self defaultExtent x)@(self defaultExtent y * 0.0) ;
	addMorph: (LabelMorph contents:'Welcome, ',username,'!!');
	addMorph: headerButtonsMorph.
	
	^firstRowLayoutMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:58:25' prior: 50994466!
buildShopHeader
	| firstRowLayoutMorph headerButtonsMorph |
		
	headerButtonsMorph := LayoutMorph newRow.
	headerButtonsMorph separation: 25;
	axisEdgeWeight: 1.0;
	morphExtent: (self defaultExtent x*0.6)@(self defaultExtent y * 0.1) ;
	addMorph: (LabelMorph contents: 'test1');
	addMorph: (LabelMorph contents: 'test2').
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 1;
	axisEdgeWeight: 0.0;
	morphExtent: (self defaultExtent x)@(self defaultExtent y * 0.6) ;
	addMorph: (LabelMorph contents:'Welcome, ',username,'!!');
	addMorph: headerButtonsMorph.
	
	^firstRowLayoutMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:58:32' prior: 50994491!
buildShopHeader
	| firstRowLayoutMorph headerButtonsMorph |
		
	headerButtonsMorph := LayoutMorph newRow.
	headerButtonsMorph separation: 25;
	axisEdgeWeight: 1.0;
	morphExtent: (self defaultExtent x*0.6)@(self defaultExtent y * 0.1) ;
	addMorph: (LabelMorph contents: 'test1');
	addMorph: (LabelMorph contents: 'test2').
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 1;
	axisEdgeWeight: 0.0;
	morphExtent: (self defaultExtent x)@(self defaultExtent y * 0.1) ;
	addMorph: (LabelMorph contents:'Welcome, ',username,'!!');
	addMorph: headerButtonsMorph.
	
	^firstRowLayoutMorph.! !

----SNAPSHOT----(20 November 2021 20:58:34) CuisUniversity-4972.image priorSource: 21200021!

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 20:59:00' prior: 50994425!
buildShopBody
	| bodyLayoutMorph catalogMorph cartListMorph |
		
	catalogMorph := self buildCatalogMorph.
	"cartListMorph := self buildCartListMorph."
		
	bodyLayoutMorph := LayoutMorph newRow.
	bodyLayoutMorph separation: 1;
	axisEdgeWeight: 0.0;
	morphExtent: (self defaultExtent x)@(self defaultExtent y * 0.70) ;
	addMorph: catalogMorph.
	"addMorph: cartListMorph."
	
	^bodyLayoutMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 21:00:17' prior: 50994516!
buildShopHeader
	| firstRowLayoutMorph headerButtonsMorph |
		
	headerButtonsMorph := LayoutMorph newRow.
	headerButtonsMorph separation: 25;
	axisEdgeWeight: 1.0;
	morphExtent: (self defaultExtent x*0.6)@(self defaultExtent y * 0.1) ;
	addMorph: (LabelMorph contents: 'Purchase history');
	addMorph: (LabelMorph contents: 'Checkout').
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 1;
	axisEdgeWeight: 0.0;
	morphExtent: (self defaultExtent x)@(self defaultExtent y * 0.1) ;
	addMorph: (LabelMorph contents:'Welcome, ',username,'!!');
	addMorph: headerButtonsMorph.
	
	^firstRowLayoutMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 21:01:03' prior: 50993909!
buildCatalogItemMorphWithName: aBookName withISBN: anISBN

	| itemMorph |
	itemMorph := LayoutMorph newRow.
	itemMorph separation: 25; 
	axisEdgeWeight: 0.0;
	addMorph: ((LabelMorph contents:aBookName) morphExtent: (super morphExtent x*0.2)@(super morphExtent y) );
	addMorph: ((LabelMorph contents:anISBN) morphExtent: (super morphExtent x*0.2)@(super morphExtent y) ).

	^ itemMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 21:02:42' prior: 50994309!
buildCatalogMorph
	
	| catalogMorph p |
	
	catalogMorph := LayoutMorph newColumn.
	catalogMorph separation: 5; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogListHeader).
	20 timesRepeat: [catalogMorph addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN').].
	catalogMorph addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN').
	
	
	
	p := PluggableScrollPane new.
	p morphExtent: (self defaultExtent x*0.6)@(self defaultExtent y * 0.60);
	scroller: catalogMorph.
	^ p.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 21:02:55' prior: 50994607!
buildCatalogMorph
	
	| catalogMorph p |
	
	catalogMorph := LayoutMorph newColumn.
	catalogMorph separation: 5; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogListHeader).
	20 timesRepeat: [catalogMorph addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN').].
	
	
	p := PluggableScrollPane new.
	p morphExtent: (self defaultExtent x*0.6)@(self defaultExtent y * 0.60);
	scroller: catalogMorph.
	^ p.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 21:03:09' prior: 50994021!
buildCatalogListHeader
	
	| catalogMorph |
	
	catalogMorph := LayoutMorph newRow.
	catalogMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: ((LabelMorph contents:'Book name') morphExtent: (super morphExtent x*0.2)@(super morphExtent y*0.1) );
	addMorph: ((LabelMorph contents:'ISBN') morphExtent: (super morphExtent x*0.2)@(super morphExtent y) ).
	^ catalogMorph.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 21:03:13' prior: 50994646!
buildCatalogListHeader
	
	| catalogMorph |
	
	catalogMorph := LayoutMorph newRow.
	catalogMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: ((LabelMorph contents:'Book name') morphExtent: (super morphExtent x*0.2)@(super morphExtent y*0.1) );
	addMorph: ((LabelMorph contents:'ISBN') morphExtent: (super morphExtent x*0.2)@(super morphExtent y*0.1) ).
	^ catalogMorph.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 21:03:18' prior: 50994589!
buildCatalogItemMorphWithName: aBookName withISBN: anISBN

	| itemMorph |
	itemMorph := LayoutMorph newRow.
	itemMorph separation: 25; 
	axisEdgeWeight: 0.0;
	addMorph: ((LabelMorph contents:aBookName) morphExtent: (super morphExtent x*0.2)@(super morphExtent y*0.1) );
	addMorph: ((LabelMorph contents:anISBN) morphExtent: (super morphExtent x*0.2)@(super morphExtent y) ).

	^ itemMorph.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 21:03:21' prior: 50994676!
buildCatalogItemMorphWithName: aBookName withISBN: anISBN

	| itemMorph |
	itemMorph := LayoutMorph newRow.
	itemMorph separation: 25; 
	axisEdgeWeight: 0.0;
	addMorph: ((LabelMorph contents:aBookName) morphExtent: (super morphExtent x*0.2)@(super morphExtent y*0.1) );
	addMorph: ((LabelMorph contents:anISBN) morphExtent: (super morphExtent x*0.2)@(super morphExtent y*0.1) ).

	^ itemMorph.! !

----SNAPSHOT----(20 November 2021 21:03:26) CuisUniversity-4972.image priorSource: 21212389!

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 21:04:11' prior: 50994661!
buildCatalogListHeader
	
	| catalogMorph |
	
	catalogMorph := LayoutMorph newRow.
	catalogMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: ((LabelMorph contents:'Book name') morphExtent: (super morphExtent x*0.2)@self minimumExtent y);
	addMorph: ((LabelMorph contents:'ISBN') morphExtent: (super morphExtent x*0.2)@(super morphExtent y*0.1) ).
	^ catalogMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 21:04:42' prior: 50994714!
buildCatalogListHeader
	
	| catalogMorph |
	
	catalogMorph := LayoutMorph newRow.
	catalogMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: ((LabelMorph contents:'Book name') morphExtent: (super morphExtent x*0.2)@(self minimumExtent y));
	addMorph: ((LabelMorph contents:'ISBN') morphExtent: (super morphExtent x*0.2)@(self minimumExtent y) ).
	^ catalogMorph.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 21:04:44' prior: 50994732!
buildCatalogListHeader
	
	| catalogMorph |
	
	catalogMorph := LayoutMorph newRow.
	catalogMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: ((LabelMorph contents:'Book name') morphExtent: (super morphExtent x*0.2)@(self minimumExtent y) );
	addMorph: ((LabelMorph contents:'ISBN') morphExtent: (super morphExtent x*0.2)@(self minimumExtent y) ).
	^ catalogMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 21:04:58' prior: 50994747!
buildCatalogListHeader
	
	| catalogMorph |
	
	catalogMorph := LayoutMorph newRow.
	catalogMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: ((LabelMorph contents:'Book name') morphExtent: (super morphExtent x*0.2)@(super morphExtent y*0.1) );
	addMorph: ((LabelMorph contents:'ISBN') morphExtent: (super morphExtent x*0.2)@(super morphExtent y*0.1) ).
	^ catalogMorph.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 21:05:07' prior: 50994629!
buildCatalogMorph
	
	| catalogMorph p |
	
	catalogMorph := LayoutMorph newColumn.
	catalogMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogListHeader).
	20 timesRepeat: [catalogMorph addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN').].
	
	
	p := PluggableScrollPane new.
	p morphExtent: (self defaultExtent x*0.6)@(self defaultExtent y * 0.60);
	scroller: catalogMorph.
	^ p.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 21:05:35' prior: 50994780!
buildCatalogMorph
	
	| catalogMorph p |
	
	catalogMorph := LayoutMorph newColumn.
	catalogMorph separation: 1; 
	axisEdgeWeight: 0.0.
	catalogMorph addMorph: (self buildCatalogListHeader).
	20 timesRepeat: [catalogMorph addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN').].
	
	
	p := PluggableScrollPane new.
	p morphExtent: (self defaultExtent x*0.6)@(self defaultExtent y * 0.60);
	scroller: catalogMorph.
	^ p.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 21:05:57' prior: 50994799!
buildCatalogMorph
	
	| catalogMorph p |
	
	catalogMorph := LayoutMorph newColumn.
	catalogMorph separation: 1; 
	axisEdgeWeight: 0.0.
	catalogMorph addMorph: (self buildCatalogListHeader).
	20 timesRepeat: [catalogMorph addMorph: (self buildCatalogListHeader).].
	
	
	p := PluggableScrollPane new.
	p morphExtent: (self defaultExtent x*0.6)@(self defaultExtent y * 0.60);
	scroller: catalogMorph.
	^ p.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 21:06:03' prior: 50994819!
buildCatalogMorph
	
	| catalogMorph p |
	
	catalogMorph := LayoutMorph newColumn.
	catalogMorph separation: 1; 
	axisEdgeWeight: 0.0.
	catalogMorph addMorph: (self buildCatalogListHeader).
	20 timesRepeat: [catalogMorph addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN').].
	
	
	p := PluggableScrollPane new.
	p morphExtent: (self defaultExtent x*0.6)@(self defaultExtent y * 0.60);
	scroller: catalogMorph.
	^ p.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 21:06:25' prior: 50994692!
buildCatalogItemMorphWithName: aBookName withISBN: anISBN

	| itemMorph |
	itemMorph := LayoutMorph newRow.
	itemMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: ((LabelMorph contents:aBookName) morphExtent: (super morphExtent x*0.2)@(super morphExtent y*0.1) );
	addMorph: ((LabelMorph contents:anISBN) morphExtent: (super morphExtent x*0.2)@(super morphExtent y*0.1) ).

	^ itemMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 21:06:42' prior: 50994855!
buildCatalogItemMorphWithName: aBookName withISBN: anISBN

	| itemMorph |
	itemMorph := LayoutMorph newRow.
	itemMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: ((LabelMorph contents:aBookName) morphExtent: (super morphExtent x*0.2)@(super morphExtent y*0.01) );
	addMorph: ((LabelMorph contents:anISBN) morphExtent: (super morphExtent x*0.2)@(super morphExtent y*0.01) ).

	^ itemMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 21:06:57' prior: 50994874!
buildCatalogItemMorphWithName: aBookName withISBN: anISBN

	| itemMorph |
	itemMorph := LayoutMorph newRow.
	itemMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: ((LabelMorph contents:aBookName) morphExtent: (super morphExtent x*0.2)@(super morphExtent y*0.05) );
	addMorph: ((LabelMorph contents:anISBN) morphExtent: (super morphExtent x*0.2)@(super morphExtent y*0.05) ).

	^ itemMorph.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 21:07:06' prior: 50994765!
buildCatalogListHeader
	
	| catalogMorph |
	
	catalogMorph := LayoutMorph newRow.
	catalogMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: ((LabelMorph contents:'Book name') morphExtent: (super morphExtent x*0.2)@(super morphExtent y*0.06) );
	addMorph: ((LabelMorph contents:'ISBN') morphExtent: (super morphExtent x*0.2)@(super morphExtent y*0.06) ).
	^ catalogMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 21:07:48' prior: 50994909!
buildCatalogListHeader
	
	| catalogMorph |
	
	catalogMorph := LayoutMorph newRow.
	catalogMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: ((LabelMorph contents:'Book name') morphExtent: (super morphExtent x*0.2)@(super morphExtent y*0.06) );
	addMorph: ((LabelMorph contents:'ISBN') morphExtent: (super morphExtent x*0.2)@(super morphExtent y*0.06) ).
	^ catalogMorph.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 21:08:54' prior: 50994927!
buildCatalogListHeader
	
	| catalogMorph |
	
	catalogMorph := LayoutMorph newRow.
	catalogMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: ((LabelMorph contents:'Book name' font: Preferences bigFonts) morphExtent: (super morphExtent x*0.2)@(super morphExtent y*0.06) );
	addMorph: ((LabelMorph contents:'ISBN') morphExtent: (super morphExtent x*0.2)@(super morphExtent y*0.06) ).
	^ catalogMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 21:09:58' prior: 50994942!
buildCatalogListHeader
	
	| catalogMorph |
	
	catalogMorph := LayoutMorph newRow.
	catalogMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: ((LabelMorph contents:'Book name' font: Preferences standardFonts ) morphExtent: (super morphExtent x*0.2)@(super morphExtent y*0.06) );
	addMorph: ((LabelMorph contents:'ISBN') morphExtent: (super morphExtent x*0.2)@(super morphExtent y*0.06) ).
	^ catalogMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 21:10:26' prior: 50994966!
buildCatalogListHeader
	
	| catalogMorph |
	
	catalogMorph := LayoutMorph newRow.
	catalogMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: ((LabelMorph contents:'Book name' font: Preferences defaultFont22 ) morphExtent: (super morphExtent x*0.2)@(super morphExtent y*0.06) );
	addMorph: ((LabelMorph contents:'ISBN') morphExtent: (super morphExtent x*0.2)@(super morphExtent y*0.06) ).
	^ catalogMorph.! !

----SNAPSHOT----(20 November 2021 21:10:32) CuisUniversity-4972.image priorSource: 21217804!

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 21:10:56' prior: 50994985!
buildCatalogListHeader
	
	| catalogMorph |
	
	catalogMorph := LayoutMorph newRow.
	catalogMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: ((LabelMorph contents:'Book name' font: Preferences standardFonts ) morphExtent: (super morphExtent x*0.2)@(super morphExtent y*0.06) );
	addMorph: ((LabelMorph contents:'ISBN') morphExtent: (super morphExtent x*0.2)@(super morphExtent y*0.06) ).
	^ catalogMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 21:13:39' prior: 50995010!
buildCatalogListHeader
	
	| catalogMorph |
	
	catalogMorph := LayoutMorph newRow.
	catalogMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: ((LabelMorph contents:'Book name' font: FontFamily defaultFamilyName ) morphExtent: (super morphExtent x*0.2)@(super morphExtent y*0.06) );
	addMorph: ((LabelMorph contents:'ISBN') morphExtent: (super morphExtent x*0.2)@(super morphExtent y*0.06) ).
	^ catalogMorph.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 21:14:59' prior: 50995029!
buildCatalogListHeader
	
	| catalogMorph |
	
	catalogMorph := LayoutMorph newRow.
	catalogMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: ((LabelMorph contents:'Book name' font: FontFamily defaultFamilyName ) morphWidth: (super morphExtent x*0.2) );
	addMorph: ((LabelMorph contents:'ISBN') morphExtent: (super morphExtent x*0.2)@(super morphExtent y*0.06) ).
	^ catalogMorph.! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 21:15:20' prior: 50992664!
build4rdRow
	| thirdRowLayoutMorph |
	
	errorMessageMorph := LabelMorph contents: '' font: FontFamily defaultFamilyName emphasis: AbstractFont boldCode.
	errorMessageMorph color: Color red.
	
	thirdRowLayoutMorph := LayoutMorph newRow.
	thirdRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: self minimumExtent;
 	addMorph: errorMessageMorph.
	
	^thirdRowLayoutMorph.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 21:15:30' prior: 50995046!
buildCatalogListHeader
	
	| catalogMorph |
	
	catalogMorph := LayoutMorph newRow.
	catalogMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: ((LabelMorph contents:'Book name' font: FontFamily defaultFamilyName ) morphWidth: (super morphExtent x*0.2) );
	addMorph: ((LabelMorph contents:'ISBN') morphWidth: (super morphExtent x*0.2)  ).
	^ catalogMorph.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 21:20:13'!
buildCatalogListItem: aName
	
	| catalogMorph |
	
	catalogMorph := LabelMorph contents: aName font: FontFamily defaultFamilyName.
	catalogMorph morphWidth: (catalogMorph morphExtentInOwner x*0.2).! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 21:20:19' prior: 50995092!
buildCatalogListItem: aName
	
	| itemMorph |
	
	itemMorph := LabelMorph contents: aName font: FontFamily defaultFamilyName.
	itemMorph morphWidth: (itemMorph morphExtentInOwner x*0.2).! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 21:20:24' prior: 50995102!
buildCatalogListItem: aName
	
	| itemMorph |
	
	itemMorph := LabelMorph contents: aName font: FontFamily defaultFamilyName.
	itemMorph morphWidth: (itemMorph morphExtentInOwner x*0.2).
	^ itemMorph! !
!CatalogWindow methodsFor: 'catalog' stamp: 'MP 11/20/2021 21:21:14'!
buildCatalogTableItem: aName
	
	| itemMorph |
	
	itemMorph := LabelMorph contents: aName font: FontFamily defaultFamilyName.
	itemMorph morphWidth: (itemMorph morphExtentInOwner x*0.2).
	^ itemMorph! !

!methodRemoval: CatalogWindow #buildCatalogListItem: stamp: 'MP 11/20/2021 21:21:14'!
buildCatalogListItem: aName
	
	| itemMorph |
	
	itemMorph := LabelMorph contents: aName font: FontFamily defaultFamilyName.
	itemMorph morphWidth: (itemMorph morphExtentInOwner x*0.2).
	^ itemMorph!
!CatalogWindow methodsFor: 'catalog' stamp: 'MP 11/20/2021 21:21:42' prior: 50994893!
buildCatalogItemMorphWithName: aBookName withISBN: anISBN

	| itemMorph |
	itemMorph := LayoutMorph newRow.
	itemMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogTableItem: aBookName);
	addMorph: ((LabelMorph contents:anISBN) morphExtent: (super morphExtent x*0.2)@(super morphExtent y*0.05) ).

	^ itemMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'catalog' stamp: 'MP 11/20/2021 21:23:05' prior: 50995078!
buildCatalogListHeader
	
	| catalogMorph |
	
	catalogMorph := LayoutMorph newRow.
	catalogMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: ((LabelMorph contents:'Book name' font: FontFamily defaultFamilyAndPointSize ) morphWidth: (super morphExtent x*0.2) );
	addMorph: ((LabelMorph contents:'ISBN') morphWidth: (super morphExtent x*0.2)  ).
	^ catalogMorph.! !
!CatalogWindow methodsFor: 'catalog' stamp: 'MP 11/20/2021 21:23:12' prior: 50995120!
buildCatalogTableItem: aName
	
	| itemMorph |
	
	itemMorph := LabelMorph contents: aName font: FontFamily defaultFamilyAndPointSize.
	itemMorph morphWidth: (itemMorph morphExtentInOwner x*0.2).
	^ itemMorph! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 21:23:14' prior: 50995062!
build4rdRow
	| thirdRowLayoutMorph |
	
	errorMessageMorph := LabelMorph contents: '' font: FontFamily defaultFamilyAndPointSize emphasis: AbstractFont boldCode.
	errorMessageMorph color: Color red.
	
	thirdRowLayoutMorph := LayoutMorph newRow.
	thirdRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: self minimumExtent;
 	addMorph: errorMessageMorph.
	
	^thirdRowLayoutMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !

----SNAPSHOT----(20 November 2021 21:23:23) CuisUniversity-4972.image priorSource: 21227195!
!CatalogWindow methodsFor: 'catalog' stamp: 'MP 11/20/2021 21:23:40' prior: 50995138!
buildCatalogItemMorphWithName: aBookName withISBN: anISBN

	| itemMorph |
	itemMorph := LayoutMorph newRow.
	itemMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogTableItem: aBookName);
	addMorph: (self buildCatalogTableItem: anISBN).

	^ itemMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'catalog' stamp: 'MP 11/20/2021 21:24:22' prior: 50995154!
buildCatalogListHeader
	
	| catalogMorph |
	
	catalogMorph := LayoutMorph newRow.
	catalogMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogTableItem: 'Book name');
	addMorph: (self buildCatalogTableItem: 'ISBN').
	^ catalogMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'catalog' stamp: 'MP 11/20/2021 21:24:42' prior: 50995169!
buildCatalogTableItem: aName
	
	| itemMorph |
	
	itemMorph := LabelMorph contents: aName font: FontFamily defaultFamilyAndPointSize.
	itemMorph morphWidth: (itemMorph morphExtentInOwner x).
	^ itemMorph! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'catalog' stamp: 'MP 11/20/2021 21:25:02' prior: 50995228!
buildCatalogTableItem: aName
	
	| itemMorph |
	
	itemMorph := LabelMorph contents: aName font: FontFamily defaultFamilyAndPointSize.
	itemMorph morphWidth: (itemMorph morphExtentInOwner x*0.25).
	^ itemMorph! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'catalog' stamp: 'MP 11/20/2021 21:26:16' prior: 50994838!
buildCatalogMorph
	
	| catalogMorph p |
	
	catalogMorph := LayoutMorph newColumn.
	catalogMorph separation: 1; 
	morphExtent: catalogMorph morphExtentInOwner;
	axisEdgeWeight: 0.0.
	catalogMorph addMorph: (self buildCatalogListHeader).
	20 timesRepeat: [catalogMorph addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN').].
	
	
	p := PluggableScrollPane new.
	p morphExtent: (self defaultExtent x*0.6)@(self defaultExtent y * 0.60);
	scroller: catalogMorph.
	^ p.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'catalog' stamp: 'MP 11/20/2021 21:26:42' prior: 50995252!
buildCatalogMorph
	
	| catalogMorph p |
	
	catalogMorph := LayoutMorph newColumn.
	catalogMorph separation: 1; 
	morphExtent: catalogMorph morphExtentInOwner;
	axisEdgeWeight: 0.0.
	catalogMorph addMorph: (self buildCatalogListHeader).
	20 timesRepeat: [catalogMorph addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN').].
	
	
	p := PluggableScrollPane new.
	p morphExtent: catalogMorph morphExtentInOwner;
	"p morphExtent: (self defaultExtent x*0.6)@(self defaultExtent y * 0.60);"
	scroller: catalogMorph.
	^ p.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'catalog' stamp: 'MP 11/20/2021 21:27:06' prior: 50995273!
buildCatalogMorph
	
	| catalogMorph p |
	
	catalogMorph := LayoutMorph newColumn.
	catalogMorph separation: 1; 
	morphExtent: catalogMorph morphExtentInOwner;
	axisEdgeWeight: 0.0.
	catalogMorph addMorph: (self buildCatalogListHeader).
	20 timesRepeat: [catalogMorph addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN').].
	
	
	p := PluggableScrollPane new.
	p morphExtent: (self defaultExtent x*0.6)@(self defaultExtent y * 0.60);
	scroller: catalogMorph.
	^ p.! !
!CatalogWindow methodsFor: 'catalog' stamp: 'MP 11/20/2021 21:27:31' prior: 50995296!
buildCatalogMorph
	
	| catalogMorph p |
	
	catalogMorph := LayoutMorph newColumn.
	p := PluggableScrollPane new.
	p morphExtent: (self defaultExtent x*0.6)@(self defaultExtent y * 0.60);
	scroller: catalogMorph.
	
	catalogMorph separation: 1; 
	morphExtent: catalogMorph morphExtentInOwner;
	axisEdgeWeight: 0.0.
	catalogMorph addMorph: (self buildCatalogListHeader).
	20 timesRepeat: [catalogMorph addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN').].
	
	^ p.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'catalog' stamp: 'MP 11/20/2021 21:29:49'!
buildCatalogTableItem: aName ownerWidth: aWidth 
	
	| itemMorph |
	
	itemMorph := LabelMorph contents: aName font: FontFamily defaultFamilyAndPointSize.
	itemMorph morphWidth: (itemMorph morphExtentInOwner x*0.25).
	^ itemMorph! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 21:29:49' prior: 50995214!
buildCatalogListHeader
	
	| catalogMorph |
	
	catalogMorph := LayoutMorph newRow.
	catalogMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogTableItem: 'Book name' ownerWidth: item morphExtent);
	addMorph: (self buildCatalogTableItem: 'ISBN' ownerWidth: item morphExtent).
	^ catalogMorph.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 21:29:49' prior: 50995200!
buildCatalogItemMorphWithName: aBookName withISBN: anISBN

	| itemMorph |
	itemMorph := LayoutMorph newRow.
	itemMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogTableItem: aBookName ownerWidth: item morphExtent);
	addMorph: (self buildCatalogTableItem: anISBN ownerWidth: item morphExtent).

	^ itemMorph.! !

!methodRemoval: CatalogWindow #buildCatalogTableItem: stamp: 'MP 11/20/2021 21:29:49'!
buildCatalogTableItem: aName
	
	| itemMorph |
	
	itemMorph := LabelMorph contents: aName font: FontFamily defaultFamilyAndPointSize.
	itemMorph morphWidth: (itemMorph morphExtentInOwner x*0.25).
	^ itemMorph!
!CatalogWindow methodsFor: 'catalog' stamp: 'MP 11/20/2021 21:30:06' prior: 50995358!
buildCatalogItemMorphWithName: aBookName withISBN: anISBN

	| itemMorph |
	itemMorph := LayoutMorph newRow.
	itemMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogTableItem: aBookName ownerWidth: itemMorph morphExtent);
	addMorph: (self buildCatalogTableItem: anISBN ownerWidth: itemMorph morphExtent).

	^ itemMorph.! !
!CatalogWindow methodsFor: 'catalog' stamp: 'MP 11/20/2021 21:30:17' prior: 50995345!
buildCatalogListHeader
	
	| catalogMorph |
	
	catalogMorph := LayoutMorph newRow.
	catalogMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogTableItem: 'Book name' ownerWidth: catalogMorph morphExtent);
	addMorph: (self buildCatalogTableItem: 'ISBN' ownerWidth: catalogMorph morphExtent).
	^ catalogMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'catalog' stamp: 'MP 11/20/2021 21:30:37' prior: 50995334!
buildCatalogTableItem: aName ownerWidth: aWidth 
	
	| itemMorph |
	
	itemMorph := LabelMorph contents: aName font: FontFamily defaultFamilyAndPointSize.
	itemMorph morphWidth: (aWidth *0.25).
	^ itemMorph! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'catalog' stamp: 'MP 11/20/2021 21:31:00'!
buildCatalogTableItem: aName ownerExtent: aWidth 
	
	| itemMorph |
	
	itemMorph := LabelMorph contents: aName font: FontFamily defaultFamilyAndPointSize.
	itemMorph morphWidth: (aWidth *0.25).
	^ itemMorph! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 21:31:00' prior: 50995381!
buildCatalogItemMorphWithName: aBookName withISBN: anISBN

	| itemMorph |
	itemMorph := LayoutMorph newRow.
	itemMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogTableItem: aBookName ownerExtent: itemMorph morphExtent);
	addMorph: (self buildCatalogTableItem: anISBN ownerExtent: itemMorph morphExtent).

	^ itemMorph.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 21:31:00' prior: 50995395!
buildCatalogListHeader
	
	| catalogMorph |
	
	catalogMorph := LayoutMorph newRow.
	catalogMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogTableItem: 'Book name' ownerExtent: catalogMorph morphExtent);
	addMorph: (self buildCatalogTableItem: 'ISBN' ownerExtent: catalogMorph morphExtent).
	^ catalogMorph.! !

!methodRemoval: CatalogWindow #buildCatalogTableItem:ownerWidth: stamp: 'MP 11/20/2021 21:31:00'!
buildCatalogTableItem: aName ownerWidth: aWidth 
	
	| itemMorph |
	
	itemMorph := LabelMorph contents: aName font: FontFamily defaultFamilyAndPointSize.
	itemMorph morphWidth: (aWidth *0.25).
	^ itemMorph!
!CatalogWindow methodsFor: 'catalog' stamp: 'MP 11/20/2021 21:31:06' prior: 50995423!
buildCatalogTableItem: aName ownerExtent: anExtent 
	
	| itemMorph |
	
	itemMorph := LabelMorph contents: aName font: FontFamily defaultFamilyAndPointSize.
	itemMorph morphWidth: (anExtent x *0.25).
	^ itemMorph! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !

----SNAPSHOT----(20 November 2021 21:32:09) CuisUniversity-4972.image priorSource: 21233472!
!CatalogWindow methodsFor: 'catalog' stamp: 'MP 11/20/2021 21:32:50' prior: 50995314!
buildCatalogMorph
	
	| catalogMorph p |
	
	catalogMorph := LayoutMorph newColumn.
	p := PluggableScrollPane new.
	p morphExtent: (self defaultExtent x*0.6)@(self defaultExtent y * 0.60);
	scroller: catalogMorph.
	
	catalogMorph separation: 1; 
	morphExtent: catalogMorph morphExtent;
	axisEdgeWeight: 0.0.
	catalogMorph addMorph: (self buildCatalogListHeader).
	20 timesRepeat: [catalogMorph addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN').].
	
	^ p.! !
!CatalogWindow methodsFor: 'catalog' stamp: 'MP 11/20/2021 21:33:25'!
buildCatalogItemMorphWithName: aBookName withISBN: anISBN withExtent: anExtent 

	| itemMorph |
	itemMorph := LayoutMorph newRow.
	itemMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogTableItem: aBookName ownerExtent: itemMorph morphExtent);
	addMorph: (self buildCatalogTableItem: anISBN ownerExtent: itemMorph morphExtent).

	^ itemMorph.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 21:33:25' prior: 50995485!
buildCatalogMorph
	
	| catalogMorph p |
	
	catalogMorph := LayoutMorph newColumn.
	p := PluggableScrollPane new.
	p morphExtent: (self defaultExtent x*0.6)@(self defaultExtent y * 0.60);
	scroller: catalogMorph.
	
	catalogMorph separation: 1; 
	morphExtent: catalogMorph morphExtent;
	axisEdgeWeight: 0.0.
	catalogMorph addMorph: (self buildCatalogListHeader).
	20 timesRepeat: [catalogMorph addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN' withExtent: morphExtent).].
	
	^ p.! !

!methodRemoval: CatalogWindow #buildCatalogItemMorphWithName:withISBN: stamp: 'MP 11/20/2021 21:33:25'!
buildCatalogItemMorphWithName: aBookName withISBN: anISBN

	| itemMorph |
	itemMorph := LayoutMorph newRow.
	itemMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogTableItem: aBookName ownerExtent: itemMorph morphExtent);
	addMorph: (self buildCatalogTableItem: anISBN ownerExtent: itemMorph morphExtent).

	^ itemMorph.!
!CatalogWindow methodsFor: 'catalog' stamp: 'MP 11/20/2021 21:33:33' prior: 50995518!
buildCatalogMorph
	
	| catalogMorph p |
	
	catalogMorph := LayoutMorph newColumn.
	p := PluggableScrollPane new.
	p morphExtent: (self defaultExtent x*0.6)@(self defaultExtent y * 0.60);
	scroller: catalogMorph.
	
	catalogMorph separation: 1; 
	morphExtent: catalogMorph morphExtent;
	axisEdgeWeight: 0.0.
	catalogMorph addMorph: (self buildCatalogListHeader).
	20 timesRepeat: [catalogMorph addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN' withExtent: p morphExtent).].
	
	^ p.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'catalog' stamp: 'MP 11/20/2021 21:34:13' prior: 50995503!
buildCatalogItemMorphWithName: aBookName withISBN: anISBN withExtent: anExtent 

	| itemMorph |
	itemMorph := LayoutMorph newRow.
	itemMorph separation: 1; 
	morphExtent: anExtent; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogTableItem: aBookName ownerExtent: itemMorph morphExtent);
	addMorph: (self buildCatalogTableItem: anISBN ownerExtent: itemMorph morphExtent).

	^ itemMorph.! !
!CatalogWindow methodsFor: 'catalog' stamp: 'MP 11/20/2021 21:34:32' prior: 50995573!
buildCatalogItemMorphWithName: aBookName withISBN: anISBN withExtent: anExtent 

	| itemMorph |
	itemMorph := LayoutMorph newRow.
	itemMorph separation: 1; 
	morphWidth: anExtent x; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogTableItem: aBookName ownerExtent: itemMorph morphExtent);
	addMorph: (self buildCatalogTableItem: anISBN ownerExtent: itemMorph morphExtent).

	^ itemMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'catalog' stamp: 'MP 11/20/2021 21:35:13'!
buildCatalogListHeader: anExtent
	
	| catalogMorph |
	
	catalogMorph := LayoutMorph newRow.
	catalogMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogTableItem: 'Book name' ownerExtent: catalogMorph morphExtent);
	addMorph: (self buildCatalogTableItem: 'ISBN' ownerExtent: catalogMorph morphExtent).
	^ catalogMorph.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 21:35:13' prior: 50995551!
buildCatalogMorph
	
	| catalogMorph p |
	
	catalogMorph := LayoutMorph newColumn.
	p := PluggableScrollPane new.
	p morphExtent: (self defaultExtent x*0.6)@(self defaultExtent y * 0.60);
	scroller: catalogMorph.
	
	catalogMorph separation: 1; 
	morphExtent: catalogMorph morphExtent;
	axisEdgeWeight: 0.0.
	catalogMorph addMorph: (self buildCatalogListHeader: morphExtent).
	20 timesRepeat: [catalogMorph addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN' withExtent: p morphExtent).].
	
	^ p.! !

!methodRemoval: CatalogWindow #buildCatalogListHeader stamp: 'MP 11/20/2021 21:35:13'!
buildCatalogListHeader
	
	| catalogMorph |
	
	catalogMorph := LayoutMorph newRow.
	catalogMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogTableItem: 'Book name' ownerExtent: catalogMorph morphExtent);
	addMorph: (self buildCatalogTableItem: 'ISBN' ownerExtent: catalogMorph morphExtent).
	^ catalogMorph.!
!CatalogWindow methodsFor: 'catalog' stamp: 'MP 11/20/2021 21:35:25'!
buildCatalogListHeaderWithExtent: anExtent
	
	| catalogMorph |
	
	catalogMorph := LayoutMorph newRow.
	catalogMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogTableItem: 'Book name' ownerExtent: catalogMorph morphExtent);
	addMorph: (self buildCatalogTableItem: 'ISBN' ownerExtent: catalogMorph morphExtent).
	^ catalogMorph.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 21:35:25' prior: 50995620!
buildCatalogMorph
	
	| catalogMorph p |
	
	catalogMorph := LayoutMorph newColumn.
	p := PluggableScrollPane new.
	p morphExtent: (self defaultExtent x*0.6)@(self defaultExtent y * 0.60);
	scroller: catalogMorph.
	
	catalogMorph separation: 1; 
	morphExtent: catalogMorph morphExtent;
	axisEdgeWeight: 0.0.
	catalogMorph addMorph: (self buildCatalogListHeaderWithExtent: morphExtent).
	20 timesRepeat: [catalogMorph addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN' withExtent: p morphExtent).].
	
	^ p.! !

!methodRemoval: CatalogWindow #buildCatalogListHeader: stamp: 'MP 11/20/2021 21:35:25'!
buildCatalogListHeader: anExtent
	
	| catalogMorph |
	
	catalogMorph := LayoutMorph newRow.
	catalogMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogTableItem: 'Book name' ownerExtent: catalogMorph morphExtent);
	addMorph: (self buildCatalogTableItem: 'ISBN' ownerExtent: catalogMorph morphExtent).
	^ catalogMorph.!
!CatalogWindow methodsFor: 'catalog' stamp: 'MP 11/20/2021 21:35:36' prior: 50995652!
buildCatalogListHeaderWithExtent: anExtent
	
	| catalogMorph |
	
	catalogMorph := LayoutMorph newRow.
	catalogMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogTableItem: 'Book name' ownerExtent: anExtent);
	addMorph: (self buildCatalogTableItem: 'ISBN' ownerExtent: anExtent).
	^ catalogMorph.! !
!CatalogWindow methodsFor: 'catalog' stamp: 'MP 11/20/2021 21:35:55' prior: 50995667!
buildCatalogMorph
	
	| catalogMorph p |
	
	catalogMorph := LayoutMorph newColumn.
	p := PluggableScrollPane new.
	p morphExtent: (self defaultExtent x*0.6)@(self defaultExtent y * 0.60);
	scroller: catalogMorph.
	
	catalogMorph separation: 1; 
	morphExtent: catalogMorph morphExtent;
	axisEdgeWeight: 0.0.
	catalogMorph addMorph: (self buildCatalogListHeaderWithExtent: p morphExtent).
	20 timesRepeat: [catalogMorph addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN' withExtent: p morphExtent).].
	
	^ p.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !

----SNAPSHOT----(20 November 2021 21:36:00) CuisUniversity-4972.image priorSource: 21242603!

----STARTUP---- (20 November 2021 22:02:08) as D:\001.Maca\2c2021\inge1\qa3\CuisUniversity-4972.image!


CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 22:17:50'!
buildCounterMorph
! !

|s|
s _ String new.
s setValue: '90'.
s value.!

!classDefinition: #ItemCounter category: 'TusLibros-Graphics' stamp: 'MP 11/20/2021 22:25:34'!
Object subclass: #ItemCounter
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Graphics'!
!CatalogWindow methodsFor: 'catalog' stamp: 'MP 11/20/2021 22:25:28' prior: 50995470!
buildCatalogTableItem: aName ownerExtent: anExtent 
	
	| itemMorph string |
	
	string _ String new.  
	itemMorph := TextModelMorph textProvider: ItemCounter new textGetter: #value textSetter: #value:. 
	itemMorph morphWidth: (anExtent x *0.25).
	^ itemMorph! !
!CatalogWindow methodsFor: 'catalog' stamp: 'MP 11/20/2021 22:25:43' prior: 50995757!
buildCatalogTableItem: aName ownerExtent: anExtent 
	
	| itemMorph |
	
	itemMorph := TextModelMorph textProvider: ItemCounter new textGetter: #value textSetter: #value:. 
	itemMorph morphWidth: (anExtent x *0.25).
	^ itemMorph! !

!classDefinition: #ItemCounter category: 'TusLibros-Graphics' stamp: 'MP 11/20/2021 22:26:08'!
Object subclass: #ItemCounter
	instanceVariableNames: 'value'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Graphics'!
!ItemCounter methodsFor: 'no messages' stamp: 'MP 11/20/2021 22:26:07' overrides: 16896425!
initialize
	value _ 0! !
!ItemCounter methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 22:26:15' overrides: 16881508!
value
	^ value.! !
!ItemCounter methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 22:30:29'!
value: aValue
	[
		|num|
		num _ aValue asNumber asInteger.
		value _ num. 
	] onError: [^ value].
	^ value.! !
!ItemCounter methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 22:31:15' prior: 50995794!
value: aValue
	[
		|num|
		num _ aValue asNumber asInteger.
		value _ num. 
	] on: Error do: [^ value].
	^ value.! !
!ItemCounter methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 22:31:26' prior: 50995801!
value: aValue
	[
		|num|
		num _ aValue asNumber asInteger.
		value _ num. 
	] on: Error do: [].
	^ value.! !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 22:32:53' prior: 50995744!
buildCounterMorph
	| numberInputMorph |
	numberInputMorph := TextModelMorph textProvider: ItemCounter new textGetter: #value textSetter: #value:.
	 ! !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 22:34:33' prior: 50995815!
buildCounterMorph
	| numberInputMorph counterMorph |
	
	numberInputMorph := TextModelMorph textProvider: ItemCounter new textGetter: #value textSetter: #value:.
	numberInputMorph morphExtent: 50@50.
	
	counterMorph := LayoutMorph newRow. 
	counterMorph separation: 0.1;
	morphExtent: 100@50;
	addMorph: numberInputMorph.! !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 22:34:40' prior: 50995823!
buildCounterMorph
	| numberInputMorph counterMorph |
	
	numberInputMorph := TextModelMorph textProvider: ItemCounter new textGetter: #value textSetter: #value:.
	numberInputMorph morphExtent: 50@50.
	
	counterMorph := LayoutMorph newRow. 
	counterMorph separation: 0.1;
	morphExtent: 100@50;
	addMorph: numberInputMorph.
	
	^ counterMorph! !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 22:34:41' prior: 50995836!
buildCounterMorph
	| numberInputMorph counterMorph |
	
	numberInputMorph := TextModelMorph textProvider: ItemCounter new textGetter: #value textSetter: #value:.
	numberInputMorph morphExtent: 50@50.
	
	counterMorph := LayoutMorph newRow. 
	counterMorph separation: 0.1;
	morphExtent: 100@50;
	addMorph: numberInputMorph.
	
	^ counterMorph.! !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 22:36:49' prior: 50995850!
buildCounterMorph
	| numberInputMorph counterMorph arrowDown arrowUp counter |
	
	counter _ ItemCounter new.
	numberInputMorph := TextModelMorph textProvider: counter textGetter: #value textSetter: #value:.
	numberInputMorph morphExtent: 50@50.
	
	arrowUp := PluggableButtonMorph model: counter stateGetter: nil action: #valUp  label: '^'.
	arrowUp morphExtent: 50@25. 
	
	arrowDown := PluggableButtonMorph model: counter stateGetter: nil action: #valDown  label: 'v'.
	arrowDown morphExtent: 50@25.
	
	counterMorph := LayoutMorph newRow. 
	counterMorph separation: 0.1;
	morphExtent: 100@50;
	addMorph: numberInputMorph.
	
	^ counterMorph.! !
!ItemCounter methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 22:37:14'!
valueUp
	value _ value +1.
	^ value.! !
!ItemCounter methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 22:37:20'!
valueDown
	value _ value -1.
	^ value.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'catalog' stamp: 'MP 11/20/2021 21:31:06' prior: 50995768!
buildCatalogTableItem: aName ownerExtent: anExtent 
	
	| itemMorph |
	
	itemMorph := LabelMorph contents: aName font: FontFamily defaultFamilyAndPointSize.
	itemMorph morphWidth: (anExtent x *0.25).
	^ itemMorph! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'catalog' stamp: 'MP 11/20/2021 22:39:13' prior: 50995588!
buildCatalogItemMorphWithName: aBookName withISBN: anISBN withExtent: anExtent 

	| itemMorph |
	itemMorph := LayoutMorph newRow.
	itemMorph separation: 1; 
	morphWidth: anExtent x; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogTableItem: aBookName ownerExtent: itemMorph morphExtent);
	addMorph: (self buildCatalogTableItem: anISBN ownerExtent: itemMorph morphExtent);
	addMorph: (self buildCounterMorph).

	^ itemMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!ItemCounter methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 22:47:15' prior: 50995786 overrides: 16896425!
initialize
	value _ '0'! !
!ItemCounter methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 22:47:30' prior: 50995891!
valueDown
	value _ value asNumber asInteger -1.
	^ value.! !
!ItemCounter methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 22:47:39' prior: 50995941!
valueDown
	value _ (value asNumber asInteger -1) asString.
	^ value.! !
!ItemCounter methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 22:47:48' prior: 50995887!
valueUp
	value _ (value asNumber asInteger -1) asString..
	^ value.! !
!ItemCounter methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 22:47:49' prior: 50995952!
valueUp
	value _ (value asNumber asInteger -1) asString.
	^ value.! !
!ItemCounter methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 22:48:00' prior: 50995808!
value: aValue
	[
		|num|
		num _ aValue asNumber asInteger.
		value _ num asString. 
	] on: Error do: [].
	^ value.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !

!classRenamed: #ItemCounter as: #ItemCounterModel stamp: 'MP 11/20/2021 22:48:24'!
Smalltalk renameClassNamed: #ItemCounter as: #ItemCounterModel!
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 22:48:24' prior: 50995864!
buildCounterMorph
	| numberInputMorph counterMorph arrowDown arrowUp counter |
	
	counter _ ItemCounterModel new.
	numberInputMorph := TextModelMorph textProvider: counter textGetter: #value textSetter: #value:.
	numberInputMorph morphExtent: 50@50.
	
	arrowUp := PluggableButtonMorph model: counter stateGetter: nil action: #valUp  label: '^'.
	arrowUp morphExtent: 50@25. 
	
	arrowDown := PluggableButtonMorph model: counter stateGetter: nil action: #valDown  label: 'v'.
	arrowDown morphExtent: 50@25.
	
	counterMorph := LayoutMorph newRow. 
	counterMorph separation: 0.1;
	morphExtent: 100@50;
	addMorph: numberInputMorph.
	
	^ counterMorph.! !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 22:48:48' prior: 50995979!
buildCounterMorph
	| numberInputMorph counterMorph arrowDown arrowUp counter |
	
	counter _ ItemCounterModel new.
	numberInputMorph := TextModelMorph textProvider: counter textGetter: #value textSetter: #value:.
	numberInputMorph morphExtent: 50@20.
	
	arrowUp := PluggableButtonMorph model: counter stateGetter: nil action: #valUp  label: '^'.
	arrowUp morphExtent: 25@10. 
	
	arrowDown := PluggableButtonMorph model: counter stateGetter: nil action: #valDown  label: 'v'.
	arrowDown morphExtent: 25@10.
	
	counterMorph := LayoutMorph newRow. 
	counterMorph separation: 0.1;
	morphExtent: 100@50;
	addMorph: numberInputMorph.
	
	^ counterMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 22:49:36' prior: 50996003!
buildCounterMorph
	| numberInputMorph counterMorph arrowDown arrowUp counter |
	
	counter _ ItemCounterModel new.
	numberInputMorph := TextModelMorph textProvider: counter textGetter: #value textSetter: #value:.
	numberInputMorph morphExtent: 50@20; axisEdgeWeight: 0.5.
	
	arrowUp := PluggableButtonMorph model: counter stateGetter: nil action: #valUp  label: '^'.
	arrowUp morphExtent: 25@10. 
	
	arrowDown := PluggableButtonMorph model: counter stateGetter: nil action: #valDown  label: 'v'.
	arrowDown morphExtent: 25@10.
	
	counterMorph := LayoutMorph newRow. 
	counterMorph separation: 0.1;
	morphExtent: 100@50;
	addMorph: numberInputMorph.
	
	^ counterMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 22:50:24' prior: 50996029!
buildCounterMorph
	| numberInputMorph counterMorph arrowDown arrowUp counter |
	
	counter _ ItemCounterModel new.
	numberInputMorph := TextModelMorph textProvider: counter textGetter: #value textSetter: #value:.
	numberInputMorph morphExtent: 50@20.
	
	arrowUp := PluggableButtonMorph model: counter stateGetter: nil action: #valUp  label: '^'.
	arrowUp morphExtent: 25@10. 
	
	arrowDown := PluggableButtonMorph model: counter stateGetter: nil action: #valDown  label: 'v'.
	arrowDown morphExtent: 25@10.
	
	counterMorph := LayoutMorph newRow. 
	counterMorph separation: 0.1;
	morphExtent: 100@50;
	addMorph: numberInputMorph.
	
	^ counterMorph.! !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 22:50:38' prior: 50996056!
buildCounterMorph
	| numberInputMorph counterMorph arrowDown arrowUp counter |
	
	counter _ ItemCounterModel new.
	numberInputMorph := TextModelMorph textProvider: counter textGetter: #value textSetter: #value:.
	numberInputMorph morphExtent: 50@20.
	
	arrowUp := PluggableButtonMorph model: counter stateGetter: nil action: #valUp  label: 'hola'.
	arrowUp morphExtent: 25@10. 
	
	arrowDown := PluggableButtonMorph model: counter stateGetter: nil action: #valDown  label: 'chau'.
	arrowDown morphExtent: 25@10.
	
	counterMorph := LayoutMorph newRow. 
	counterMorph separation: 0.1;
	morphExtent: 100@50;
	addMorph: numberInputMorph.
	
	^ counterMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 22:50:49' prior: 50996080!
buildCounterMorph
	| numberInputMorph counterMorph arrowDown arrowUp counter |
	
	counter _ ItemCounterModel new.
	numberInputMorph := TextModelMorph textProvider: counter textGetter: #value textSetter: #value:.
	numberInputMorph morphExtent: 50@20.
	
	arrowUp := PluggableButtonMorph model: counter stateGetter: nil action: #valUp  label: '^'.
	arrowUp morphExtent: 25@10. 
	
	arrowDown := PluggableButtonMorph model: counter stateGetter: nil action: #valDown  label: 'v'.
	arrowDown morphExtent: 25@10.
	
	counterMorph := LayoutMorph newRow. 
	counterMorph separation: 0.1;
	morphExtent: 100@50;
	addMorph: numberInputMorph.
	
	^ counterMorph.! !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 22:51:04' prior: 50996106!
buildCounterMorph
	| numberInputMorph counterMorph arrowDown arrowUp counter |
	
	counter _ ItemCounterModel new.
	numberInputMorph := TextModelMorph textProvider: counter textGetter: #value textSetter: #value:.
	numberInputMorph morphExtent: 50@20.
	
	arrowUp := PluggableButtonMorph model: counter stateGetter: nil action: #valUp  label: '^'.
	arrowUp morphExtent: 25@10. 
	
	arrowDown := PluggableButtonMorph model: counter stateGetter: nil action: #valDown  label: 'v'.
	arrowDown morphExtent: 25@10.
	
	counterMorph := LayoutMorph newRow. 
	counterMorph separation: 0.1;
	morphExtent: 100@50;
	addMorph: numberInputMorph;
	addMorph: arrowUp;
	addMorph: arrowDown.
	
	^ counterMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 22:51:27' prior: 50996130!
buildCounterMorph
	| numberInputMorph counterMorph arrowDown arrowUp counter |
	
	counter _ ItemCounterModel new.
	numberInputMorph := TextModelMorph textProvider: counter textGetter: #value textSetter: #value:.
	numberInputMorph morphExtent: 50@20.
	
	arrowUp := PluggableButtonMorph model: counter stateGetter: nil action: #valueUp  label: '^'.
	arrowUp morphExtent: 25@10. 
	
	arrowDown := PluggableButtonMorph model: counter stateGetter: nil action: #valueDown  label: 'v'.
	arrowDown morphExtent: 25@10.
	
	counterMorph := LayoutMorph newRow. 
	counterMorph separation: 0.1;
	morphExtent: 100@50;
	addMorph: numberInputMorph;
	addMorph: arrowUp;
	addMorph: arrowDown.
	
	^ counterMorph.! !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 22:52:28' prior: 50996157!
buildCounterMorph
	| numberInputMorph counterMorph arrowDown arrowUp counter arrowsMorph |
	
	counter _ ItemCounterModel new.
	numberInputMorph := TextModelMorph textProvider: counter textGetter: #value textSetter: #value:.
	numberInputMorph morphExtent: 50@20.
	
	arrowUp := PluggableButtonMorph model: counter stateGetter: nil action: #valueUp  label: '^'.
	arrowUp morphExtent: 25@10. 
	
	arrowDown := PluggableButtonMorph model: counter stateGetter: nil action: #valueDown  label: 'v'.
	arrowDown morphExtent: 25@10.
	
	arrowsMorph := LayoutMorph newColumn.
	arrowsMorph separation: 0.001;
	morphExtent: 25@20;
	addMorph: arrowUp;
	addMorph: arrowDown.
		
	counterMorph := LayoutMorph newRow. 
	counterMorph separation: 0.1;
	morphExtent: 100@50;
	addMorph: numberInputMorph;
	addMorph: arrowUp;
	addMorph: arrowDown.
	
	^ counterMorph.! !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 22:52:35' prior: 50996182!
buildCounterMorph
	| numberInputMorph counterMorph arrowDown arrowUp counter arrowsMorph |
	
	counter _ ItemCounterModel new.
	numberInputMorph := TextModelMorph textProvider: counter textGetter: #value textSetter: #value:.
	numberInputMorph morphExtent: 50@20.
	
	arrowUp := PluggableButtonMorph model: counter stateGetter: nil action: #valueUp  label: '^'.
	arrowUp morphExtent: 25@10. 
	
	arrowDown := PluggableButtonMorph model: counter stateGetter: nil action: #valueDown  label: 'v'.
	arrowDown morphExtent: 25@10.
	
	arrowsMorph := LayoutMorph newColumn.
	arrowsMorph separation: 0.001;
	morphExtent: 25@20;
	addMorph: arrowUp;
	addMorph: arrowDown.
		
	counterMorph := LayoutMorph newRow. 
	counterMorph separation: 0.1;
	morphExtent: 100@50;
	addMorph: numberInputMorph;
	addMorph: arrowsMorph.
	
	^ counterMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!ItemCounterModel methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 22:56:13' prior: 50995964!
value: aValue
	[
		|num|
		num _ aValue asNumber asInteger.
		value _ num asString. 
		self triggerEvent: #updateCounter.
	] on: Error do: [].
	^ value.! !
!ItemCounterModel methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 22:56:25' prior: 50996244!
value: aValue
	[
		|num|
		num _ aValue asNumber asInteger.
		value _ num asString. 
		self triggerEvent: #updateCounter with: self.
	] on: Error do: [].
	^ value.! !
!ItemCounterModel methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 22:56:48' prior: 50995946!
valueDown
	value _ (value asNumber asInteger -1) asString.
	self triggerEvent: #updateCounter with: self.
	^ value.! !
!ItemCounterModel methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 22:56:52' prior: 50995958!
valueUp
	value _ (value asNumber asInteger -1) asString.
	self triggerEvent: #updateCounter with: self.
	^ value.! !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 22:57:42' prior: 50996212!
buildCounterMorph
	| numberInputMorph counterMorph arrowDown arrowUp counter arrowsMorph |
	
	counter _ ItemCounterModel new.
	numberInputMorph := TextModelMorph textProvider: counter textGetter: #value textSetter: #value:.
	numberInputMorph morphExtent: 50@20.
	
	arrowUp := PluggableButtonMorph model: counter stateGetter: nil action: #valueUp  label: '^'.
	arrowUp morphExtent: 25@10. 
	
	arrowDown := PluggableButtonMorph model: counter stateGetter: nil action: #valueDown  label: 'v'.
	arrowDown morphExtent: 25@10.
	
	counter when: #updateCounter send: #updateCounter to: self.
	
	arrowsMorph := LayoutMorph newColumn.
	arrowsMorph separation: 0.001;
	morphExtent: 25@20;
	addMorph: arrowUp;
	addMorph: arrowDown.
		
	counterMorph := LayoutMorph newRow. 
	counterMorph separation: 0.1;
	morphExtent: 100@50;
	addMorph: numberInputMorph;
	addMorph: arrowsMorph.
	
	^ counterMorph.! !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 22:58:14' prior: 50996276!
buildCounterMorph
	| numberInputMorph counterMorph arrowDown arrowUp counter arrowsMorph |
	
	counter _ ItemCounterModel new.
	numberInputMorph := TextModelMorph textProvider: counter textGetter: #value textSetter: #value:.
	numberInputMorph morphExtent: 50@20.
	
	arrowUp := PluggableButtonMorph model: counter stateGetter: nil action: #valueUp  label: '^'.
	arrowUp morphExtent: 25@10. 
	
	arrowDown := PluggableButtonMorph model: counter stateGetter: nil action: #valueDown  label: 'v'.
	arrowDown morphExtent: 25@10.
	
	counter when: #updateCounter send: #updateCounter to: self with: counter.
	
	arrowsMorph := LayoutMorph newColumn.
	arrowsMorph separation: 0.001;
	morphExtent: 25@20;
	addMorph: arrowUp;
	addMorph: arrowDown.
		
	counterMorph := LayoutMorph newRow. 
	counterMorph separation: 0.1;
	morphExtent: 100@50;
	addMorph: numberInputMorph;
	addMorph: arrowsMorph.
	
	^ counterMorph.! !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 22:59:26' prior: 50996307!
buildCounterMorph
	| numberInputMorph counterMorph arrowDown arrowUp counter arrowsMorph |
	
	counter _ ItemCounterModel new.
	numberInputMorph := TextModelMorph textProvider: counter textGetter: #value textSetter: #value:.
	numberInputMorph morphExtent: 50@20.
	
	arrowUp := PluggableButtonMorph model: counter stateGetter: nil action: #valueUp  label: '^'.
	arrowUp morphExtent: 25@10. 
	
	arrowDown := PluggableButtonMorph model: counter stateGetter: nil action: #valueDown  label: 'v'.
	arrowDown morphExtent: 25@10.
	
	counter when: #updateCounter send: #updateCounter to: self with: numberInputMorph.
	
	arrowsMorph := LayoutMorph newColumn.
	arrowsMorph separation: 0.001;
	morphExtent: 25@20;
	addMorph: arrowUp;
	addMorph: arrowDown.
		
	counterMorph := LayoutMorph newRow. 
	counterMorph separation: 0.1;
	morphExtent: 100@50;
	addMorph: numberInputMorph;
	addMorph: arrowsMorph.
	
	^ counterMorph.! !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 23:03:07' prior: 50996338!
buildCounterMorph
	| numberInputMorph counterMorph arrowDown arrowUp counter arrowsMorph |
	
	counter _ ItemCounterModel new.
	numberInputMorph := TextModelMorph textProvider: counter textGetter: #value textSetter: #value:.
	numberInputMorph morphExtent: 50@20.
	
	arrowUp := PluggableButtonMorph model: counter stateGetter: nil action: #valueUp  label: '^'.
	arrowUp morphExtent: 25@10. 
	
	arrowDown := PluggableButtonMorph model: counter stateGetter: nil action: #valueDown  label: 'v'.
	arrowDown morphExtent: 25@10.
	
	counter when: #updateCounter send: #updateCounter to: self with: (OrderedCollection new with: numberInputMorph with: counter).
	
	arrowsMorph := LayoutMorph newColumn.
	arrowsMorph separation: 0.001;
	morphExtent: 25@20;
	addMorph: arrowUp;
	addMorph: arrowDown.
		
	counterMorph := LayoutMorph newRow. 
	counterMorph separation: 0.1;
	morphExtent: 100@50;
	addMorph: numberInputMorph;
	addMorph: arrowsMorph.
	
	^ counterMorph.! !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 23:03:27' prior: 50996370!
buildCounterMorph
	| numberInputMorph counterMorph arrowDown arrowUp counter arrowsMorph |
	
	counter _ ItemCounterModel new.
	numberInputMorph := TextModelMorph textProvider: counter textGetter: #value textSetter: #value:.
	numberInputMorph morphExtent: 50@20.
	
	arrowUp := PluggableButtonMorph model: counter stateGetter: nil action: #valueUp  label: '^'.
	arrowUp morphExtent: 25@10. 
	
	arrowDown := PluggableButtonMorph model: counter stateGetter: nil action: #valueDown  label: 'v'.
	arrowDown morphExtent: 25@10.
	
	counter when: #updateCounter send: #updateCounter:and: to: self with: (OrderedCollection new with: numberInputMorph with: counter).
	
	arrowsMorph := LayoutMorph newColumn.
	arrowsMorph separation: 0.001;
	morphExtent: 25@20;
	addMorph: arrowUp;
	addMorph: arrowDown.
		
	counterMorph := LayoutMorph newRow. 
	counterMorph separation: 0.1;
	morphExtent: 100@50;
	addMorph: numberInputMorph;
	addMorph: arrowsMorph.
	
	^ counterMorph.! !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 23:03:53'!
updateCounter: aTextMorph and: aCounter
	^ aTextMorph text: aCounter value.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !

----SNAPSHOT----(20 November 2021 23:04:15) CuisUniversity-4972.image priorSource: 21250693!
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 23:04:26' prior: 50996403!
buildCounterMorph
	| numberInputMorph counterMorph arrowDown arrowUp counter arrowsMorph |
	
	counter _ ItemCounterModel new.
	numberInputMorph := TextModelMorph textProvider: counter textGetter: #value textSetter: #value:.
	numberInputMorph morphExtent: 50@20.
	
	arrowUp := PluggableButtonMorph model: counter stateGetter: nil action: #valueUp  label: '^'.
	arrowUp morphExtent: 25@10. 
	
	arrowDown := PluggableButtonMorph model: counter stateGetter: nil action: #valueDown  label: 'v'.
	arrowDown morphExtent: 25@10.
	
	counter when: #updateCounter send: #updateCounter:and: to: self with: (OrderedCollection with: numberInputMorph with: counter).
	
	arrowsMorph := LayoutMorph newColumn.
	arrowsMorph separation: 0.001;
	morphExtent: 25@20;
	addMorph: arrowUp;
	addMorph: arrowDown.
		
	counterMorph := LayoutMorph newRow. 
	counterMorph separation: 0.1;
	morphExtent: 100@50;
	addMorph: numberInputMorph;
	addMorph: arrowsMorph.
	
	^ counterMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 23:06:27' prior: 50996447!
buildCounterMorph
	| numberInputMorph counterMorph arrowDown arrowUp counter arrowsMorph |
	
	counter _ ItemCounterModel new.
	numberInputMorph := TextModelMorph textProvider: counter textGetter: #value textSetter: #value:.
	numberInputMorph morphExtent: 50@20.
	
	arrowUp := PluggableButtonMorph model: counter stateGetter: nil action: #valueUp  label: '^'.
	arrowUp morphExtent: 25@10. 
	
	arrowDown := PluggableButtonMorph model: counter stateGetter: nil action: #valueDown  label: 'v'.
	arrowDown morphExtent: 25@10.
	
	counter when: #updateCounter send: #updateCounter:and: to: self with: (OrderedCollection with: numberInputMorph with: counter).
	
	arrowsMorph := LayoutMorph newColumn.
	arrowsMorph separation: 0.001;
	morphExtent: 25@20;
	addMorph: arrowUp;
	addMorph: arrowDown.
		
	counterMorph := LayoutMorph newRow. 
	counterMorph separation: 0.1;
	morphExtent: 100@50;
	addMorph: numberInputMorph;
	addMorph: arrowsMorph.
	
	^ counterMorph.! !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 23:08:57' prior: 50996483!
buildCounterMorph
	| numberInputMorph counterMorph arrowDown arrowUp counter arrowsMorph |
	
	counter _ ItemCounterModel new.
	numberInputMorph := TextModelMorph textProvider: counter textGetter: #value textSetter: #value:.
	numberInputMorph morphExtent: 50@20.
	
	arrowUp := PluggableButtonMorph model: counter stateGetter: nil action: #valueUp  label: '^'.
	arrowUp morphExtent: 25@10. 
	
	arrowDown := PluggableButtonMorph model: counter stateGetter: nil action: #valueDown  label: 'v'.
	arrowDown morphExtent: 25@10.
	
	counter when: #updateCounter send: #updateCounter:and: to: self withArguments: (Array with: numberInputMorph with: counter).
	
	arrowsMorph := LayoutMorph newColumn.
	arrowsMorph separation: 0.001;
	morphExtent: 25@20;
	addMorph: arrowUp;
	addMorph: arrowDown.
		
	counterMorph := LayoutMorph newRow. 
	counterMorph separation: 0.1;
	morphExtent: 100@50;
	addMorph: numberInputMorph;
	addMorph: arrowsMorph.
	
	^ counterMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !

!classDefinition: #CatalogWindow category: 'TusLibros-Graphics' stamp: 'MP 11/20/2021 23:12:22'!
Panel subclass: #CatalogWindow
	instanceVariableNames: 'username password counters'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Graphics'!
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 23:12:19' prior: 50996516!
buildCounterMorph
	| numberInputMorph counterMorph arrowDown arrowUp counter arrowsMorph counterId |
	
	counterId _ counters size. 
	counter _ ItemCounterModel newWith: counterId.
	numberInputMorph := TextModelMorph textProvider: counter textGetter: #value textSetter: #value:.
	numberInputMorph morphExtent: 50@20.
	
	arrowUp := PluggableButtonMorph model: counter stateGetter: nil action: #valueUp  label: '^'.
	arrowUp morphExtent: 25@10. 
	
	arrowDown := PluggableButtonMorph model: counter stateGetter: nil action: #valueDown  label: 'v'.
	arrowDown morphExtent: 25@10.
	
	counter when: #updateCounter send: #updateCounter:and: to: self withArguments: (Array with: numberInputMorph with: counter).
	
	arrowsMorph := LayoutMorph newColumn.
	arrowsMorph separation: 0.001;
	morphExtent: 25@20;
	addMorph: arrowUp;
	addMorph: arrowDown.
		
	counterMorph := LayoutMorph newRow. 
	counterMorph separation: 0.1;
	morphExtent: 100@50;
	addMorph: numberInputMorph;
	addMorph: arrowsMorph.
	
	^ counterMorph.! !
!ItemCounterModel class methodsFor: 'no messages' stamp: 'MP 11/20/2021 23:12:48'!
newWith: counterId
	^ self new initializeWith: counterId.! !

!classDefinition: #ItemCounterModel category: 'TusLibros-Graphics' stamp: 'MP 11/20/2021 23:13:04'!
Object subclass: #ItemCounterModel
	instanceVariableNames: 'value id'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Graphics'!
!ItemCounterModel methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 23:13:03'!
initializeWith: counterId
	value _ '0'.
	id _ counterId.! !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 23:14:03' prior: 50996560!
buildCounterMorph
	| numberInputMorph counterMorph arrowDown arrowUp counter arrowsMorph counterId |
	
	counterId _ counters size. 
	counter _ ItemCounterModel newWith: counterId.
	numberInputMorph := TextModelMorph textProvider: counter textGetter: #value textSetter: #value:.
	numberInputMorph morphExtent: 50@20.
	counters add: numberInputMorph. 
	
	arrowUp := PluggableButtonMorph model: counter stateGetter: nil action: #valueUp  label: '^'.
	arrowUp morphExtent: 25@10. 
	
	arrowDown := PluggableButtonMorph model: counter stateGetter: nil action: #valueDown  label: 'v'.
	arrowDown morphExtent: 25@10.
	
	counter when: #updateCounter send: #updateCounter:and: to: self withArguments: (Array with: numberInputMorph with: counter).
	
	arrowsMorph := LayoutMorph newColumn.
	arrowsMorph separation: 0.001;
	morphExtent: 25@20;
	addMorph: arrowUp;
	addMorph: arrowDown.
		
	counterMorph := LayoutMorph newRow. 
	counterMorph separation: 0.1;
	morphExtent: 100@50;
	addMorph: numberInputMorph;
	addMorph: arrowsMorph.
	
	^ counterMorph.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 23:14:22' prior: 50993025!
initializeWith: aTitle and: aUsername and: aPassword and: aCartID 
	
	username _ aUsername.
	password _ aPassword.
	counters _ OrderedCollection new.
	
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aTitle.
	self model: (CatalogWindowModel new).
	self morphExtent: self defaultExtent.
	self buildMorphicWindow.
	self openInWorld.
			
	"self model when: #authenticationResponse send: #login to: self."
	
	"Investigar:
	self model when: #newWordsArrived send: #refreshListOfWords:and: to: self."! !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 23:14:50' prior: 50996613!
buildCounterMorph
	| numberInputMorph counterMorph arrowDown arrowUp counter arrowsMorph counterId |
	
	counterId _ counters size. 
	counter _ ItemCounterModel newWith: counterId.
	numberInputMorph := TextModelMorph textProvider: counter textGetter: #value textSetter: #value:.
	numberInputMorph morphExtent: 50@20.
	counters add: numberInputMorph. 
	
	arrowUp := PluggableButtonMorph model: counter stateGetter: nil action: #valueUp  label: '^'.
	arrowUp morphExtent: 25@10. 
	
	arrowDown := PluggableButtonMorph model: counter stateGetter: nil action: #valueDown  label: 'v'.
	arrowDown morphExtent: 25@10.
	
	counter when: #updateCounter send: #updateCounter:and: to: self with: counter.
	
	arrowsMorph := LayoutMorph newColumn.
	arrowsMorph separation: 0.001;
	morphExtent: 25@20;
	addMorph: arrowUp;
	addMorph: arrowDown.
		
	counterMorph := LayoutMorph newRow. 
	counterMorph separation: 0.1;
	morphExtent: 100@50;
	addMorph: numberInputMorph;
	addMorph: arrowsMorph.
	
	^ counterMorph.! !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 23:15:12' prior: 50996669!
buildCounterMorph
	| numberInputMorph counterMorph arrowDown arrowUp counter arrowsMorph counterId |
	
	counterId _ counters size. 
	counter _ ItemCounterModel newWith: counterId.
	numberInputMorph := TextModelMorph textProvider: counter textGetter: #value textSetter: #value:.
	numberInputMorph morphExtent: 50@20.
	counters add: numberInputMorph. 
	
	arrowUp := PluggableButtonMorph model: counter stateGetter: nil action: #valueUp  label: '^'.
	arrowUp morphExtent: 25@10. 
	
	arrowDown := PluggableButtonMorph model: counter stateGetter: nil action: #valueDown  label: 'v'.
	arrowDown morphExtent: 25@10.
	
	counter when: #updateCounter send: #updateCounter: to: self with: counter.
	
	arrowsMorph := LayoutMorph newColumn.
	arrowsMorph separation: 0.001;
	morphExtent: 25@20;
	addMorph: arrowUp;
	addMorph: arrowDown.
		
	counterMorph := LayoutMorph newRow. 
	counterMorph separation: 0.1;
	morphExtent: 100@50;
	addMorph: numberInputMorph;
	addMorph: arrowsMorph.
	
	^ counterMorph.! !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 23:15:30'!
updateCounter: aCounter
	^ counters at: aCounter .! !
!ItemCounterModel methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 23:15:50'!
id
	^ id! !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 23:16:08' prior: 50996737!
updateCounter: aCounter
	^ counters at: aCounter id .! !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 23:16:13' prior: 50996703!
buildCounterMorph
	| numberInputMorph counterMorph arrowDown arrowUp counter arrowsMorph counterId |
	
	counterId _ counters size +1. 
	counter _ ItemCounterModel newWith: counterId.
	numberInputMorph := TextModelMorph textProvider: counter textGetter: #value textSetter: #value:.
	numberInputMorph morphExtent: 50@20.
	counters add: numberInputMorph. 
	
	arrowUp := PluggableButtonMorph model: counter stateGetter: nil action: #valueUp  label: '^'.
	arrowUp morphExtent: 25@10. 
	
	arrowDown := PluggableButtonMorph model: counter stateGetter: nil action: #valueDown  label: 'v'.
	arrowDown morphExtent: 25@10.
	
	counter when: #updateCounter send: #updateCounter: to: self with: counter.
	
	arrowsMorph := LayoutMorph newColumn.
	arrowsMorph separation: 0.001;
	morphExtent: 25@20;
	addMorph: arrowUp;
	addMorph: arrowDown.
		
	counterMorph := LayoutMorph newRow. 
	counterMorph separation: 0.1;
	morphExtent: 100@50;
	addMorph: numberInputMorph;
	addMorph: arrowsMorph.
	
	^ counterMorph.! !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 23:16:31' prior: 50996746!
updateCounter: aCounter
	^ (counters at: aCounter id) text: aCounter value.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!ItemCounterModel methodsFor: 'as yet unclassified' stamp: 'MP 11/20/2021 23:17:28' prior: 50996269!
valueUp
	value _ (value asNumber asInteger +1) asString.
	self triggerEvent: #updateCounter with: self.
	^ value.! !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 23:19:22' prior: 50996785!
updateCounter: aCounter
	^ (counters at: aCounter id) update: #ActualContents.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 23:27:39' prior: 50996801!
updateCounter: aCounter
	^ (counters at: aCounter id) contents: aCounter value.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 23:30:50' prior: 50996809!
updateCounter: aCounter
	^ (counters at: aCounter id) editLabel: aCounter value.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 23:31:39' prior: 50996817!
updateCounter: aCounter

	^ (counters at: aCounter id) editLabel: aCounter value.! !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 23:32:17' prior: 50996751!
buildCounterMorph
	| numberInputMorph counterMorph arrowDown arrowUp counter arrowsMorph counterId |
	
	counterId _ counters size +1. 
	counter _ ItemCounterModel newWith: counterId.
	numberInputMorph := TextModelMorph textProvider: counter textGetter: #value textSetter: #value:.
	numberInputMorph morphExtent: 50@20.
	counters add: numberInputMorph. 
	
	arrowUp := PluggableButtonMorph model: counter stateGetter: nil action: #valueUp  label: '^'.
	arrowUp morphExtent: 25@10. 
	
	arrowDown := PluggableButtonMorph model: counter stateGetter: nil action: #valueDown  label: 'v'.
	arrowDown morphExtent: 25@10.
	
	counter when: #updateCounter send: #updateCounter: to: self with: counter.
	
	arrowsMorph := LayoutMorph newColumn.
	arrowsMorph separation: 0.001;
	morphExtent: 25@20;
	addMorph: arrowUp;
	addMorph: arrowDown.
		
	counterMorph := LayoutMorph newRow. 
	counterMorph separation: 0.1;
	morphExtent: 100@50;
	addMorph: numberInputMorph;
	addMorph: arrowsMorph.
	
	^ counterMorph.! !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 23:32:36' prior: 50996826!
updateCounter: aCounter

	^ (counters at: aCounter id) innerTextMorph contents: aCounter value.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 23:33:55' prior: 50996866!
updateCounter: aCounter

	(counters at: aCounter id) innerTextMorph contents: aCounter value.
	^ (counters at: aCounter id) innerTextMorph updateFromContents.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 23:34:50' prior: 50996875!
updateCounter: aCounter

	(counters at: aCounter id) innerTextMorph contents: aCounter value.
	^ (counters at: aCounter id) innerTextMorph updateFromTextComposition .! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 23:35:03' prior: 50996889!
updateCounter: aCounter

	(counters at: aCounter id) innerTextMorph contents: aCounter value.
	^ (counters at: aCounter id) innerTextMorph updateFromContents.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 23:35:14' prior: 50996900!
updateCounter: aCounter

	(counters at: aCounter id) innerTextMorph contents: aCounter value.
	self halt.
	^ (counters at: aCounter id) innerTextMorph updateFromContents.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 23:35:46' prior: 50996911!
updateCounter: aCounter

	(counters at: aCounter id) innerTextMorph contents: aCounter value.
	^ aCounter value.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 23:36:12' prior: 50996922!
updateCounter: aCounter

	^ (counters at: aCounter id) innerTextMorph contents: aCounter value.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 23:36:36' prior: 50996932!
updateCounter: aCounter

	(counters at: aCounter id) innerTextMorph contents: aCounter value.
	^ (counters at: aCounter id) innerTextMorph updateFromContents .
	! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !

----SNAPSHOT----(20 November 2021 23:36:50) CuisUniversity-4972.image priorSource: 21273379!

!methodRemoval: CatalogWindow #updateCounter:and: stamp: 'MP 11/20/2021 23:38:40'!
updateCounter: aTextMorph and: aCounter
	^ aTextMorph text: aCounter value.!
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 23:38:48' prior: 50996941!
updateCounter: aCounter

	(counters at: aCounter id) innerTextMorph contents: aCounter value.
	^ (counters at: aCounter id) innerTextMorph updateFromTextComposition.
	! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 23:40:51' prior: 50996960!
updateCounter: aCounter

	(counters at: aCounter id) innerTextMorph textComposition: aCounter value.
	^ (counters at: aCounter id) innerTextMorph updateFromTextComposition .
	! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'MP 11/20/2021 23:41:29' prior: 50996971!
updateCounter: aCounter

	(counters at: aCounter id) innerTextMorph contents: aCounter value.
	^ (counters at: aCounter id) innerTextMorph resetTextComposition; updateFromTextComposition .
	! !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: '1' !

----SNAPSHOT----(20 November 2021 23:43:16) CuisUniversity-4972.image priorSource: 21289625!

----STARTUP---- (26 November 2021 19:08:22) as C:\Users\ferra\Desktop\windows64\CuisUniversity-4972.image!


----End fileIn of D:\Apuntes\Inge 1\Repos\Repo de entregas\20-TusLibros\Iteracion-4\TusLibros-Model.st----!

----End fileIn of D:\Apuntes\Inge 1\Repos\Repo de entregas\20-TusLibros\Iteracion-4\TusLibros-Tests.st----!

----End fileIn of D:\Apuntes\Inge 1\Repos\Repo de entregas\20-TusLibros\Iteracion-4\TusLibros-Graphics.st----!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'AF 11/26/2021 19:08:54'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'AF 11/26/2021 19:08:54'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'AF 11/26/2021 19:08:54'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'AF 11/26/2021 19:08:54'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'AF 11/26/2021 19:08:54'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'AF 11/26/2021 19:08:54'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'AF 11/26/2021 19:08:54'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'AF 11/26/2021 19:08:54'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'AF 11/26/2021 19:08:54'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'AF 11/26/2021 19:08:54'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'AF 11/26/2021 19:08:54'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'AF 11/26/2021 19:08:54'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'AF 11/26/2021 19:08:54'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'AF 11/26/2021 19:08:54'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/26/2021 19:08:54'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/26/2021 19:08:54'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/26/2021 19:08:54'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test04 stamp: 'AF 11/26/2021 19:08:54'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'AF 11/26/2021 19:08:54'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test06listPurhcases stamp: 'AF 11/26/2021 19:08:54'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CanCreateCartWithValidUserAndPassword stamp: 'AF 11/26/2021 19:08:54'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CanNotCreateCartWithInvalidUser stamp: 'AF 11/26/2021 19:08:54'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03CanNotCreateCartWithInvalidPassword stamp: 'AF 11/26/2021 19:08:54'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04CanAddItemsToACreatedCart stamp: 'AF 11/26/2021 19:08:54'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CanNotAddItemToNotCreatedCart stamp: 'AF 11/26/2021 19:08:54'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CanNotAddItemNotSellByTheStore stamp: 'AF 11/26/2021 19:08:54'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test07ListCartOfAnEmptyCartReturnsAnEmptyBag stamp: 'AF 11/26/2021 19:08:54'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CanNotListCartOfInvalidCartId stamp: 'AF 11/26/2021 19:08:54'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09ListCartReturnsTheRightNumberOfItems stamp: 'AF 11/26/2021 19:08:54'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CanCheckoutACart stamp: 'AF 11/26/2021 19:08:54'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CanNotCheckoutANotCreatedCart stamp: 'AF 11/26/2021 19:08:54'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12CanNotCheckoutAnEmptyCart stamp: 'AF 11/26/2021 19:08:54'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CanNotCheckoutWithAnExpiredCreditCard stamp: 'AF 11/26/2021 19:08:54'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14ListPurchasesIncludesBoughtItems stamp: 'AF 11/26/2021 19:08:54'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15CanNotListPurchasesOfInvalidCustomer stamp: 'AF 11/26/2021 19:08:54'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16CanNotListPurchasesOfValidCustomerWithInvalidPassword stamp: 'AF 11/26/2021 19:08:54'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test17CanNotAddToCartWhenSessionIsExpired stamp: 'AF 11/26/2021 19:08:54'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test18CanNotListCartWhenSessionIsExpired stamp: 'AF 11/26/2021 19:08:54'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test19CanNotCheckOutCartWhenSessionIsExpired stamp: 'AF 11/26/2021 19:08:54'!
PASSED!

----SNAPSHOT----(26 November 2021 19:08:58) CuisUniversity-4972.image priorSource: 20682207!
!TusLibrosRestAPIInterfaceTest methodsFor: 'as yet unclassified' stamp: 'AF 11/26/2021 19:14:56' prior: 50979514!
startTestServerAndGraphicInterface

	|server|
	self setUp.
	
	server _ TusLibrosRestAPIInterface listeningOn: 8080 communicateWith: systemFacade.
	
	LoginWindow open.
	
	^ server.! !

LoginWindow open!

CatalogWindow open!

CatalogWindow openWithUser: 'validUser' andPass: 'validUserPassword' andCart: 1!
!CatalogWindow methodsFor: 'auxiliary' stamp: 'AF 11/26/2021 19:27:34' prior: 50980197!
buildCounterMorph
	| numberInputMorph counterMorph arrowDown arrowUp counter arrowsMorph counterId |
	
	counterId _ counters size +1. 
	counter _ ItemCounterModel newWith: counterId.
	numberInputMorph := TextModelMorph textProvider: counter textGetter: #value textSetter: #value:.
	numberInputMorph morphExtent: 50@20.
	counters add: numberInputMorph. 
	
	arrowUp := PluggableButtonMorph model: counter stateGetter: nil action: #valueUp  label: Character arrowUp .
	arrowUp morphExtent: 25@10. 
	
	arrowDown := PluggableButtonMorph model: counter stateGetter: nil action: #valueDown  label: Character arrowDown .
	arrowDown morphExtent: 25@10.
	
	counter when: #updateCounter send: #updateCounter: to: self with: counter.
	
	arrowsMorph := LayoutMorph newColumn.
	arrowsMorph separation: 0.001;
	morphExtent: 25@20;
	addMorph: arrowUp;
	addMorph: arrowDown.
		
	counterMorph := LayoutMorph newRow. 
	counterMorph separation: 0.1;
	morphExtent: 100@50;
	addMorph: numberInputMorph;
	addMorph: arrowsMorph.
	
	^ counterMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validPassword' andCart: 1!
!CatalogWindow methodsFor: 'auxiliary' stamp: 'AF 11/26/2021 19:34:37' prior: 50980777!
buildCounterMorph
	| numberInputMorph counterMorph arrowDown arrowUp counter arrowsMorph counterId |
	
	counterId _ counters size +1. 
	counter _ ItemCounterModel newWith: counterId.
	numberInputMorph := TextModelMorph textProvider: counter textGetter: #value textSetter: #value:.
	numberInputMorph morphExtent: 50@20.
	counters add: numberInputMorph. 
	
	arrowUp := PluggableButtonMorph model: counter stateGetter: nil action: #valueUp  label: (Character arrowUp ).
	arrowUp morphExtent: 25@10. 
	
	arrowDown := PluggableButtonMorph model: counter stateGetter: nil action: #valueDown  label: (Character arrowDown) .
	arrowDown morphExtent: 25@10.
	
	counter when: #updateCounter send: #updateCounter: to: self with: counter.
	
	arrowsMorph := LayoutMorph newColumn.
	arrowsMorph separation: 0.001;
	morphExtent: 25@20;
	addMorph: arrowUp;
	addMorph: arrowDown.
		
	counterMorph := LayoutMorph newRow. 
	counterMorph separation: 0.1;
	morphExtent: 100@50;
	addMorph: numberInputMorph;
	addMorph: arrowsMorph.
	
	^ counterMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validPassword' andCart: 1!
!CatalogWindow methodsFor: 'auxiliary' stamp: 'AF 11/26/2021 19:34:58' prior: 50980816!
buildCounterMorph
	| numberInputMorph counterMorph arrowDown arrowUp counter arrowsMorph counterId |
	
	counterId _ counters size +1. 
	counter _ ItemCounterModel newWith: counterId.
	numberInputMorph := TextModelMorph textProvider: counter textGetter: #value textSetter: #value:.
	numberInputMorph morphExtent: 50@20.
	counters add: numberInputMorph. 
	
	arrowUp := PluggableButtonMorph model: counter stateGetter: nil action: #valueUp  label: (Character arrowUp asString).
	arrowUp morphExtent: 25@10. 
	
	arrowDown := PluggableButtonMorph model: counter stateGetter: nil action: #valueDown  label: (Character arrowDown asString) .
	arrowDown morphExtent: 25@10.
	
	counter when: #updateCounter send: #updateCounter: to: self with: counter.
	
	arrowsMorph := LayoutMorph newColumn.
	arrowsMorph separation: 0.001;
	morphExtent: 25@20;
	addMorph: arrowUp;
	addMorph: arrowDown.
		
	counterMorph := LayoutMorph newRow. 
	counterMorph separation: 0.1;
	morphExtent: 100@50;
	addMorph: numberInputMorph;
	addMorph: arrowsMorph.
	
	^ counterMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validPassword' andCart: 1!
!ItemCounterModel methodsFor: 'as yet unclassified' stamp: 'AF 11/26/2021 19:41:13' prior: 50980519!
value: aValue
	[
		|num|
		num _ aValue asNumber asInteger.
		value _ num asString. 
		self triggerEvent: #updateCounter with: self.
	] on: Error do: [].
	^ value.! !
!ItemCounterModel methodsFor: 'as yet unclassified' stamp: 'AF 11/26/2021 19:41:28' prior: 50980505 overrides: 16896425!
initialize

	value _ '0'! !
!ItemCounterModel methodsFor: 'as yet unclassified' stamp: 'AF 11/26/2021 19:41:34' prior: 50980509!
initializeWith: counterId
	value _ '0'.
	id _ counterId.! !
!ItemCounterModel methodsFor: 'as yet unclassified' stamp: 'AF 11/26/2021 19:41:35' prior: 50980909!
initializeWith: counterId

	value _ '0'.
	id _ counterId.! !
!ItemCounterModel methodsFor: 'as yet unclassified' stamp: 'AF 11/26/2021 19:41:42' prior: 50980501!
id

	^ id! !
!ItemCounterModel methodsFor: 'as yet unclassified' stamp: 'AF 11/26/2021 19:41:50' prior: 50980515 overrides: 16881508!
value

	^ value.! !
!ItemCounterModel methodsFor: 'as yet unclassified' stamp: 'AF 11/26/2021 19:41:56' prior: 50980895!
value: aValue
	[
		|num|
		num _ aValue asNumber asInteger.
		value _ num asString. 
		self triggerEvent: #updateCounter with: self.
	] on: Error do: [].
	^ value.! !
!ItemCounterModel methodsFor: 'as yet unclassified' stamp: 'AF 11/26/2021 19:42:01' prior: 50980535!
valueUp

	value _ (value asNumber asInteger +1) asString.
	self triggerEvent: #updateCounter with: self.
	^ value.! !
!ItemCounterModel methodsFor: 'as yet unclassified' stamp: 'AF 11/26/2021 19:42:06' prior: 50980528!
valueDown
	value _ (value asNumber asInteger -1) asString.
	self triggerEvent: #updateCounter with: self.
	^ value.! !
!ItemCounterModel methodsFor: 'as yet unclassified' stamp: 'AF 11/26/2021 19:42:07' prior: 50980946!
valueDown

	value _ (value asNumber asInteger -1) asString.
	self triggerEvent: #updateCounter with: self.
	^ value.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/26/2021 19:43:03' prior: 50980299!
initializeWith: aTitle and: aUsername and: aPassword and: aCartID 
	
	username _ aUsername.
	password _ aPassword.
	counters _ OrderedCollection new.
	
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aTitle.
	self model: (CatalogWindowModel new).
	self morphExtent: self defaultExtent.
	self buildMorphicWindow.
	self openInWorld.
			
	"self model when: #authenticationResponse send: #login to: self."
	
	"Investigar:
	self model when: #newWordsArrived send: #refreshListOfWords:and: to: self."! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/26/2021 19:43:11' prior: 50980295 overrides: 50965689!
defaultExtent

	^ 1035@485
	! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/26/2021 19:43:17' prior: 50980271!
buildShopHeader
	| firstRowLayoutMorph headerButtonsMorph |
		
	headerButtonsMorph := LayoutMorph newRow.
	headerButtonsMorph separation: 25;
	axisEdgeWeight: 1.0;
	morphExtent: (self defaultExtent x*0.6)@(self defaultExtent y * 0.1) ;
	addMorph: (LabelMorph contents: 'Purchase history');
	addMorph: (LabelMorph contents: 'Checkout').
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 1;
	axisEdgeWeight: 0.0;
	morphExtent: (self defaultExtent x)@(self defaultExtent y * 0.1) ;
	addMorph: (LabelMorph contents:'Welcome, ',username,'!!');
	addMorph: headerButtonsMorph.
	
	^firstRowLayoutMorph.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/26/2021 19:43:19' prior: 50980985!
buildShopHeader

	| firstRowLayoutMorph headerButtonsMorph |
		
	headerButtonsMorph := LayoutMorph newRow.
	headerButtonsMorph separation: 25;
	axisEdgeWeight: 1.0;
	morphExtent: (self defaultExtent x*0.6)@(self defaultExtent y * 0.1) ;
	addMorph: (LabelMorph contents: 'Purchase history');
	addMorph: (LabelMorph contents: 'Checkout').
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 1;
	axisEdgeWeight: 0.0;
	morphExtent: (self defaultExtent x)@(self defaultExtent y * 0.1) ;
	addMorph: (LabelMorph contents:'Welcome, ',username,'!!');
	addMorph: headerButtonsMorph.
	
	^firstRowLayoutMorph.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/26/2021 19:43:24' prior: 50980255!
buildShopBody
	| bodyLayoutMorph catalogMorph cartListMorph |
		
	catalogMorph := self buildCatalogMorph.
	"cartListMorph := self buildCartListMorph."
		
	bodyLayoutMorph := LayoutMorph newRow.
	bodyLayoutMorph separation: 1;
	axisEdgeWeight: 0.0;
	morphExtent: (self defaultExtent x)@(self defaultExtent y * 0.70) ;
	addMorph: catalogMorph.
	"addMorph: cartListMorph."
	
	^bodyLayoutMorph.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/26/2021 19:43:31' prior: 50981031!
buildShopBody

	| bodyLayoutMorph catalogMorph cartListMorph |
		
	catalogMorph := self buildCatalogMorph.
	"cartListMorph := self buildCartListMorph."
		
	bodyLayoutMorph := LayoutMorph newRow.
	bodyLayoutMorph separation: 1;
	axisEdgeWeight: 0.0;
	morphExtent: (self defaultExtent x)@(self defaultExtent y * 0.70) ;
	addMorph: catalogMorph.
	"addMorph: cartListMorph."
	
	^bodyLayoutMorph.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/26/2021 19:43:49' prior: 50980246 overrides: 50965593!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 25;
	axisEdgeWeight: 0.0;
	morphExtent: self defaultExtent;
	addMorph: self buildShopHeader;
	addMorph: self buildShopBody.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/26/2021 19:43:54' prior: 50980241!
buildCartListMorph

	^ self shouldBeImplemented.! !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'AF 11/26/2021 19:45:06' prior: 50980855!
buildCounterMorph
	| numberInputMorph counterMorph arrowDown arrowUp counter arrowsMorph counterId |
	
	counterId _ counters size +1. 
	counter _ ItemCounterModel newWith: counterId.
	numberInputMorph := TextModelMorph textProvider: counter textGetter: #value textSetter: #value:.
	numberInputMorph morphExtent: 50@20.
	counters add: numberInputMorph. 
	
	arrowUp := PluggableButtonMorph model: counter stateGetter: nil action: #valueUp  label: (Character arrowUp asString).
	arrowUp morphExtent: 25@10. 
	
	arrowDown := PluggableButtonMorph model: counter stateGetter: nil action: #valueDown  label: (Character arrowDown asString) .
	arrowDown morphExtent: 25@10.
	
	counter when: #updateCounter send: #updateCounter: to: self with: counter.
	
	arrowsMorph := LayoutMorph newColumn.
	arrowsMorph separation: 0.001;
	morphExtent: 25@20;
	addMorph: arrowUp;
	addMorph: arrowDown.
		
	counterMorph := LayoutMorph newRow. 
	counterMorph separation: 0.1;
	morphExtent: 100@50;
	addMorph: numberInputMorph;
	addMorph: arrowsMorph.
	
	^ counterMorph.! !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'AF 11/26/2021 19:45:44' prior: 50980232!
updateCounter: aCounter

	(counters at: aCounter id) innerTextMorph contents: aCounter value.
	^ (counters at: aCounter id) innerTextMorph resetTextComposition; updateFromTextComposition .
	! !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'AF 11/26/2021 19:46:01' prior: 50981114!
updateCounter: aCounter

	(counters at: aCounter id) innerTextMorph contents: aCounter value.
	^(counters at: aCounter id) innerTextMorph resetTextComposition; updateFromTextComposition .
	! !

'1' asInteger!

'1' - '1'!
!ItemCounterModel methodsFor: 'as yet unclassified' stamp: 'AF 11/26/2021 19:53:34' prior: 50980953!
valueDown

	|newValue|

	value _ (value asNumber asInteger -1) asString.
	self triggerEvent: #updateCounter with: self.
	^ value.! !
!ItemCounterModel methodsFor: 'as yet unclassified' stamp: 'AF 11/26/2021 19:53:48' prior: 50981134!
valueDown

	|newValue|

	newValue _ value asNumber asInteger -1.
	self triggerEvent: #updateCounter with: self.
	^ value.! !
!ItemCounterModel methodsFor: 'as yet unclassified' stamp: 'AF 11/26/2021 19:55:44' prior: 50981142!
valueDown

	|newValue|

	newValue _ value asNumber asInteger -1.
	newValue > 0 ifTrue: [value _ newValue.
					  self triggerEvent: #updateCounter with: self.].
	
	^ value.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validPassword' andCart: 1!
!ItemCounterModel methodsFor: 'as yet unclassified' stamp: 'AF 11/26/2021 19:56:07' prior: 50981150!
valueDown

	|newValue|

	newValue _ value asNumber asInteger -1.
	newValue > 0 ifTrue: [value _ newValue asString.
					  self triggerEvent: #updateCounter with: self.].
	
	^ value.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validPassword' andCart: 1!
!ItemCounterModel methodsFor: 'as yet unclassified' stamp: 'AF 11/26/2021 19:56:24' prior: 50981162!
valueDown

	|newValue|

	newValue _ value asNumber asInteger -1.
	newValue >= 0 ifTrue: [value _ newValue asString.
					  self triggerEvent: #updateCounter with: self.].
	
	^ value.! !

CatalogWindow openWithUser: 'validUser' andPass: 'validPassword' andCart: 1!

----SNAPSHOT----(26 November 2021 20:26:00) CuisUniversity-4972.image priorSource: 20771478!

----STARTUP---- (27 November 2021 11:20:21) as C:\Users\ferra\Desktop\windows64\CuisUniversity-4972.image!


CatalogWindow openWithUser: 'validUser' andPass: 'validPassword' andCart: 1!

|server|
server _ TusLibrosRestAPIInterfaceTest  startTestServerAndGraphicInterface.!

|server|
server _ TusLibrosRestAPIInterfaceTest new startTestServerAndGraphicInterface.!

TusLibrosRestAPIInterface allInstancesDo: [:instance | instance destroy]!

TusLibrosRestAPIInterface allInstancesDo: [:instance | instance destroy]!

|server|
server _ TusLibrosRestAPIInterfaceTest new startTestServerAndGraphicInterface.!
!LoginWindowModel methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 11:34:04' prior: 50980570!
authenticate
	|client notDecodedResponse respDict |
	client _ WebClient new.
	notDecodedResponse _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self username,'&password=',self password ).
	respDict _ WebUtils jsonMapFrom: (notDecodedResponse content) readStream.
	(respDict at: 'status') = 0
		ifTrue: [
			|cartId|
			cartId _ respDict at: 'cartId'.
			CatalogWindow openWithUser: username andPass: password andCart: cartId.
		] 
		ifFalse: [
			response _ respDict at: 'errorDescription'.
		].
	
	
	client close.
	
	self triggerEvent: #authenticationResponse! !
!LoginWindowModel methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 11:34:06' prior: 50981208!
authenticate

	|client notDecodedResponse respDict |
	client _ WebClient new.
	notDecodedResponse _ (client httpGet: 'http://localhost:8080/createCart?clientId=',self username,'&password=',self password ).
	respDict _ WebUtils jsonMapFrom: (notDecodedResponse content) readStream.
	(respDict at: 'status') = 0
		ifTrue: [
			|cartId|
			cartId _ respDict at: 'cartId'.
			CatalogWindow openWithUser: username andPass: password andCart: cartId.
		] 
		ifFalse: [
			response _ respDict at: 'errorDescription'.
		].
	
	
	client close.
	
	self triggerEvent: #authenticationResponse! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 11:34:23' prior: 50980350!
build1stRow
	| firstRowLayoutMorph |
	
	userTextBoxMorph := TextModelMorph textProvider: self model textGetter: #username textSetter: #username:. 
	userTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | userTextBoxMorph innerTextMorph acceptContents ] .
	userTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 200 ; morphHeight: 20. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: self minimumExtent;
	addMorph: (LabelMorph contents:'Username:');
	addMorph: userTextBoxMorph.
	
	^firstRowLayoutMorph.! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 11:34:29' prior: 50980373!
build2ndRow
	| secondRowLayoutMorph |
	
	passwordTextBoxMorph := TextModelMorph textProvider: self model textGetter: #password textSetter: #password:. 
	passwordTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | passwordTextBoxMorph innerTextMorph acceptContents ] .
	passwordTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 200 ; morphHeight: 20. 
		
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: self minimumExtent;
	addMorph: (LabelMorph contents:'Password:');
	addMorph: passwordTextBoxMorph.
	
	^secondRowLayoutMorph.! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 11:34:35' prior: 50980396!
build3rdRow
	| loginButtonMorph thirdRowLayoutMorph |
	
	loginButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #authenticate  label: 'Create Cart'.
	
	thirdRowLayoutMorph := LayoutMorph newRow.
	thirdRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: self minimumExtent;
 	addMorph: loginButtonMorph.
	
	^thirdRowLayoutMorph.! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 11:34:40' prior: 50980411!
build4rdRow
	| thirdRowLayoutMorph |
	
	errorMessageMorph := LabelMorph contents: '' font: FontFamily defaultFamilyAndPointSize emphasis: AbstractFont boldCode.
	errorMessageMorph color: Color red.
	
	thirdRowLayoutMorph := LayoutMorph newRow.
	thirdRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: self minimumExtent;
 	addMorph: errorMessageMorph.
	
	^thirdRowLayoutMorph.! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 11:34:44' prior: 50980427 overrides: 50965593!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 1;
	axisEdgeWeight: 0;
	morphExtent: self minimumExtent;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow;
	addMorph: self build4rdRow.! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 11:34:47' prior: 50980438 overrides: 50965689!
defaultExtent

	^ 1035@485
	! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 11:34:52' prior: 50980442!
initializeWith: aTitle

	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aTitle.
	self model: (LoginWindowModel new).
	self morphExtent: self defaultExtent.
	self buildMorphicWindow.
	self openInWorld.
			
	self model when: #authenticationResponse send: #login to: self.
	
	"Investigar:
	self model when: #newWordsArrived send: #refreshListOfWords:and: to: self."! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 11:34:56' prior: 50980458!
login
	errorMessageMorph contents: self model response.! !
!CatalogWindow methodsFor: 'catalog' stamp: 'AF 11/27/2021 11:35:45' prior: 50980138!
buildCatalogItemMorphWithName: aBookName withISBN: anISBN withExtent: anExtent 

	| itemMorph |
	itemMorph := LayoutMorph newRow.
	itemMorph separation: 1; 
	morphWidth: anExtent x; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogTableItem: aBookName ownerExtent: itemMorph morphExtent);
	addMorph: (self buildCatalogTableItem: anISBN ownerExtent: itemMorph morphExtent);
	addMorph: (self buildCounterMorph).

	^ itemMorph.! !
!CatalogWindow methodsFor: 'catalog' stamp: 'AF 11/27/2021 11:35:52' prior: 50980154!
buildCatalogListHeaderWithExtent: anExtent
	
	| catalogMorph |
	
	catalogMorph := LayoutMorph newRow.
	catalogMorph separation: 1; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogTableItem: 'Book name' ownerExtent: anExtent);
	addMorph: (self buildCatalogTableItem: 'ISBN' ownerExtent: anExtent).
	^ catalogMorph.! !
!CatalogWindow methodsFor: 'catalog' stamp: 'AF 11/27/2021 11:38:07' prior: 50980187!
buildCatalogTableItem: aName ownerExtent: anExtent 
	
	| itemMorph |
	
	itemMorph := LabelMorph contents: aName font: FontFamily defaultFamilyAndPointSize.
	itemMorph morphWidth: (anExtent x *0.25).
	^ itemMorph! !

|server|
server _ TusLibrosRestAPIInterfaceTest new startTestServerAndGraphicInterface.!

TusLibrosRestAPIInterface allInstancesDo: [:instance | instance destroy]!

TusLibrosRestAPIInterface allInstancesDo: [:instance | instance destroy]!

server _ TusLibrosRestAPIInterfaceTest new startTestServerAndGraphicInterface.!
!CatalogWindow methodsFor: 'catalog' stamp: 'AF 11/27/2021 11:41:22' prior: 50980167!
buildCatalogMorph
	
	| catalogMorph p |
	
	catalogMorph := LayoutMorph newColumn.
	p := PluggableScrollPane new.
	p morphExtent: (self defaultExtent x*0.6)@(self defaultExtent y * 0.60);
	scroller: catalogMorph.
	
	catalogMorph separation: 1; 
	morphExtent: catalogMorph morphExtent;
	axisEdgeWeight: 0.0.
	catalogMorph addMorph: (self buildCatalogListHeaderWithExtent: p morphExtent).
	20 timesRepeat: [catalogMorph addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN' withExtent: p morphExtent).].
	
	^ p.! !
!CatalogWindow methodsFor: 'catalog' stamp: 'AF 11/27/2021 11:41:46' prior: 50981416!
buildCatalogMorph
	
	| catalogMorph scrollMorph |
	
	catalogMorph := LayoutMorph newColumn.
	scrollMorph := PluggableScrollPane new.
	scrollMorph morphExtent: (self defaultExtent x*0.6)@(self defaultExtent y * 0.60);
	scroller: catalogMorph.
	
	catalogMorph separation: 1; 
	morphExtent: catalogMorph morphExtent;
	axisEdgeWeight: 0.0.
	catalogMorph addMorph: (self buildCatalogListHeaderWithExtent: scrollMorph morphExtent).
	20 timesRepeat: [catalogMorph addMorph: (self buildCatalogItemMorphWithName: 'test' withISBN: 'ISBN' withExtent: scrollMorph morphExtent).].
	
	^ scrollMorph.! !
!CatalogWindow methodsFor: 'catalog' stamp: 'AF 11/27/2021 11:45:02'!
buildCatalogItemRowWithName: aBookName withISBN: anISBN withExtent: anExtent 

	| itemMorph |
	itemMorph := LayoutMorph newRow.
	itemMorph separation: 1; 
	morphWidth: anExtent x; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogTableItem: aBookName ownerExtent: itemMorph morphExtent);
	addMorph: (self buildCatalogTableItem: anISBN ownerExtent: itemMorph morphExtent);
	addMorph: (self buildCounterMorph).

	^ itemMorph.! !
!CatalogWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 11:45:03' prior: 50981436!
buildCatalogMorph
	
	| catalogMorph scrollMorph |
	
	catalogMorph := LayoutMorph newColumn.
	scrollMorph := PluggableScrollPane new.
	scrollMorph morphExtent: (self defaultExtent x*0.6)@(self defaultExtent y * 0.60);
	scroller: catalogMorph.
	
	catalogMorph separation: 1; 
	morphExtent: catalogMorph morphExtent;
	axisEdgeWeight: 0.0.
	catalogMorph addMorph: (self buildCatalogListHeaderWithExtent: scrollMorph morphExtent).
	20 timesRepeat: [catalogMorph addMorph: (self buildCatalogItemRowWithName: 'test' withISBN: 'ISBN' withExtent: scrollMorph morphExtent).].
	
	^ scrollMorph.! !

!methodRemoval: CatalogWindow #buildCatalogItemMorphWithName:withISBN:withExtent: stamp: 'AF 11/27/2021 11:45:03'!
buildCatalogItemMorphWithName: aBookName withISBN: anISBN withExtent: anExtent 

	| itemMorph |
	itemMorph := LayoutMorph newRow.
	itemMorph separation: 1; 
	morphWidth: anExtent x; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogTableItem: aBookName ownerExtent: itemMorph morphExtent);
	addMorph: (self buildCatalogTableItem: anISBN ownerExtent: itemMorph morphExtent);
	addMorph: (self buildCounterMorph).

	^ itemMorph.!
!CatalogWindow methodsFor: 'catalog' stamp: 'AF 11/27/2021 11:45:39' prior: 50981457!
buildCatalogItemRowWithName: aBookName withISBN: anISBN withExtent: anExtent 

	| itemMorph |
	itemMorph := LayoutMorph newRow.
	itemMorph separation: 1; 
	morphWidth: anExtent x; 
	axisEdgeWeight: 0.0;
	addMorph: (self buildCatalogTableItem: aBookName ownerExtent: itemMorph morphExtent);
	addMorph: (self buildCatalogTableItem: anISBN ownerExtent: itemMorph morphExtent);
	addMorph: (self buildCounterMorph).

	"TO DO: falta agregar boton para agregar al carrito"

	^ itemMorph.! !
!CatalogWindow methodsFor: 'auxiliary' stamp: 'AF 11/27/2021 12:02:11' prior: 50981078!
buildCounterMorph
	| numberInputMorph counterMorph arrowDown arrowUp counter arrowsMorph counterId |
	
	counterId _ counters size +1. 
	counter _ ItemCounterModel newWith: counterId.
	numberInputMorph := TextModelMorph textProvider: counter textGetter: #value textSetter: #value:.
	numberInputMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | numberInputMorph innerTextMorph acceptContents ] .
	numberInputMorph morphExtent: 50@20.
	counters add: numberInputMorph. 
	
	arrowUp := PluggableButtonMorph model: counter stateGetter: nil action: #valueUp  label: (Character arrowUp asString).
	arrowUp morphExtent: 25@10. 
	
	arrowDown := PluggableButtonMorph model: counter stateGetter: nil action: #valueDown  label: (Character arrowDown asString) .
	arrowDown morphExtent: 25@10.
	
	counter when: #updateCounter send: #updateCounter: to: self with: counter.
	
	arrowsMorph := LayoutMorph newColumn.
	arrowsMorph separation: 0.001;
	morphExtent: 25@20;
	addMorph: arrowUp;
	addMorph: arrowDown.
		
	counterMorph := LayoutMorph newRow. 
	counterMorph separation: 0.1;
	morphExtent: 100@50;
	addMorph: numberInputMorph;
	addMorph: arrowsMorph.
	
	^ counterMorph.! !

TusLibrosRestAPIInterface allInstancesDo: [:instance | instance destroy]!

TusLibrosRestAPIInterface allInstancesDo: [:instance | instance destroy]!

|server|
server _ TusLibrosRestAPIInterfaceTest new startTestServerAndGraphicInterface.!

TusLibrosRestAPIInterface allInstancesDo: [:instance | instance destroy]!

|server|
server _ TusLibrosRestAPIInterfaceTest new startTestServerAndGraphicInterface.!

CatalogWindow openWithUser: 'validUser' andPass: 'asdas' andCart: 1!
!CatalogWindow methodsFor: 'auxiliary' stamp: 'AF 11/27/2021 12:12:48' prior: 50981123!
updateCounter: aCounter

	^(counters at: aCounter id) innerTextMorph acceptContents.

"	(counters at: aCounter id) innerTextMorph contents: aCounter value.
	^(counters at: aCounter id) innerTextMorph resetTextComposition; updateFromTextComposition ."
	! !

CatalogWindow openWithUser: 'validUser' andPass: 'asdas' andCart: 1!

!methodRemoval: ItemCounterModel #initialize stamp: 'AF 11/27/2021 12:16:23'!
initialize

	value _ '0'!

CatalogWindow openWithUser: 'validUser' andPass: 'asdas' andCart: 1!
!ItemCounterModel methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 12:21:11' prior: 50981174!
valueDown

	|newValue|

	newValue _ self value asNumber asInteger -1.
	newValue >= 0 ifTrue: [value _ newValue asString.
					  self triggerEvent: #updateCounter with: self.].
	
! !
!ItemCounterModel methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 12:21:36' prior: 50981605!
valueDown

	|newValue|

	newValue _ self value asNumber asInteger -1.
	newValue >= 0 ifTrue: [self value: newValue asString.
					    "self triggerEvent: #updateCounter with: self".].
	
! !
!ItemCounterModel methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 12:22:28' prior: 50980939!
valueUp

	self value: (self value asNumber asInteger +1) asString.
	self triggerEvent: #updateCounter with: self.
! !
!ItemCounterModel methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 12:22:33' prior: 50981624!
valueUp

	self value: (self value asNumber asInteger +1) asString.
	"self triggerEvent: #updateCounter with: self."
! !

CatalogWindow openWithUser: 'validUser' andPass: 'asdas' andCart: 1!
!ItemCounterModel methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 12:23:26' prior: 50981614!
valueDown

	|newValue|

	newValue _ self value asNumber asInteger -1.
	newValue >= 0 ifTrue: [self value: newValue asString.
					    "self triggerEvent: #updateCounter with: self"].
	
! !
!ItemCounterModel methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 12:23:31' prior: 50981641!
valueDown

	|newValue|

	newValue _ self value asNumber asInteger -1.
	newValue >= 0 ifTrue: [self value: newValue asString.
					    self triggerEvent: #updateCounter with: self].
	
! !
!ItemCounterModel methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 12:23:38' prior: 50981631!
valueUp

	self value: (self value asNumber asInteger +1) asString.
	self triggerEvent: #updateCounter with: self.
! !
!ItemCounterModel methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 12:23:53' prior: 50980930!
value: aValue
	[
		|num|
		num _ aValue asNumber asInteger.
		value _ num asString. 
	] on: Error do: [].
	^ value.! !
!ItemCounterModel methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 12:24:09' prior: 50981667!
value: aValue
	[
		|num|
		num _ aValue asNumber asInteger.
		value _ num asString. 
	] on: Error do: [].! !

CatalogWindow openWithUser: 'validUser' andPass: 'asdas' andCart: 1!
!CatalogWindow methodsFor: 'auxiliary' stamp: 'AF 11/27/2021 12:30:22' prior: 50981586!
updateCounter: aCounter
	
	| textMorph |
	textMorph _ (counters at: aCounter id) innerTextMorph.
	textMorph hasUnacceptedEdits: true.
	^textMorph acceptContents.
	

"	(counters at: aCounter id) innerTextMorph contents: aCounter value.
	^(counters at: aCounter id) innerTextMorph resetTextComposition; updateFromTextComposition ."
	! !

CatalogWindow openWithUser: 'validUser' andPass: 'asdas' andCart: 1!
!CatalogWindow methodsFor: 'auxiliary' stamp: 'AF 11/27/2021 12:31:14' prior: 50981683!
updateCounter: aCounter
	
	| textMorph |
	textMorph _ (counters at: aCounter id) innerTextMorph.
	textMorph hasUnacceptedEdits: true.
	textMorph acceptContents.
	textMorph resetTextComposition; updateFromTextComposition.
	

"	(counters at: aCounter id) innerTextMorph contents: aCounter value.
	^(counters at: aCounter id) innerTextMorph resetTextComposition; updateFromTextComposition ."
	! !

CatalogWindow openWithUser: 'validUser' andPass: 'asdas' andCart: 1!
!CatalogWindow methodsFor: 'auxiliary' stamp: 'AF 11/27/2021 12:31:39' prior: 50981699!
updateCounter: aCounter
	
	| textMorph |
	textMorph _ (counters at: aCounter id) innerTextMorph.
	textMorph hasUnacceptedEdits: true.
	textMorph acceptContents.
	textMorph resetTextComposition; updateFromTextComposition.
	

	"(counters at: aCounter id) innerTextMorph contents: aCounter value.
	^(counters at: aCounter id) innerTextMorph resetTextComposition; updateFromTextComposition ."
	! !

CatalogWindow openWithUser: 'validUser' andPass: 'asdas' andCart: 1!
!CatalogWindow methodsFor: 'auxiliary' stamp: 'AF 11/27/2021 12:33:32' prior: 50981717!
updateCounter: aCounter
	
	| textMorph |
	textMorph _ (counters at: aCounter id) innerTextMorph.
	textMorph contents: aCounter value.
	textMorph acceptContents.
	textMorph resetTextComposition; updateFromTextComposition.
	

	"(counters at: aCounter id) innerTextMorph contents: aCounter value.
	^(counters at: aCounter id) innerTextMorph resetTextComposition; updateFromTextComposition ."
	! !

CatalogWindow openWithUser: 'validUser' andPass: 'asdas' andCart: 1!
!CatalogWindow methodsFor: 'auxiliary' stamp: 'AF 11/27/2021 12:34:55' prior: 50981735!
updateCounter: aCounter
	
	| textMorph |
	textMorph _ (counters at: aCounter id) innerTextMorph.
	textMorph contents: aCounter value.
	textMorph hasUnacceptedEdits: true.
	textMorph acceptContents.
	textMorph resetTextComposition; updateFromTextComposition.
	

	"(counters at: aCounter id) innerTextMorph contents: aCounter value.
	^(counters at: aCounter id) innerTextMorph resetTextComposition; updateFromTextComposition ."
	! !

CatalogWindow openWithUser: 'validUser' andPass: 'asdas' andCart: 1!
!CatalogWindow methodsFor: 'auxiliary' stamp: 'AF 11/27/2021 12:35:52' prior: 50981753!
updateCounter: aCounter
	
	| textMorph |
	textMorph _ (counters at: aCounter id) innerTextMorph.
	textMorph contents: aCounter value.
	textMorph hasUnacceptedEdits: true.
	textMorph acceptContents.
	textMorph resetTextComposition; updateFromTextComposition.
! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 12:37:07' prior: 50981275!
build2ndRow
	| secondRowLayoutMorph |
	
	passwordTextBoxMorph := TextModelMorph textProvider: self model textGetter: #password textSetter: #password:. 
	passwordTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | passwordTextBoxMorph innerTextMorph acceptContents ] .
	passwordTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 200 ; morphHeight: 20. 
		
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 1;
	axisEdgeWeight: 0.5;
	morphExtent: self minimumExtent;
	addMorph: (LabelMorph contents:'Password:');
	addMorph: passwordTextBoxMorph.
	
	^secondRowLayoutMorph.! !

TusLibrosRestAPIInterface allInstancesDo: [:instance | instance destroy]!

server _ TusLibrosRestAPIInterfaceTest new startTestServerAndGraphicInterface.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 12:37:33' prior: 50981784!
build2ndRow
	| secondRowLayoutMorph |
	
	passwordTextBoxMorph := TextModelMorph textProvider: self model textGetter: #password textSetter: #password:. 
	passwordTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | passwordTextBoxMorph innerTextMorph acceptContents ] .
	passwordTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 200 ; morphHeight: 20. 
		
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: self minimumExtent;
	addMorph: (LabelMorph contents:'Password:');
	addMorph: passwordTextBoxMorph.
	
	^secondRowLayoutMorph.! !

CatalogWindow openWithUser: 'validUser' andPass: 'asdas' andCart: 1!

TusLibrosRestAPIInterface allInstancesDo: [:instance | instance destroy]!

server _ TusLibrosRestAPIInterfaceTest new startTestServerAndGraphicInterface.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 12:43:02' prior: 50981329 overrides: 50965593!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 1;
	axisEdgeWeight: 0;
	morphExtent: self defaultExtent ;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow;
	addMorph: self build4rdRow.! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 12:44:17'!
build1stRow: anExtent
	| firstRowLayoutMorph |
	
	userTextBoxMorph := TextModelMorph textProvider: self model textGetter: #username textSetter: #username:. 
	userTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | userTextBoxMorph innerTextMorph acceptContents ] .
	userTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 200 ; morphHeight: 20. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: anExtent y * 0.25;
	addMorph: (LabelMorph contents:'Username:');
	addMorph: userTextBoxMorph.
	
	^firstRowLayoutMorph.! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 12:45:15' prior: 50981843 overrides: 50965593!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 1;
	axisEdgeWeight: 0;
	morphExtent: self defaultExtent ;
	addMorph: (self build1stRow: self defaultExtent);
	addMorph: self build2ndRow;
	addMorph: self build3rdRow;
	addMorph: self build4rdRow.! !

CatalogWindow openWithUser: 'validUser' andPass: 'asdas' andCart: 1!

TusLibrosRestAPIInterface allInstancesDo: [:instance | instance destroy]!

server _ TusLibrosRestAPIInterfaceTest new startTestServerAndGraphicInterface.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 12:45:58' prior: 50981853!
build1stRow: anExtent
	| firstRowLayoutMorph |
	
	userTextBoxMorph := TextModelMorph textProvider: self model textGetter: #username textSetter: #username:. 
	userTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | userTextBoxMorph innerTextMorph acceptContents ] .
	userTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 200 ; morphHeight: 20. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: anExtent y * 3;
	addMorph: (LabelMorph contents:'Username:');
	addMorph: userTextBoxMorph.
	
	^firstRowLayoutMorph.! !

TusLibrosRestAPIInterface allInstancesDo: [:instance | instance destroy]!

server _ TusLibrosRestAPIInterfaceTest new startTestServerAndGraphicInterface.!

TusLibrosRestAPIInterface allInstancesDo: [:instance | instance destroy]!

TusLibrosRestAPIInterface allInstancesDo: [:instance | instance destroy]!

server _ TusLibrosRestAPIInterfaceTest new startTestServerAndGraphicInterface.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 12:47:00' prior: 50981896!
build1stRow: anExtent
	| firstRowLayoutMorph |
	
	userTextBoxMorph := TextModelMorph textProvider: self model textGetter: #username textSetter: #username:. 
	userTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | userTextBoxMorph innerTextMorph acceptContents ] .
	userTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 200 ; morphHeight: 20. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphHeight: anExtent y * 0.25;
	addMorph: (LabelMorph contents:'Username:');
	addMorph: userTextBoxMorph.
	
	^firstRowLayoutMorph.! !

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/27/2021 12:47:03'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/27/2021 12:47:03'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/27/2021 12:47:03'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test04 stamp: 'AF 11/27/2021 12:47:03'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'AF 11/27/2021 12:47:03'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test06listPurhcases stamp: 'AF 11/27/2021 12:47:03'!
FAILURE!

!testRun: #TusLibrosRestAPIInterfaceTest #test06listPurhcases stamp: 'AF 11/27/2021 12:47:03'!
FAILURE!

!testRun: #TusLibrosRestAPIInterfaceTest #test01CreateCartForValidCredentials stamp: 'AF 11/27/2021 12:47:06'!
FAILURE!

!testRun: #TusLibrosRestAPIInterfaceTest #test02CreateCartForInvalidCredentials stamp: 'AF 11/27/2021 12:47:06'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test03 stamp: 'AF 11/27/2021 12:47:06'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test04 stamp: 'AF 11/27/2021 12:47:06'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test05 stamp: 'AF 11/27/2021 12:47:06'!
PASSED!

!testRun: #TusLibrosRestAPIInterfaceTest #test06listPurhcases stamp: 'AF 11/27/2021 12:47:06'!
FAILURE!

server _ TusLibrosRestAPIInterfaceTest new startTestServerAndGraphicInterface.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 12:47:25' prior: 50981931!
build1stRow: anExtent
	| firstRowLayoutMorph |
	
	userTextBoxMorph := TextModelMorph textProvider: self model textGetter: #username textSetter: #username:. 
	userTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | userTextBoxMorph innerTextMorph acceptContents ] .
	userTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 200 ; morphHeight: 20. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphHeight: anExtent y * 5;
	addMorph: (LabelMorph contents:'Username:');
	addMorph: userTextBoxMorph.
	
	^firstRowLayoutMorph.! !

TusLibrosRestAPIInterface allInstancesDo: [:instance | instance destroy]!

server _ TusLibrosRestAPIInterfaceTest new startTestServerAndGraphicInterface.!

TusLibrosRestAPIInterface allInstancesDo: [:instance | instance destroy]!

!methodRemoval: LoginWindow #build1stRow: stamp: 'AF 11/27/2021 12:47:46'!
build1stRow: anExtent
	| firstRowLayoutMorph |
	
	userTextBoxMorph := TextModelMorph textProvider: self model textGetter: #username textSetter: #username:. 
	userTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | userTextBoxMorph innerTextMorph acceptContents ] .
	userTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 200 ; morphHeight: 20. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphHeight: anExtent y * 5;
	addMorph: (LabelMorph contents:'Username:');
	addMorph: userTextBoxMorph.
	
	^firstRowLayoutMorph.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 12:47:56' prior: 50981877 overrides: 50965593!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 1;
	axisEdgeWeight: 0;
	morphExtent: self defaultExtent ;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	addMorph: self build3rdRow;
	addMorph: self build4rdRow.! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 12:49:33' prior: 50981341 overrides: 50965689!
defaultExtent

	^ 500@485
	! !

server _ TusLibrosRestAPIInterfaceTest new startTestServerAndGraphicInterface.!

TusLibrosRestAPIInterface allInstancesDo: [:instance | instance destroy]!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 12:50:14' prior: 50982064 overrides: 50965689!
defaultExtent

	^ 1035@485
	! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 12:50:50'!
build1stRow1rstCollumn
	| firstRowLayoutMorph |
	
	userTextBoxMorph := TextModelMorph textProvider: self model textGetter: #username textSetter: #username:. 
	userTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | userTextBoxMorph innerTextMorph acceptContents ] .
	userTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 200 ; morphHeight: 20. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: self minimumExtent;
	addMorph: (LabelMorph contents:'Username:');
	addMorph: userTextBoxMorph.
	
	^firstRowLayoutMorph.! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 12:51:12'!
build1stRow1rstColumn
	| firstRowLayoutMorph |
	
	userTextBoxMorph := TextModelMorph textProvider: self model textGetter: #username textSetter: #username:. 
	userTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | userTextBoxMorph innerTextMorph acceptContents ] .
	userTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 200 ; morphHeight: 20. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: self minimumExtent;
	addMorph: (LabelMorph contents:'Username:');
	addMorph: userTextBoxMorph.
	
	^firstRowLayoutMorph.! !

!methodRemoval: LoginWindow #build1stRow1rstCollumn stamp: 'AF 11/27/2021 12:51:12'!
build1stRow1rstCollumn
	| firstRowLayoutMorph |
	
	userTextBoxMorph := TextModelMorph textProvider: self model textGetter: #username textSetter: #username:. 
	userTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | userTextBoxMorph innerTextMorph acceptContents ] .
	userTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 200 ; morphHeight: 20. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: self minimumExtent;
	addMorph: (LabelMorph contents:'Username:');
	addMorph: userTextBoxMorph.
	
	^firstRowLayoutMorph.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 13:00:20' prior: 50982101!
build1stRow1rstColumn
	| firstRowLayoutMorph |
	
	userTextBoxMorph := TextModelMorph textProvider: self model textGetter: #username textSetter: #username:. 
	userTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | userTextBoxMorph innerTextMorph acceptContents ] .
	userTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 200 ; morphHeight: 20. 
		
	firstRowLayoutMorph := LayoutMorph newColumn .
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: self minimumExtent;
	addMorph: self build1stRow ;
	addMorph: self build2ndRow .
	
	^firstRowLayoutMorph.! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 13:00:44' prior: 50982146!
build1stRow1rstColumn
	| firstRowLayoutMorph |
		
	firstRowLayoutMorph := LayoutMorph newColumn .
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: self minimumExtent;
	addMorph: self build1stRow ;
	addMorph: self build2ndRow .
	
	^firstRowLayoutMorph.! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 13:01:05' prior: 50982052 overrides: 50965593!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 1;
	axisEdgeWeight: 0;
	morphExtent: self defaultExtent ;
	addMorph: self build3rdRow;
	"addMorph: self build1stRow;
	addMorph: self build2ndRow;"
	addMorph: self build3rdRow;
	addMorph: self build4rdRow.! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 13:01:14' prior: 50982182 overrides: 50965593!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 1;
	axisEdgeWeight: 0;
	morphExtent: self defaultExtent ;
	addMorph: self build1stRow1rstColumn ;
	"addMorph: self build1stRow;
	addMorph: self build2ndRow;"
	addMorph: self build3rdRow;
	addMorph: self build4rdRow.! !

server _ TusLibrosRestAPIInterfaceTest new startTestServerAndGraphicInterface.!

server _ TusLibrosRestAPIInterfaceTest new startTestServerAndGraphicInterface.!

TusLibrosRestAPIInterface allInstancesDo: [:instance | instance destroy]!

LoginWindow open.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 13:03:54' prior: 50982169!
build1stRow1rstColumn
	| firstRowsFirstColumn |
		
	firstRowsFirstColumn := LayoutMorph newColumn .
	firstRowsFirstColumn separation: 25;
	axisEdgeWeight: 0;
	morphExtent: self minimumExtent;
	addMorph: self build1stRow ;
	addMorph: self build2ndRow .
	
	^firstRowsFirstColumn.! !

LoginWindow open.!

LoginWindow open.!

LoginWindow open.!

----SNAPSHOT----(27 November 2021 13:05:18) CuisUniversity-4972.image priorSource: 20785095!

LoginWindow open.!
!LoginWindow class methodsFor: 'instance creation' stamp: 'AF 11/27/2021 13:05:38' prior: 50980471!
open
	
	^self new initializeWith: 'TusLibros - login'.! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 13:17:59' prior: 50982215!
build1stRow1rstColumn
	| firstRowsFirstColumn |
		
	firstRowsFirstColumn := LayoutMorph newColumn .
	firstRowsFirstColumn separation: 1;
	axisEdgeWeight: 0;
	morphExtent: self minimumExtent;
	addMorph: self build1stRow ;
	addMorph: self build2ndRow .
	
	^firstRowsFirstColumn.! !

LoginWindow open.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 13:18:26' prior: 50981252!
build1stRow
	| firstRowLayoutMorph |
	
	userTextBoxMorph := TextModelMorph textProvider: self model textGetter: #username textSetter: #username:. 
	userTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | userTextBoxMorph innerTextMorph acceptContents ] .
	userTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 200 ; morphHeight: 20. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 1;
	axisEdgeWeight: 0.5;
	morphExtent: self minimumExtent;
	addMorph: (LabelMorph contents:'Username:');
	addMorph: userTextBoxMorph.
	
	^firstRowLayoutMorph.! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 13:18:33' prior: 50982251!
build1stRow
	| firstRowLayoutMorph |
	
	userTextBoxMorph := TextModelMorph textProvider: self model textGetter: #username textSetter: #username:. 
	userTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | userTextBoxMorph innerTextMorph acceptContents ] .
	userTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 200 ; morphHeight: 20. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: self minimumExtent;
	addMorph: (LabelMorph contents:'Username:');
	addMorph: userTextBoxMorph.
	
	^firstRowLayoutMorph.! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 13:18:48' prior: 50982238!
build1stRow1rstColumn
	| firstRowsFirstColumn |
		
	firstRowsFirstColumn := LayoutMorph newColumn .
	firstRowsFirstColumn separation: 50;
	axisEdgeWeight: 0;
	morphExtent: self minimumExtent;
	addMorph: self build1stRow ;
	addMorph: self build2ndRow .
	
	^firstRowsFirstColumn.! !

LoginWindow open.!

LoginWindow open.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 13:20:21' prior: 50982297!
build1stRow1rstColumn
	| firstRowsFirstColumn |
		
	firstRowsFirstColumn := LayoutMorph newColumn .
	firstRowsFirstColumn separation: 1;
	axisEdgeWeight: 0;
	morphExtent: self minimumExtent;
	addMorph: self build1stRow ;
	addMorph: self build2ndRow .
	
	^firstRowsFirstColumn.! !

LoginWindow open.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 13:21:13' prior: 50982274!
build1stRow
	| firstRowLayoutMorph |
	
	userTextBoxMorph := TextModelMorph textProvider: self model textGetter: #username textSetter: #username:. 
	userTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | userTextBoxMorph innerTextMorph acceptContents ] .
	userTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 200 ; morphHeight: 20. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: 1035@1;
	addMorph: (LabelMorph contents:'Username:');
	addMorph: userTextBoxMorph.
	
	^firstRowLayoutMorph.! !

LoginWindow open.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 13:21:34' prior: 50981812!
build2ndRow
	| secondRowLayoutMorph |
	
	passwordTextBoxMorph := TextModelMorph textProvider: self model textGetter: #password textSetter: #password:. 
	passwordTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | passwordTextBoxMorph innerTextMorph acceptContents ] .
	passwordTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 200 ; morphHeight: 20. 
		
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: 1035@1;
	addMorph: (LabelMorph contents:'Password:');
	addMorph: passwordTextBoxMorph.
	
	^secondRowLayoutMorph.! !

LoginWindow open.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 13:21:49' prior: 50982347!
build2ndRow
	| secondRowLayoutMorph |
	
	passwordTextBoxMorph := TextModelMorph textProvider: self model textGetter: #password textSetter: #password:. 
	passwordTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | passwordTextBoxMorph innerTextMorph acceptContents ] .
	passwordTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 200 ; morphHeight: 20. 
		
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: 1035@1;
	addMorph: (LabelMorph contents:'Password: ');
	addMorph: passwordTextBoxMorph.
	
	^secondRowLayoutMorph.! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 13:22:06' prior: 50982371!
build2ndRow
	| secondRowLayoutMorph |
	
	passwordTextBoxMorph := TextModelMorph textProvider: self model textGetter: #password textSetter: #password:. 
	passwordTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | passwordTextBoxMorph innerTextMorph acceptContents ] .
	passwordTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 200 ; morphHeight: 20. 
		
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: 475@1;
	addMorph: (LabelMorph contents:'Password: ');
	addMorph: passwordTextBoxMorph.
	
	^secondRowLayoutMorph.! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 13:22:12' prior: 50982324!
build1stRow
	| firstRowLayoutMorph |
	
	userTextBoxMorph := TextModelMorph textProvider: self model textGetter: #username textSetter: #username:. 
	userTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | userTextBoxMorph innerTextMorph acceptContents ] .
	userTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 200 ; morphHeight: 20. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: 475@1;
	addMorph: (LabelMorph contents:'Username:');
	addMorph: userTextBoxMorph.
	
	^firstRowLayoutMorph.! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 13:22:41' prior: 50982074 overrides: 50965689!
defaultExtent

	^ 475@485
	! !

LoginWindow open.!

LoginWindow open.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 13:24:40' prior: 50982417!
build1stRow
	| firstRowLayoutMorph |
	
	userTextBoxMorph := TextModelMorph textProvider: self model textGetter: #username textSetter: #username:. 
	userTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | userTextBoxMorph innerTextMorph acceptContents ] .
	userTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 200 ; morphHeight: 20. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0;
	morphExtent: 475@1;
	addMorph: (LabelMorph contents:'Username:');
	addMorph: userTextBoxMorph.
	
	^firstRowLayoutMorph.! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 13:24:44' prior: 50982394!
build2ndRow
	| secondRowLayoutMorph |
	
	passwordTextBoxMorph := TextModelMorph textProvider: self model textGetter: #password textSetter: #password:. 
	passwordTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | passwordTextBoxMorph innerTextMorph acceptContents ] .
	passwordTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 200 ; morphHeight: 20. 
		
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0;
	morphExtent: 475@1;
	addMorph: (LabelMorph contents:'Password: ');
	addMorph: passwordTextBoxMorph.
	
	^secondRowLayoutMorph.! !

LoginWindow open.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 13:25:07' prior: 50982468!
build2ndRow
	| secondRowLayoutMorph |
	
	passwordTextBoxMorph := TextModelMorph textProvider: self model textGetter: #password textSetter: #password:. 
	passwordTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | passwordTextBoxMorph innerTextMorph acceptContents ] .
	passwordTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 200 ; morphHeight: 20. 
		
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: 475@1;
	addMorph: (LabelMorph contents:'Password: ');
	addMorph: passwordTextBoxMorph.
	
	^secondRowLayoutMorph.! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 13:25:14' prior: 50982446!
build1stRow
	| firstRowLayoutMorph |
	
	userTextBoxMorph := TextModelMorph textProvider: self model textGetter: #username textSetter: #username:. 
	userTextBoxMorph innerTextMorph setProperty: #keyStroke: toValue: [ :key | userTextBoxMorph innerTextMorph acceptContents ] .
	userTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 200 ; morphHeight: 20. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	morphExtent: 475@1;
	addMorph: (LabelMorph contents:'Username:');
	addMorph: userTextBoxMorph.
	
	^firstRowLayoutMorph.! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 13:25:23' prior: 50982311!
build1stRow1rstColumn
	| firstRowsFirstColumn |
		
	firstRowsFirstColumn := LayoutMorph newColumn .
	firstRowsFirstColumn separation: 1;
	axisEdgeWeight: 0.5;
	morphExtent: self minimumExtent;
	addMorph: self build1stRow ;
	addMorph: self build2ndRow .
	
	^firstRowsFirstColumn.! !

LoginWindow open.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 13:25:45' prior: 50982537!
build1stRow1rstColumn
	| firstRowsFirstColumn |
		
	firstRowsFirstColumn := LayoutMorph newColumn .
	firstRowsFirstColumn separation: 1;
	axisEdgeWeight: 0;
	morphExtent: self minimumExtent;
	addMorph: self build1stRow ;
	addMorph: self build2ndRow .
	
	^firstRowsFirstColumn.! !
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 13:26:17' prior: 50982195 overrides: 50965593!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 1;
	axisEdgeWeight: 0.5;
	morphExtent: self defaultExtent ;
	addMorph: self build1stRow1rstColumn ;
	"addMorph: self build1stRow;
	addMorph: self build2ndRow;"
	addMorph: self build3rdRow;
	addMorph: self build4rdRow.! !

LoginWindow open.!
!LoginWindow methodsFor: 'as yet unclassified' stamp: 'AF 11/27/2021 13:26:42' prior: 50982563 overrides: 50965593!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 1;
	axisEdgeWeight: 0;
	morphExtent: self defaultExtent ;
	addMorph: self build1stRow1rstColumn ;
	"addMorph: self build1stRow;
	addMorph: self build2ndRow;"
	addMorph: self build3rdRow;
	addMorph: self build4rdRow.! !

LoginWindow open.!

LoginWindow open.!

LoginWindow open.!

----SNAPSHOT----(27 November 2021 13:34:26) CuisUniversity-4972.image priorSource: 20818484!